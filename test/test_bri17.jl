using Base.Iterators
using LinearAlgebra

function expected_avg_gradient_operator(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
     = element_nodes(d)
    D = zeros(T, d, fill(2, d)...)
    for i = 1:d, n in 
        D[i, n] = (-1)^n[i] / 2^(d - 1) / h[i]
    end
    return D
end


function expected_avg_strain_displacement_operator(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
     = element_nodes(d)
    D = expected_avg_gradient_operator(h)
    B = zeros(T, d, d, fill(2, d)..., d)
    for i = 1:d, j = 1:d, n in , k = 1:d
        B[i, j, n, k] = (D[i, n] * T(j == k) + D[j, n] * T(i == k)) / 2
    end
    return B
end

function expected_K_位(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    K_位 = zeros(Float64, fill(2, d)..., d, fill(2, d)..., d)
    if d == 2
        value = -1 / 4
        K_位[1, 1, 1, 1, 2, 2] = value
        K_位[1, 1, 1, 2, 2, 2] = value
        K_位[1, 1, 2, 2, 1, 1] = value
        K_位[1, 1, 2, 2, 2, 1] = value
        K_位[1, 2, 1, 1, 2, 2] = value
        K_位[1, 2, 1, 2, 2, 2] = value
        K_位[1, 2, 2, 1, 1, 1] = value
        K_位[1, 2, 2, 1, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 2] = value
        K_位[2, 1, 1, 2, 1, 2] = value
        K_位[2, 1, 2, 2, 1, 1] = value
        K_位[2, 1, 2, 2, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 2] = value
        K_位[2, 2, 1, 2, 1, 2] = value
        K_位[2, 2, 2, 1, 1, 1] = value
        K_位[2, 2, 2, 1, 2, 1] = value

        value = 1 / 4
        K_位[1, 1, 1, 1, 1, 2] = value
        K_位[1, 1, 1, 2, 1, 2] = value
        K_位[1, 1, 2, 1, 1, 1] = value
        K_位[1, 1, 2, 1, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 2] = value
        K_位[1, 2, 1, 2, 1, 2] = value
        K_位[1, 2, 2, 2, 1, 1] = value
        K_位[1, 2, 2, 2, 2, 1] = value
        K_位[2, 1, 1, 1, 2, 2] = value
        K_位[2, 1, 1, 2, 2, 2] = value
        K_位[2, 1, 2, 1, 1, 1] = value
        K_位[2, 1, 2, 1, 2, 1] = value
        K_位[2, 2, 1, 1, 2, 2] = value
        K_位[2, 2, 1, 2, 2, 2] = value
        K_位[2, 2, 2, 2, 1, 1] = value
        K_位[2, 2, 2, 2, 2, 1] = value

        value = -h[1] / (3 * h[2])
        K_位[1, 1, 2, 1, 2, 2] = value
        K_位[1, 2, 2, 1, 1, 2] = value
        K_位[2, 1, 2, 2, 2, 2] = value
        K_位[2, 2, 2, 2, 1, 2] = value

        value = -h[1] / (6 * h[2])
        K_位[1, 1, 2, 2, 2, 2] = value
        K_位[1, 2, 2, 2, 1, 2] = value
        K_位[2, 1, 2, 1, 2, 2] = value
        K_位[2, 2, 2, 1, 1, 2] = value

        value = h[1] / (6 * h[2])
        K_位[1, 1, 2, 2, 1, 2] = value
        K_位[1, 2, 2, 2, 2, 2] = value
        K_位[2, 1, 2, 1, 1, 2] = value
        K_位[2, 2, 2, 1, 2, 2] = value

        value = h[1] / (3 * h[2])
        K_位[1, 1, 2, 1, 1, 2] = value
        K_位[1, 2, 2, 1, 2, 2] = value
        K_位[2, 1, 2, 2, 1, 2] = value
        K_位[2, 2, 2, 2, 2, 2] = value

        value = -h[2] / (3 * h[1])
        K_位[1, 1, 1, 2, 1, 1] = value
        K_位[1, 2, 1, 2, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 1] = value
        K_位[2, 2, 1, 1, 2, 1] = value

        value = -h[2] / (6 * h[1])
        K_位[1, 1, 1, 2, 2, 1] = value
        K_位[1, 2, 1, 2, 1, 1] = value
        K_位[2, 1, 1, 1, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 1] = value

        value = h[2] / (6 * h[1])
        K_位[1, 1, 1, 1, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 1] = value
        K_位[2, 1, 1, 2, 2, 1] = value
        K_位[2, 2, 1, 2, 1, 1] = value

        value = h[2] / (3 * h[1])
        K_位[1, 1, 1, 1, 1, 1] = value
        K_位[1, 2, 1, 1, 2, 1] = value
        K_位[2, 1, 1, 2, 1, 1] = value
        K_位[2, 2, 1, 2, 2, 1] = value
    elseif d == 3
        value = -h[1] / 12
        K_位[1, 1, 1, 2, 1, 1, 2, 3] = value
        K_位[1, 1, 1, 2, 1, 2, 2, 3] = value
        K_位[1, 1, 1, 3, 1, 2, 1, 2] = value
        K_位[1, 1, 1, 3, 1, 2, 2, 2] = value
        K_位[1, 1, 2, 2, 1, 1, 2, 3] = value
        K_位[1, 1, 2, 2, 1, 2, 2, 3] = value
        K_位[1, 1, 2, 3, 1, 1, 1, 2] = value
        K_位[1, 1, 2, 3, 1, 1, 2, 2] = value
        K_位[1, 2, 1, 2, 1, 1, 1, 3] = value
        K_位[1, 2, 1, 2, 1, 2, 1, 3] = value
        K_位[1, 2, 1, 3, 1, 2, 1, 2] = value
        K_位[1, 2, 1, 3, 1, 2, 2, 2] = value
        K_位[1, 2, 2, 2, 1, 1, 1, 3] = value
        K_位[1, 2, 2, 2, 1, 2, 1, 3] = value
        K_位[1, 2, 2, 3, 1, 1, 1, 2] = value
        K_位[1, 2, 2, 3, 1, 1, 2, 2] = value
        K_位[2, 1, 1, 2, 2, 1, 2, 3] = value
        K_位[2, 1, 1, 2, 2, 2, 2, 3] = value
        K_位[2, 1, 1, 3, 2, 2, 1, 2] = value
        K_位[2, 1, 1, 3, 2, 2, 2, 2] = value
        K_位[2, 1, 2, 2, 2, 1, 2, 3] = value
        K_位[2, 1, 2, 2, 2, 2, 2, 3] = value
        K_位[2, 1, 2, 3, 2, 1, 1, 2] = value
        K_位[2, 1, 2, 3, 2, 1, 2, 2] = value
        K_位[2, 2, 1, 2, 2, 1, 1, 3] = value
        K_位[2, 2, 1, 2, 2, 2, 1, 3] = value
        K_位[2, 2, 1, 3, 2, 2, 1, 2] = value
        K_位[2, 2, 1, 3, 2, 2, 2, 2] = value
        K_位[2, 2, 2, 2, 2, 1, 1, 3] = value
        K_位[2, 2, 2, 2, 2, 2, 1, 3] = value
        K_位[2, 2, 2, 3, 2, 1, 1, 2] = value
        K_位[2, 2, 2, 3, 2, 1, 2, 2] = value

        value = -h[1] / 24
        K_位[1, 1, 1, 2, 2, 1, 2, 3] = value
        K_位[1, 1, 1, 2, 2, 2, 2, 3] = value
        K_位[1, 1, 1, 3, 2, 2, 1, 2] = value
        K_位[1, 1, 1, 3, 2, 2, 2, 2] = value
        K_位[1, 1, 2, 2, 2, 1, 2, 3] = value
        K_位[1, 1, 2, 2, 2, 2, 2, 3] = value
        K_位[1, 1, 2, 3, 2, 1, 1, 2] = value
        K_位[1, 1, 2, 3, 2, 1, 2, 2] = value
        K_位[1, 2, 1, 2, 2, 1, 1, 3] = value
        K_位[1, 2, 1, 2, 2, 2, 1, 3] = value
        K_位[1, 2, 1, 3, 2, 2, 1, 2] = value
        K_位[1, 2, 1, 3, 2, 2, 2, 2] = value
        K_位[1, 2, 2, 2, 2, 1, 1, 3] = value
        K_位[1, 2, 2, 2, 2, 2, 1, 3] = value
        K_位[1, 2, 2, 3, 2, 1, 1, 2] = value
        K_位[1, 2, 2, 3, 2, 1, 2, 2] = value
        K_位[2, 1, 1, 2, 1, 1, 2, 3] = value
        K_位[2, 1, 1, 2, 1, 2, 2, 3] = value
        K_位[2, 1, 1, 3, 1, 2, 1, 2] = value
        K_位[2, 1, 1, 3, 1, 2, 2, 2] = value
        K_位[2, 1, 2, 2, 1, 1, 2, 3] = value
        K_位[2, 1, 2, 2, 1, 2, 2, 3] = value
        K_位[2, 1, 2, 3, 1, 1, 1, 2] = value
        K_位[2, 1, 2, 3, 1, 1, 2, 2] = value
        K_位[2, 2, 1, 2, 1, 1, 1, 3] = value
        K_位[2, 2, 1, 2, 1, 2, 1, 3] = value
        K_位[2, 2, 1, 3, 1, 2, 1, 2] = value
        K_位[2, 2, 1, 3, 1, 2, 2, 2] = value
        K_位[2, 2, 2, 2, 1, 1, 1, 3] = value
        K_位[2, 2, 2, 2, 1, 2, 1, 3] = value
        K_位[2, 2, 2, 3, 1, 1, 1, 2] = value
        K_位[2, 2, 2, 3, 1, 1, 2, 2] = value

        value = h[1] / 24
        K_位[1, 1, 1, 2, 2, 1, 1, 3] = value
        K_位[1, 1, 1, 2, 2, 2, 1, 3] = value
        K_位[1, 1, 1, 3, 2, 1, 1, 2] = value
        K_位[1, 1, 1, 3, 2, 1, 2, 2] = value
        K_位[1, 1, 2, 2, 2, 1, 1, 3] = value
        K_位[1, 1, 2, 2, 2, 2, 1, 3] = value
        K_位[1, 1, 2, 3, 2, 2, 1, 2] = value
        K_位[1, 1, 2, 3, 2, 2, 2, 2] = value
        K_位[1, 2, 1, 2, 2, 1, 2, 3] = value
        K_位[1, 2, 1, 2, 2, 2, 2, 3] = value
        K_位[1, 2, 1, 3, 2, 1, 1, 2] = value
        K_位[1, 2, 1, 3, 2, 1, 2, 2] = value
        K_位[1, 2, 2, 2, 2, 1, 2, 3] = value
        K_位[1, 2, 2, 2, 2, 2, 2, 3] = value
        K_位[1, 2, 2, 3, 2, 2, 1, 2] = value
        K_位[1, 2, 2, 3, 2, 2, 2, 2] = value
        K_位[2, 1, 1, 2, 1, 1, 1, 3] = value
        K_位[2, 1, 1, 2, 1, 2, 1, 3] = value
        K_位[2, 1, 1, 3, 1, 1, 1, 2] = value
        K_位[2, 1, 1, 3, 1, 1, 2, 2] = value
        K_位[2, 1, 2, 2, 1, 1, 1, 3] = value
        K_位[2, 1, 2, 2, 1, 2, 1, 3] = value
        K_位[2, 1, 2, 3, 1, 2, 1, 2] = value
        K_位[2, 1, 2, 3, 1, 2, 2, 2] = value
        K_位[2, 2, 1, 2, 1, 1, 2, 3] = value
        K_位[2, 2, 1, 2, 1, 2, 2, 3] = value
        K_位[2, 2, 1, 3, 1, 1, 1, 2] = value
        K_位[2, 2, 1, 3, 1, 1, 2, 2] = value
        K_位[2, 2, 2, 2, 1, 1, 2, 3] = value
        K_位[2, 2, 2, 2, 1, 2, 2, 3] = value
        K_位[2, 2, 2, 3, 1, 2, 1, 2] = value
        K_位[2, 2, 2, 3, 1, 2, 2, 2] = value

        value = h[1] / 12
        K_位[1, 1, 1, 2, 1, 1, 1, 3] = value
        K_位[1, 1, 1, 2, 1, 2, 1, 3] = value
        K_位[1, 1, 1, 3, 1, 1, 1, 2] = value
        K_位[1, 1, 1, 3, 1, 1, 2, 2] = value
        K_位[1, 1, 2, 2, 1, 1, 1, 3] = value
        K_位[1, 1, 2, 2, 1, 2, 1, 3] = value
        K_位[1, 1, 2, 3, 1, 2, 1, 2] = value
        K_位[1, 1, 2, 3, 1, 2, 2, 2] = value
        K_位[1, 2, 1, 2, 1, 1, 2, 3] = value
        K_位[1, 2, 1, 2, 1, 2, 2, 3] = value
        K_位[1, 2, 1, 3, 1, 1, 1, 2] = value
        K_位[1, 2, 1, 3, 1, 1, 2, 2] = value
        K_位[1, 2, 2, 2, 1, 1, 2, 3] = value
        K_位[1, 2, 2, 2, 1, 2, 2, 3] = value
        K_位[1, 2, 2, 3, 1, 2, 1, 2] = value
        K_位[1, 2, 2, 3, 1, 2, 2, 2] = value
        K_位[2, 1, 1, 2, 2, 1, 1, 3] = value
        K_位[2, 1, 1, 2, 2, 2, 1, 3] = value
        K_位[2, 1, 1, 3, 2, 1, 1, 2] = value
        K_位[2, 1, 1, 3, 2, 1, 2, 2] = value
        K_位[2, 1, 2, 2, 2, 1, 1, 3] = value
        K_位[2, 1, 2, 2, 2, 2, 1, 3] = value
        K_位[2, 1, 2, 3, 2, 2, 1, 2] = value
        K_位[2, 1, 2, 3, 2, 2, 2, 2] = value
        K_位[2, 2, 1, 2, 2, 1, 2, 3] = value
        K_位[2, 2, 1, 2, 2, 2, 2, 3] = value
        K_位[2, 2, 1, 3, 2, 1, 1, 2] = value
        K_位[2, 2, 1, 3, 2, 1, 2, 2] = value
        K_位[2, 2, 2, 2, 2, 1, 2, 3] = value
        K_位[2, 2, 2, 2, 2, 2, 2, 3] = value
        K_位[2, 2, 2, 3, 2, 2, 1, 2] = value
        K_位[2, 2, 2, 3, 2, 2, 2, 2] = value

        value = -h[2] / 12
        K_位[1, 1, 1, 1, 1, 1, 2, 3] = value
        K_位[1, 1, 1, 1, 2, 1, 2, 3] = value
        K_位[1, 1, 1, 3, 2, 1, 1, 1] = value
        K_位[1, 1, 1, 3, 2, 1, 2, 1] = value
        K_位[1, 1, 2, 1, 1, 1, 2, 3] = value
        K_位[1, 1, 2, 1, 2, 1, 2, 3] = value
        K_位[1, 1, 2, 3, 1, 1, 1, 1] = value
        K_位[1, 1, 2, 3, 1, 1, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 2, 2, 3] = value
        K_位[1, 2, 1, 1, 2, 2, 2, 3] = value
        K_位[1, 2, 1, 3, 2, 2, 1, 1] = value
        K_位[1, 2, 1, 3, 2, 2, 2, 1] = value
        K_位[1, 2, 2, 1, 1, 2, 2, 3] = value
        K_位[1, 2, 2, 1, 2, 2, 2, 3] = value
        K_位[1, 2, 2, 3, 1, 2, 1, 1] = value
        K_位[1, 2, 2, 3, 1, 2, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 1, 1, 3] = value
        K_位[2, 1, 1, 1, 2, 1, 1, 3] = value
        K_位[2, 1, 1, 3, 2, 1, 1, 1] = value
        K_位[2, 1, 1, 3, 2, 1, 2, 1] = value
        K_位[2, 1, 2, 1, 1, 1, 1, 3] = value
        K_位[2, 1, 2, 1, 2, 1, 1, 3] = value
        K_位[2, 1, 2, 3, 1, 1, 1, 1] = value
        K_位[2, 1, 2, 3, 1, 1, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 2, 1, 3] = value
        K_位[2, 2, 1, 1, 2, 2, 1, 3] = value
        K_位[2, 2, 1, 3, 2, 2, 1, 1] = value
        K_位[2, 2, 1, 3, 2, 2, 2, 1] = value
        K_位[2, 2, 2, 1, 1, 2, 1, 3] = value
        K_位[2, 2, 2, 1, 2, 2, 1, 3] = value
        K_位[2, 2, 2, 3, 1, 2, 1, 1] = value
        K_位[2, 2, 2, 3, 1, 2, 2, 1] = value

        value = -h[2] / 24
        K_位[1, 1, 1, 1, 1, 2, 2, 3] = value
        K_位[1, 1, 1, 1, 2, 2, 2, 3] = value
        K_位[1, 1, 1, 3, 2, 2, 1, 1] = value
        K_位[1, 1, 1, 3, 2, 2, 2, 1] = value
        K_位[1, 1, 2, 1, 1, 2, 2, 3] = value
        K_位[1, 1, 2, 1, 2, 2, 2, 3] = value
        K_位[1, 1, 2, 3, 1, 2, 1, 1] = value
        K_位[1, 1, 2, 3, 1, 2, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 1, 2, 3] = value
        K_位[1, 2, 1, 1, 2, 1, 2, 3] = value
        K_位[1, 2, 1, 3, 2, 1, 1, 1] = value
        K_位[1, 2, 1, 3, 2, 1, 2, 1] = value
        K_位[1, 2, 2, 1, 1, 1, 2, 3] = value
        K_位[1, 2, 2, 1, 2, 1, 2, 3] = value
        K_位[1, 2, 2, 3, 1, 1, 1, 1] = value
        K_位[1, 2, 2, 3, 1, 1, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 2, 1, 3] = value
        K_位[2, 1, 1, 1, 2, 2, 1, 3] = value
        K_位[2, 1, 1, 3, 2, 2, 1, 1] = value
        K_位[2, 1, 1, 3, 2, 2, 2, 1] = value
        K_位[2, 1, 2, 1, 1, 2, 1, 3] = value
        K_位[2, 1, 2, 1, 2, 2, 1, 3] = value
        K_位[2, 1, 2, 3, 1, 2, 1, 1] = value
        K_位[2, 1, 2, 3, 1, 2, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 1, 1, 3] = value
        K_位[2, 2, 1, 1, 2, 1, 1, 3] = value
        K_位[2, 2, 1, 3, 2, 1, 1, 1] = value
        K_位[2, 2, 1, 3, 2, 1, 2, 1] = value
        K_位[2, 2, 2, 1, 1, 1, 1, 3] = value
        K_位[2, 2, 2, 1, 2, 1, 1, 3] = value
        K_位[2, 2, 2, 3, 1, 1, 1, 1] = value
        K_位[2, 2, 2, 3, 1, 1, 2, 1] = value

        value = h[2] / 24
        K_位[1, 1, 1, 1, 1, 2, 1, 3] = value
        K_位[1, 1, 1, 1, 2, 2, 1, 3] = value
        K_位[1, 1, 1, 3, 1, 2, 1, 1] = value
        K_位[1, 1, 1, 3, 1, 2, 2, 1] = value
        K_位[1, 1, 2, 1, 1, 2, 1, 3] = value
        K_位[1, 1, 2, 1, 2, 2, 1, 3] = value
        K_位[1, 1, 2, 3, 2, 2, 1, 1] = value
        K_位[1, 1, 2, 3, 2, 2, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 1, 1, 3] = value
        K_位[1, 2, 1, 1, 2, 1, 1, 3] = value
        K_位[1, 2, 1, 3, 1, 1, 1, 1] = value
        K_位[1, 2, 1, 3, 1, 1, 2, 1] = value
        K_位[1, 2, 2, 1, 1, 1, 1, 3] = value
        K_位[1, 2, 2, 1, 2, 1, 1, 3] = value
        K_位[1, 2, 2, 3, 2, 1, 1, 1] = value
        K_位[1, 2, 2, 3, 2, 1, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 2, 2, 3] = value
        K_位[2, 1, 1, 1, 2, 2, 2, 3] = value
        K_位[2, 1, 1, 3, 1, 2, 1, 1] = value
        K_位[2, 1, 1, 3, 1, 2, 2, 1] = value
        K_位[2, 1, 2, 1, 1, 2, 2, 3] = value
        K_位[2, 1, 2, 1, 2, 2, 2, 3] = value
        K_位[2, 1, 2, 3, 2, 2, 1, 1] = value
        K_位[2, 1, 2, 3, 2, 2, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 1, 2, 3] = value
        K_位[2, 2, 1, 1, 2, 1, 2, 3] = value
        K_位[2, 2, 1, 3, 1, 1, 1, 1] = value
        K_位[2, 2, 1, 3, 1, 1, 2, 1] = value
        K_位[2, 2, 2, 1, 1, 1, 2, 3] = value
        K_位[2, 2, 2, 1, 2, 1, 2, 3] = value
        K_位[2, 2, 2, 3, 2, 1, 1, 1] = value
        K_位[2, 2, 2, 3, 2, 1, 2, 1] = value

        value = h[2] / 12
        K_位[1, 1, 1, 1, 1, 1, 1, 3] = value
        K_位[1, 1, 1, 1, 2, 1, 1, 3] = value
        K_位[1, 1, 1, 3, 1, 1, 1, 1] = value
        K_位[1, 1, 1, 3, 1, 1, 2, 1] = value
        K_位[1, 1, 2, 1, 1, 1, 1, 3] = value
        K_位[1, 1, 2, 1, 2, 1, 1, 3] = value
        K_位[1, 1, 2, 3, 2, 1, 1, 1] = value
        K_位[1, 1, 2, 3, 2, 1, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 2, 1, 3] = value
        K_位[1, 2, 1, 1, 2, 2, 1, 3] = value
        K_位[1, 2, 1, 3, 1, 2, 1, 1] = value
        K_位[1, 2, 1, 3, 1, 2, 2, 1] = value
        K_位[1, 2, 2, 1, 1, 2, 1, 3] = value
        K_位[1, 2, 2, 1, 2, 2, 1, 3] = value
        K_位[1, 2, 2, 3, 2, 2, 1, 1] = value
        K_位[1, 2, 2, 3, 2, 2, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 1, 2, 3] = value
        K_位[2, 1, 1, 1, 2, 1, 2, 3] = value
        K_位[2, 1, 1, 3, 1, 1, 1, 1] = value
        K_位[2, 1, 1, 3, 1, 1, 2, 1] = value
        K_位[2, 1, 2, 1, 1, 1, 2, 3] = value
        K_位[2, 1, 2, 1, 2, 1, 2, 3] = value
        K_位[2, 1, 2, 3, 2, 1, 1, 1] = value
        K_位[2, 1, 2, 3, 2, 1, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 2, 2, 3] = value
        K_位[2, 2, 1, 1, 2, 2, 2, 3] = value
        K_位[2, 2, 1, 3, 1, 2, 1, 1] = value
        K_位[2, 2, 1, 3, 1, 2, 2, 1] = value
        K_位[2, 2, 2, 1, 1, 2, 2, 3] = value
        K_位[2, 2, 2, 1, 2, 2, 2, 3] = value
        K_位[2, 2, 2, 3, 2, 2, 1, 1] = value
        K_位[2, 2, 2, 3, 2, 2, 2, 1] = value

        value = -(h[1] * h[2]) / (9 * h[3])
        K_位[1, 1, 1, 3, 1, 1, 2, 3] = value
        K_位[1, 1, 2, 3, 1, 1, 1, 3] = value
        K_位[1, 2, 1, 3, 1, 2, 2, 3] = value
        K_位[1, 2, 2, 3, 1, 2, 1, 3] = value
        K_位[2, 1, 1, 3, 2, 1, 2, 3] = value
        K_位[2, 1, 2, 3, 2, 1, 1, 3] = value
        K_位[2, 2, 1, 3, 2, 2, 2, 3] = value
        K_位[2, 2, 2, 3, 2, 2, 1, 3] = value

        value = -(h[1] * h[2]) / (18 * h[3])
        K_位[1, 1, 1, 3, 1, 2, 2, 3] = value
        K_位[1, 1, 1, 3, 2, 1, 2, 3] = value
        K_位[1, 1, 2, 3, 1, 2, 1, 3] = value
        K_位[1, 1, 2, 3, 2, 1, 1, 3] = value
        K_位[1, 2, 1, 3, 1, 1, 2, 3] = value
        K_位[1, 2, 1, 3, 2, 2, 2, 3] = value
        K_位[1, 2, 2, 3, 1, 1, 1, 3] = value
        K_位[1, 2, 2, 3, 2, 2, 1, 3] = value
        K_位[2, 1, 1, 3, 1, 1, 2, 3] = value
        K_位[2, 1, 1, 3, 2, 2, 2, 3] = value
        K_位[2, 1, 2, 3, 1, 1, 1, 3] = value
        K_位[2, 1, 2, 3, 2, 2, 1, 3] = value
        K_位[2, 2, 1, 3, 1, 2, 2, 3] = value
        K_位[2, 2, 1, 3, 2, 1, 2, 3] = value
        K_位[2, 2, 2, 3, 1, 2, 1, 3] = value
        K_位[2, 2, 2, 3, 2, 1, 1, 3] = value

        value = -(h[1] * h[2]) / (36 * h[3])
        K_位[1, 1, 1, 3, 2, 2, 2, 3] = value
        K_位[1, 1, 2, 3, 2, 2, 1, 3] = value
        K_位[1, 2, 1, 3, 2, 1, 2, 3] = value
        K_位[1, 2, 2, 3, 2, 1, 1, 3] = value
        K_位[2, 1, 1, 3, 1, 2, 2, 3] = value
        K_位[2, 1, 2, 3, 1, 2, 1, 3] = value
        K_位[2, 2, 1, 3, 1, 1, 2, 3] = value
        K_位[2, 2, 2, 3, 1, 1, 1, 3] = value

        value = (h[1] * h[2]) / (36 * h[3])
        K_位[1, 1, 1, 3, 2, 2, 1, 3] = value
        K_位[1, 1, 2, 3, 2, 2, 2, 3] = value
        K_位[1, 2, 1, 3, 2, 1, 1, 3] = value
        K_位[1, 2, 2, 3, 2, 1, 2, 3] = value
        K_位[2, 1, 1, 3, 1, 2, 1, 3] = value
        K_位[2, 1, 2, 3, 1, 2, 2, 3] = value
        K_位[2, 2, 1, 3, 1, 1, 1, 3] = value
        K_位[2, 2, 2, 3, 1, 1, 2, 3] = value

        value = (h[1] * h[2]) / (18 * h[3])
        K_位[1, 1, 1, 3, 1, 2, 1, 3] = value
        K_位[1, 1, 1, 3, 2, 1, 1, 3] = value
        K_位[1, 1, 2, 3, 1, 2, 2, 3] = value
        K_位[1, 1, 2, 3, 2, 1, 2, 3] = value
        K_位[1, 2, 1, 3, 1, 1, 1, 3] = value
        K_位[1, 2, 1, 3, 2, 2, 1, 3] = value
        K_位[1, 2, 2, 3, 1, 1, 2, 3] = value
        K_位[1, 2, 2, 3, 2, 2, 2, 3] = value
        K_位[2, 1, 1, 3, 1, 1, 1, 3] = value
        K_位[2, 1, 1, 3, 2, 2, 1, 3] = value
        K_位[2, 1, 2, 3, 1, 1, 2, 3] = value
        K_位[2, 1, 2, 3, 2, 2, 2, 3] = value
        K_位[2, 2, 1, 3, 1, 2, 1, 3] = value
        K_位[2, 2, 1, 3, 2, 1, 1, 3] = value
        K_位[2, 2, 2, 3, 1, 2, 2, 3] = value
        K_位[2, 2, 2, 3, 2, 1, 2, 3] = value

        value = (h[1] * h[2]) / (9 * h[3])
        K_位[1, 1, 1, 3, 1, 1, 1, 3] = value
        K_位[1, 1, 2, 3, 1, 1, 2, 3] = value
        K_位[1, 2, 1, 3, 1, 2, 1, 3] = value
        K_位[1, 2, 2, 3, 1, 2, 2, 3] = value
        K_位[2, 1, 1, 3, 2, 1, 1, 3] = value
        K_位[2, 1, 2, 3, 2, 1, 2, 3] = value
        K_位[2, 2, 1, 3, 2, 2, 1, 3] = value
        K_位[2, 2, 2, 3, 2, 2, 2, 3] = value

        value = -h[3] / 12
        K_位[1, 1, 1, 1, 1, 2, 1, 2] = value
        K_位[1, 1, 1, 1, 2, 2, 1, 2] = value
        K_位[1, 1, 1, 2, 2, 1, 1, 1] = value
        K_位[1, 1, 1, 2, 2, 2, 1, 1] = value
        K_位[1, 1, 2, 1, 1, 2, 2, 2] = value
        K_位[1, 1, 2, 1, 2, 2, 2, 2] = value
        K_位[1, 1, 2, 2, 2, 1, 2, 1] = value
        K_位[1, 1, 2, 2, 2, 2, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 2, 1, 2] = value
        K_位[1, 2, 1, 1, 2, 2, 1, 2] = value
        K_位[1, 2, 1, 2, 1, 1, 1, 1] = value
        K_位[1, 2, 1, 2, 1, 2, 1, 1] = value
        K_位[1, 2, 2, 1, 1, 2, 2, 2] = value
        K_位[1, 2, 2, 1, 2, 2, 2, 2] = value
        K_位[1, 2, 2, 2, 1, 1, 2, 1] = value
        K_位[1, 2, 2, 2, 1, 2, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 1, 1, 2] = value
        K_位[2, 1, 1, 1, 2, 1, 1, 2] = value
        K_位[2, 1, 1, 2, 2, 1, 1, 1] = value
        K_位[2, 1, 1, 2, 2, 2, 1, 1] = value
        K_位[2, 1, 2, 1, 1, 1, 2, 2] = value
        K_位[2, 1, 2, 1, 2, 1, 2, 2] = value
        K_位[2, 1, 2, 2, 2, 1, 2, 1] = value
        K_位[2, 1, 2, 2, 2, 2, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 1, 1, 2] = value
        K_位[2, 2, 1, 1, 2, 1, 1, 2] = value
        K_位[2, 2, 1, 2, 1, 1, 1, 1] = value
        K_位[2, 2, 1, 2, 1, 2, 1, 1] = value
        K_位[2, 2, 2, 1, 1, 1, 2, 2] = value
        K_位[2, 2, 2, 1, 2, 1, 2, 2] = value
        K_位[2, 2, 2, 2, 1, 1, 2, 1] = value
        K_位[2, 2, 2, 2, 1, 2, 2, 1] = value

        value = -h[3] / 24
        K_位[1, 1, 1, 1, 1, 2, 2, 2] = value
        K_位[1, 1, 1, 1, 2, 2, 2, 2] = value
        K_位[1, 1, 1, 2, 2, 1, 2, 1] = value
        K_位[1, 1, 1, 2, 2, 2, 2, 1] = value
        K_位[1, 1, 2, 1, 1, 2, 1, 2] = value
        K_位[1, 1, 2, 1, 2, 2, 1, 2] = value
        K_位[1, 1, 2, 2, 2, 1, 1, 1] = value
        K_位[1, 1, 2, 2, 2, 2, 1, 1] = value
        K_位[1, 2, 1, 1, 1, 2, 2, 2] = value
        K_位[1, 2, 1, 1, 2, 2, 2, 2] = value
        K_位[1, 2, 1, 2, 1, 1, 2, 1] = value
        K_位[1, 2, 1, 2, 1, 2, 2, 1] = value
        K_位[1, 2, 2, 1, 1, 2, 1, 2] = value
        K_位[1, 2, 2, 1, 2, 2, 1, 2] = value
        K_位[1, 2, 2, 2, 1, 1, 1, 1] = value
        K_位[1, 2, 2, 2, 1, 2, 1, 1] = value
        K_位[2, 1, 1, 1, 1, 1, 2, 2] = value
        K_位[2, 1, 1, 1, 2, 1, 2, 2] = value
        K_位[2, 1, 1, 2, 2, 1, 2, 1] = value
        K_位[2, 1, 1, 2, 2, 2, 2, 1] = value
        K_位[2, 1, 2, 1, 1, 1, 1, 2] = value
        K_位[2, 1, 2, 1, 2, 1, 1, 2] = value
        K_位[2, 1, 2, 2, 2, 1, 1, 1] = value
        K_位[2, 1, 2, 2, 2, 2, 1, 1] = value
        K_位[2, 2, 1, 1, 1, 1, 2, 2] = value
        K_位[2, 2, 1, 1, 2, 1, 2, 2] = value
        K_位[2, 2, 1, 2, 1, 1, 2, 1] = value
        K_位[2, 2, 1, 2, 1, 2, 2, 1] = value
        K_位[2, 2, 2, 1, 1, 1, 1, 2] = value
        K_位[2, 2, 2, 1, 2, 1, 1, 2] = value
        K_位[2, 2, 2, 2, 1, 1, 1, 1] = value
        K_位[2, 2, 2, 2, 1, 2, 1, 1] = value

        value = h[3] / 24
        K_位[1, 1, 1, 1, 1, 1, 2, 2] = value
        K_位[1, 1, 1, 1, 2, 1, 2, 2] = value
        K_位[1, 1, 1, 2, 1, 1, 2, 1] = value
        K_位[1, 1, 1, 2, 1, 2, 2, 1] = value
        K_位[1, 1, 2, 1, 1, 1, 1, 2] = value
        K_位[1, 1, 2, 1, 2, 1, 1, 2] = value
        K_位[1, 1, 2, 2, 1, 1, 1, 1] = value
        K_位[1, 1, 2, 2, 1, 2, 1, 1] = value
        K_位[1, 2, 1, 1, 1, 1, 2, 2] = value
        K_位[1, 2, 1, 1, 2, 1, 2, 2] = value
        K_位[1, 2, 1, 2, 2, 1, 2, 1] = value
        K_位[1, 2, 1, 2, 2, 2, 2, 1] = value
        K_位[1, 2, 2, 1, 1, 1, 1, 2] = value
        K_位[1, 2, 2, 1, 2, 1, 1, 2] = value
        K_位[1, 2, 2, 2, 2, 1, 1, 1] = value
        K_位[1, 2, 2, 2, 2, 2, 1, 1] = value
        K_位[2, 1, 1, 1, 1, 2, 2, 2] = value
        K_位[2, 1, 1, 1, 2, 2, 2, 2] = value
        K_位[2, 1, 1, 2, 1, 1, 2, 1] = value
        K_位[2, 1, 1, 2, 1, 2, 2, 1] = value
        K_位[2, 1, 2, 1, 1, 2, 1, 2] = value
        K_位[2, 1, 2, 1, 2, 2, 1, 2] = value
        K_位[2, 1, 2, 2, 1, 1, 1, 1] = value
        K_位[2, 1, 2, 2, 1, 2, 1, 1] = value
        K_位[2, 2, 1, 1, 1, 2, 2, 2] = value
        K_位[2, 2, 1, 1, 2, 2, 2, 2] = value
        K_位[2, 2, 1, 2, 2, 1, 2, 1] = value
        K_位[2, 2, 1, 2, 2, 2, 2, 1] = value
        K_位[2, 2, 2, 1, 1, 2, 1, 2] = value
        K_位[2, 2, 2, 1, 2, 2, 1, 2] = value
        K_位[2, 2, 2, 2, 2, 1, 1, 1] = value
        K_位[2, 2, 2, 2, 2, 2, 1, 1] = value

        value = h[3] / 12
        K_位[1, 1, 1, 1, 1, 1, 1, 2] = value
        K_位[1, 1, 1, 1, 2, 1, 1, 2] = value
        K_位[1, 1, 1, 2, 1, 1, 1, 1] = value
        K_位[1, 1, 1, 2, 1, 2, 1, 1] = value
        K_位[1, 1, 2, 1, 1, 1, 2, 2] = value
        K_位[1, 1, 2, 1, 2, 1, 2, 2] = value
        K_位[1, 1, 2, 2, 1, 1, 2, 1] = value
        K_位[1, 1, 2, 2, 1, 2, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 1, 1, 2] = value
        K_位[1, 2, 1, 1, 2, 1, 1, 2] = value
        K_位[1, 2, 1, 2, 2, 1, 1, 1] = value
        K_位[1, 2, 1, 2, 2, 2, 1, 1] = value
        K_位[1, 2, 2, 1, 1, 1, 2, 2] = value
        K_位[1, 2, 2, 1, 2, 1, 2, 2] = value
        K_位[1, 2, 2, 2, 2, 1, 2, 1] = value
        K_位[1, 2, 2, 2, 2, 2, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 2, 1, 2] = value
        K_位[2, 1, 1, 1, 2, 2, 1, 2] = value
        K_位[2, 1, 1, 2, 1, 1, 1, 1] = value
        K_位[2, 1, 1, 2, 1, 2, 1, 1] = value
        K_位[2, 1, 2, 1, 1, 2, 2, 2] = value
        K_位[2, 1, 2, 1, 2, 2, 2, 2] = value
        K_位[2, 1, 2, 2, 1, 1, 2, 1] = value
        K_位[2, 1, 2, 2, 1, 2, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 2, 1, 2] = value
        K_位[2, 2, 1, 1, 2, 2, 1, 2] = value
        K_位[2, 2, 1, 2, 2, 1, 1, 1] = value
        K_位[2, 2, 1, 2, 2, 2, 1, 1] = value
        K_位[2, 2, 2, 1, 1, 2, 2, 2] = value
        K_位[2, 2, 2, 1, 2, 2, 2, 2] = value
        K_位[2, 2, 2, 2, 2, 1, 2, 1] = value
        K_位[2, 2, 2, 2, 2, 2, 2, 1] = value

        value = -(h[1] * h[3]) / (9 * h[2])
        K_位[1, 1, 1, 2, 1, 2, 1, 2] = value
        K_位[1, 1, 2, 2, 1, 2, 2, 2] = value
        K_位[1, 2, 1, 2, 1, 1, 1, 2] = value
        K_位[1, 2, 2, 2, 1, 1, 2, 2] = value
        K_位[2, 1, 1, 2, 2, 2, 1, 2] = value
        K_位[2, 1, 2, 2, 2, 2, 2, 2] = value
        K_位[2, 2, 1, 2, 2, 1, 1, 2] = value
        K_位[2, 2, 2, 2, 2, 1, 2, 2] = value

        value = -(h[1] * h[3]) / (18 * h[2])
        K_位[1, 1, 1, 2, 1, 2, 2, 2] = value
        K_位[1, 1, 1, 2, 2, 2, 1, 2] = value
        K_位[1, 1, 2, 2, 1, 2, 1, 2] = value
        K_位[1, 1, 2, 2, 2, 2, 2, 2] = value
        K_位[1, 2, 1, 2, 1, 1, 2, 2] = value
        K_位[1, 2, 1, 2, 2, 1, 1, 2] = value
        K_位[1, 2, 2, 2, 1, 1, 1, 2] = value
        K_位[1, 2, 2, 2, 2, 1, 2, 2] = value
        K_位[2, 1, 1, 2, 1, 2, 1, 2] = value
        K_位[2, 1, 1, 2, 2, 2, 2, 2] = value
        K_位[2, 1, 2, 2, 1, 2, 2, 2] = value
        K_位[2, 1, 2, 2, 2, 2, 1, 2] = value
        K_位[2, 2, 1, 2, 1, 1, 1, 2] = value
        K_位[2, 2, 1, 2, 2, 1, 2, 2] = value
        K_位[2, 2, 2, 2, 1, 1, 2, 2] = value
        K_位[2, 2, 2, 2, 2, 1, 1, 2] = value

        value = -(h[1] * h[3]) / (36 * h[2])
        K_位[1, 1, 1, 2, 2, 2, 2, 2] = value
        K_位[1, 1, 2, 2, 2, 2, 1, 2] = value
        K_位[1, 2, 1, 2, 2, 1, 2, 2] = value
        K_位[1, 2, 2, 2, 2, 1, 1, 2] = value
        K_位[2, 1, 1, 2, 1, 2, 2, 2] = value
        K_位[2, 1, 2, 2, 1, 2, 1, 2] = value
        K_位[2, 2, 1, 2, 1, 1, 2, 2] = value
        K_位[2, 2, 2, 2, 1, 1, 1, 2] = value

        value = (h[1] * h[3]) / (36 * h[2])
        K_位[1, 1, 1, 2, 2, 1, 2, 2] = value
        K_位[1, 1, 2, 2, 2, 1, 1, 2] = value
        K_位[1, 2, 1, 2, 2, 2, 2, 2] = value
        K_位[1, 2, 2, 2, 2, 2, 1, 2] = value
        K_位[2, 1, 1, 2, 1, 1, 2, 2] = value
        K_位[2, 1, 2, 2, 1, 1, 1, 2] = value
        K_位[2, 2, 1, 2, 1, 2, 2, 2] = value
        K_位[2, 2, 2, 2, 1, 2, 1, 2] = value

        value = (h[1] * h[3]) / (18 * h[2])
        K_位[1, 1, 1, 2, 1, 1, 2, 2] = value
        K_位[1, 1, 1, 2, 2, 1, 1, 2] = value
        K_位[1, 1, 2, 2, 1, 1, 1, 2] = value
        K_位[1, 1, 2, 2, 2, 1, 2, 2] = value
        K_位[1, 2, 1, 2, 1, 2, 2, 2] = value
        K_位[1, 2, 1, 2, 2, 2, 1, 2] = value
        K_位[1, 2, 2, 2, 1, 2, 1, 2] = value
        K_位[1, 2, 2, 2, 2, 2, 2, 2] = value
        K_位[2, 1, 1, 2, 1, 1, 1, 2] = value
        K_位[2, 1, 1, 2, 2, 1, 2, 2] = value
        K_位[2, 1, 2, 2, 1, 1, 2, 2] = value
        K_位[2, 1, 2, 2, 2, 1, 1, 2] = value
        K_位[2, 2, 1, 2, 1, 2, 1, 2] = value
        K_位[2, 2, 1, 2, 2, 2, 2, 2] = value
        K_位[2, 2, 2, 2, 1, 2, 2, 2] = value
        K_位[2, 2, 2, 2, 2, 2, 1, 2] = value

        value = (h[1] * h[3]) / (9 * h[2])
        K_位[1, 1, 1, 2, 1, 1, 1, 2] = value
        K_位[1, 1, 2, 2, 1, 1, 2, 2] = value
        K_位[1, 2, 1, 2, 1, 2, 1, 2] = value
        K_位[1, 2, 2, 2, 1, 2, 2, 2] = value
        K_位[2, 1, 1, 2, 2, 1, 1, 2] = value
        K_位[2, 1, 2, 2, 2, 1, 2, 2] = value
        K_位[2, 2, 1, 2, 2, 2, 1, 2] = value
        K_位[2, 2, 2, 2, 2, 2, 2, 2] = value

        value = -(h[2] * h[3]) / (9 * h[1])
        K_位[1, 1, 1, 1, 2, 1, 1, 1] = value
        K_位[1, 1, 2, 1, 2, 1, 2, 1] = value
        K_位[1, 2, 1, 1, 2, 2, 1, 1] = value
        K_位[1, 2, 2, 1, 2, 2, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 1, 1, 1] = value
        K_位[2, 1, 2, 1, 1, 1, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 2, 1, 1] = value
        K_位[2, 2, 2, 1, 1, 2, 2, 1] = value

        value = -(h[2] * h[3]) / (18 * h[1])
        K_位[1, 1, 1, 1, 2, 1, 2, 1] = value
        K_位[1, 1, 1, 1, 2, 2, 1, 1] = value
        K_位[1, 1, 2, 1, 2, 1, 1, 1] = value
        K_位[1, 1, 2, 1, 2, 2, 2, 1] = value
        K_位[1, 2, 1, 1, 2, 1, 1, 1] = value
        K_位[1, 2, 1, 1, 2, 2, 2, 1] = value
        K_位[1, 2, 2, 1, 2, 1, 2, 1] = value
        K_位[1, 2, 2, 1, 2, 2, 1, 1] = value
        K_位[2, 1, 1, 1, 1, 1, 2, 1] = value
        K_位[2, 1, 1, 1, 1, 2, 1, 1] = value
        K_位[2, 1, 2, 1, 1, 1, 1, 1] = value
        K_位[2, 1, 2, 1, 1, 2, 2, 1] = value
        K_位[2, 2, 1, 1, 1, 1, 1, 1] = value
        K_位[2, 2, 1, 1, 1, 2, 2, 1] = value
        K_位[2, 2, 2, 1, 1, 1, 2, 1] = value
        K_位[2, 2, 2, 1, 1, 2, 1, 1] = value

        value = -(h[2] * h[3]) / (36 * h[1])
        K_位[1, 1, 1, 1, 2, 2, 2, 1] = value
        K_位[1, 1, 2, 1, 2, 2, 1, 1] = value
        K_位[1, 2, 1, 1, 2, 1, 2, 1] = value
        K_位[1, 2, 2, 1, 2, 1, 1, 1] = value
        K_位[2, 1, 1, 1, 1, 2, 2, 1] = value
        K_位[2, 1, 2, 1, 1, 2, 1, 1] = value
        K_位[2, 2, 1, 1, 1, 1, 2, 1] = value
        K_位[2, 2, 2, 1, 1, 1, 1, 1] = value

        value = (h[2] * h[3]) / (36 * h[1])
        K_位[1, 1, 1, 1, 1, 2, 2, 1] = value
        K_位[1, 1, 2, 1, 1, 2, 1, 1] = value
        K_位[1, 2, 1, 1, 1, 1, 2, 1] = value
        K_位[1, 2, 2, 1, 1, 1, 1, 1] = value
        K_位[2, 1, 1, 1, 2, 2, 2, 1] = value
        K_位[2, 1, 2, 1, 2, 2, 1, 1] = value
        K_位[2, 2, 1, 1, 2, 1, 2, 1] = value
        K_位[2, 2, 2, 1, 2, 1, 1, 1] = value

        value = (h[2] * h[3]) / (18 * h[1])
        K_位[1, 1, 1, 1, 1, 1, 2, 1] = value
        K_位[1, 1, 1, 1, 1, 2, 1, 1] = value
        K_位[1, 1, 2, 1, 1, 1, 1, 1] = value
        K_位[1, 1, 2, 1, 1, 2, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 1, 1, 1] = value
        K_位[1, 2, 1, 1, 1, 2, 2, 1] = value
        K_位[1, 2, 2, 1, 1, 1, 2, 1] = value
        K_位[1, 2, 2, 1, 1, 2, 1, 1] = value
        K_位[2, 1, 1, 1, 2, 1, 2, 1] = value
        K_位[2, 1, 1, 1, 2, 2, 1, 1] = value
        K_位[2, 1, 2, 1, 2, 1, 1, 1] = value
        K_位[2, 1, 2, 1, 2, 2, 2, 1] = value
        K_位[2, 2, 1, 1, 2, 1, 1, 1] = value
        K_位[2, 2, 1, 1, 2, 2, 2, 1] = value
        K_位[2, 2, 2, 1, 2, 1, 2, 1] = value
        K_位[2, 2, 2, 1, 2, 2, 1, 1] = value

        value = (h[2] * h[3]) / (9 * h[1])
        K_位[1, 1, 1, 1, 1, 1, 1, 1] = value
        K_位[1, 1, 2, 1, 1, 1, 2, 1] = value
        K_位[1, 2, 1, 1, 1, 2, 1, 1] = value
        K_位[1, 2, 2, 1, 1, 2, 2, 1] = value
        K_位[2, 1, 1, 1, 2, 1, 1, 1] = value
        K_位[2, 1, 2, 1, 2, 1, 2, 1] = value
        K_位[2, 2, 1, 1, 2, 2, 1, 1] = value
        K_位[2, 2, 2, 1, 2, 2, 2, 1] = value
    else
    end
    return K_位
end

function expected_K_渭(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    K_渭 = zeros(Float64, fill(2, d)..., d, fill(2, d)..., d)
    if d == 2
        value = -1 / 4
        K_渭[1, 1, 1, 2, 1, 2] = value
        K_渭[1, 1, 1, 2, 2, 2] = value
        K_渭[1, 1, 2, 1, 2, 1] = value
        K_渭[1, 1, 2, 2, 2, 1] = value
        K_渭[1, 2, 1, 1, 1, 2] = value
        K_渭[1, 2, 1, 1, 2, 2] = value
        K_渭[1, 2, 2, 1, 2, 1] = value
        K_渭[1, 2, 2, 2, 2, 1] = value
        K_渭[2, 1, 1, 2, 1, 2] = value
        K_渭[2, 1, 1, 2, 2, 2] = value
        K_渭[2, 1, 2, 1, 1, 1] = value
        K_渭[2, 1, 2, 2, 1, 1] = value
        K_渭[2, 2, 1, 1, 1, 2] = value
        K_渭[2, 2, 1, 1, 2, 2] = value
        K_渭[2, 2, 2, 1, 1, 1] = value
        K_渭[2, 2, 2, 2, 1, 1] = value

        value = 1 / 4
        K_渭[1, 1, 1, 1, 1, 2] = value
        K_渭[1, 1, 1, 1, 2, 2] = value
        K_渭[1, 1, 2, 1, 1, 1] = value
        K_渭[1, 1, 2, 2, 1, 1] = value
        K_渭[1, 2, 1, 2, 1, 2] = value
        K_渭[1, 2, 1, 2, 2, 2] = value
        K_渭[1, 2, 2, 1, 1, 1] = value
        K_渭[1, 2, 2, 2, 1, 1] = value
        K_渭[2, 1, 1, 1, 1, 2] = value
        K_渭[2, 1, 1, 1, 2, 2] = value
        K_渭[2, 1, 2, 1, 2, 1] = value
        K_渭[2, 1, 2, 2, 2, 1] = value
        K_渭[2, 2, 1, 2, 1, 2] = value
        K_渭[2, 2, 1, 2, 2, 2] = value
        K_渭[2, 2, 2, 1, 2, 1] = value
        K_渭[2, 2, 2, 2, 2, 1] = value

        value = h[1] / (6 * h[2]) - (2 * h[2]) / (3 * h[1])
        K_渭[1, 1, 1, 2, 1, 1] = value
        K_渭[1, 2, 1, 2, 2, 1] = value
        K_渭[2, 1, 1, 1, 1, 1] = value
        K_渭[2, 2, 1, 1, 2, 1] = value

        value = (-h[2] / (3 * h[1])) - h[1] / (6 * h[2])
        K_渭[1, 1, 1, 2, 2, 1] = value
        K_渭[1, 2, 1, 2, 1, 1] = value
        K_渭[2, 1, 1, 1, 2, 1] = value
        K_渭[2, 2, 1, 1, 1, 1] = value

        value = h[1] / (3 * h[2]) - h[2] / (3 * h[1])
        K_渭[1, 1, 2, 2, 1, 2] = value
        K_渭[1, 2, 2, 2, 2, 2] = value
        K_渭[2, 1, 2, 1, 1, 2] = value
        K_渭[2, 2, 2, 1, 2, 2] = value

        value = (-h[2] / (6 * h[1])) - h[1] / (3 * h[2])
        K_渭[1, 1, 2, 2, 2, 2] = value
        K_渭[1, 2, 2, 2, 1, 2] = value
        K_渭[2, 1, 2, 1, 2, 2] = value
        K_渭[2, 2, 2, 1, 1, 2] = value

        value = h[2] / (6 * h[1]) - (2 * h[1]) / (3 * h[2])
        K_渭[1, 1, 2, 1, 2, 2] = value
        K_渭[1, 2, 2, 1, 1, 2] = value
        K_渭[2, 1, 2, 2, 2, 2] = value
        K_渭[2, 2, 2, 2, 1, 2] = value

        value = h[2] / (3 * h[1]) - h[1] / (3 * h[2])
        K_渭[1, 1, 1, 1, 2, 1] = value
        K_渭[1, 2, 1, 1, 1, 1] = value
        K_渭[2, 1, 1, 2, 2, 1] = value
        K_渭[2, 2, 1, 2, 1, 1] = value

        value = h[2] / (3 * h[1]) + (2 * h[1]) / (3 * h[2])
        K_渭[1, 1, 2, 1, 1, 2] = value
        K_渭[1, 2, 2, 1, 2, 2] = value
        K_渭[2, 1, 2, 2, 1, 2] = value
        K_渭[2, 2, 2, 2, 2, 2] = value

        value = (2 * h[2]) / (3 * h[1]) + h[1] / (3 * h[2])
        K_渭[1, 1, 1, 1, 1, 1] = value
        K_渭[1, 2, 1, 1, 2, 1] = value
        K_渭[2, 1, 1, 2, 1, 1] = value
        K_渭[2, 2, 1, 2, 2, 1] = value
    elseif d == 3
        value = -h[1] / 12
        K_渭[1, 1, 1, 2, 1, 2, 1, 3] = value
        K_渭[1, 1, 1, 2, 1, 2, 2, 3] = value
        K_渭[1, 1, 1, 3, 1, 1, 2, 2] = value
        K_渭[1, 1, 1, 3, 1, 2, 2, 2] = value
        K_渭[1, 1, 2, 2, 1, 1, 1, 3] = value
        K_渭[1, 1, 2, 2, 1, 1, 2, 3] = value
        K_渭[1, 1, 2, 3, 1, 1, 2, 2] = value
        K_渭[1, 1, 2, 3, 1, 2, 2, 2] = value
        K_渭[1, 2, 1, 2, 1, 2, 1, 3] = value
        K_渭[1, 2, 1, 2, 1, 2, 2, 3] = value
        K_渭[1, 2, 1, 3, 1, 1, 1, 2] = value
        K_渭[1, 2, 1, 3, 1, 2, 1, 2] = value
        K_渭[1, 2, 2, 2, 1, 1, 1, 3] = value
        K_渭[1, 2, 2, 2, 1, 1, 2, 3] = value
        K_渭[1, 2, 2, 3, 1, 1, 1, 2] = value
        K_渭[1, 2, 2, 3, 1, 2, 1, 2] = value
        K_渭[2, 1, 1, 2, 2, 2, 1, 3] = value
        K_渭[2, 1, 1, 2, 2, 2, 2, 3] = value
        K_渭[2, 1, 1, 3, 2, 1, 2, 2] = value
        K_渭[2, 1, 1, 3, 2, 2, 2, 2] = value
        K_渭[2, 1, 2, 2, 2, 1, 1, 3] = value
        K_渭[2, 1, 2, 2, 2, 1, 2, 3] = value
        K_渭[2, 1, 2, 3, 2, 1, 2, 2] = value
        K_渭[2, 1, 2, 3, 2, 2, 2, 2] = value
        K_渭[2, 2, 1, 2, 2, 2, 1, 3] = value
        K_渭[2, 2, 1, 2, 2, 2, 2, 3] = value
        K_渭[2, 2, 1, 3, 2, 1, 1, 2] = value
        K_渭[2, 2, 1, 3, 2, 2, 1, 2] = value
        K_渭[2, 2, 2, 2, 2, 1, 1, 3] = value
        K_渭[2, 2, 2, 2, 2, 1, 2, 3] = value
        K_渭[2, 2, 2, 3, 2, 1, 1, 2] = value
        K_渭[2, 2, 2, 3, 2, 2, 1, 2] = value

        value = -h[1] / 24
        K_渭[1, 1, 1, 2, 2, 2, 1, 3] = value
        K_渭[1, 1, 1, 2, 2, 2, 2, 3] = value
        K_渭[1, 1, 1, 3, 2, 1, 2, 2] = value
        K_渭[1, 1, 1, 3, 2, 2, 2, 2] = value
        K_渭[1, 1, 2, 2, 2, 1, 1, 3] = value
        K_渭[1, 1, 2, 2, 2, 1, 2, 3] = value
        K_渭[1, 1, 2, 3, 2, 1, 2, 2] = value
        K_渭[1, 1, 2, 3, 2, 2, 2, 2] = value
        K_渭[1, 2, 1, 2, 2, 2, 1, 3] = value
        K_渭[1, 2, 1, 2, 2, 2, 2, 3] = value
        K_渭[1, 2, 1, 3, 2, 1, 1, 2] = value
        K_渭[1, 2, 1, 3, 2, 2, 1, 2] = value
        K_渭[1, 2, 2, 2, 2, 1, 1, 3] = value
        K_渭[1, 2, 2, 2, 2, 1, 2, 3] = value
        K_渭[1, 2, 2, 3, 2, 1, 1, 2] = value
        K_渭[1, 2, 2, 3, 2, 2, 1, 2] = value
        K_渭[2, 1, 1, 2, 1, 2, 1, 3] = value
        K_渭[2, 1, 1, 2, 1, 2, 2, 3] = value
        K_渭[2, 1, 1, 3, 1, 1, 2, 2] = value
        K_渭[2, 1, 1, 3, 1, 2, 2, 2] = value
        K_渭[2, 1, 2, 2, 1, 1, 1, 3] = value
        K_渭[2, 1, 2, 2, 1, 1, 2, 3] = value
        K_渭[2, 1, 2, 3, 1, 1, 2, 2] = value
        K_渭[2, 1, 2, 3, 1, 2, 2, 2] = value
        K_渭[2, 2, 1, 2, 1, 2, 1, 3] = value
        K_渭[2, 2, 1, 2, 1, 2, 2, 3] = value
        K_渭[2, 2, 1, 3, 1, 1, 1, 2] = value
        K_渭[2, 2, 1, 3, 1, 2, 1, 2] = value
        K_渭[2, 2, 2, 2, 1, 1, 1, 3] = value
        K_渭[2, 2, 2, 2, 1, 1, 2, 3] = value
        K_渭[2, 2, 2, 3, 1, 1, 1, 2] = value
        K_渭[2, 2, 2, 3, 1, 2, 1, 2] = value

        value = h[1] / 24
        K_渭[1, 1, 1, 2, 2, 1, 1, 3] = value
        K_渭[1, 1, 1, 2, 2, 1, 2, 3] = value
        K_渭[1, 1, 1, 3, 2, 1, 1, 2] = value
        K_渭[1, 1, 1, 3, 2, 2, 1, 2] = value
        K_渭[1, 1, 2, 2, 2, 2, 1, 3] = value
        K_渭[1, 1, 2, 2, 2, 2, 2, 3] = value
        K_渭[1, 1, 2, 3, 2, 1, 1, 2] = value
        K_渭[1, 1, 2, 3, 2, 2, 1, 2] = value
        K_渭[1, 2, 1, 2, 2, 1, 1, 3] = value
        K_渭[1, 2, 1, 2, 2, 1, 2, 3] = value
        K_渭[1, 2, 1, 3, 2, 1, 2, 2] = value
        K_渭[1, 2, 1, 3, 2, 2, 2, 2] = value
        K_渭[1, 2, 2, 2, 2, 2, 1, 3] = value
        K_渭[1, 2, 2, 2, 2, 2, 2, 3] = value
        K_渭[1, 2, 2, 3, 2, 1, 2, 2] = value
        K_渭[1, 2, 2, 3, 2, 2, 2, 2] = value
        K_渭[2, 1, 1, 2, 1, 1, 1, 3] = value
        K_渭[2, 1, 1, 2, 1, 1, 2, 3] = value
        K_渭[2, 1, 1, 3, 1, 1, 1, 2] = value
        K_渭[2, 1, 1, 3, 1, 2, 1, 2] = value
        K_渭[2, 1, 2, 2, 1, 2, 1, 3] = value
        K_渭[2, 1, 2, 2, 1, 2, 2, 3] = value
        K_渭[2, 1, 2, 3, 1, 1, 1, 2] = value
        K_渭[2, 1, 2, 3, 1, 2, 1, 2] = value
        K_渭[2, 2, 1, 2, 1, 1, 1, 3] = value
        K_渭[2, 2, 1, 2, 1, 1, 2, 3] = value
        K_渭[2, 2, 1, 3, 1, 1, 2, 2] = value
        K_渭[2, 2, 1, 3, 1, 2, 2, 2] = value
        K_渭[2, 2, 2, 2, 1, 2, 1, 3] = value
        K_渭[2, 2, 2, 2, 1, 2, 2, 3] = value
        K_渭[2, 2, 2, 3, 1, 1, 2, 2] = value
        K_渭[2, 2, 2, 3, 1, 2, 2, 2] = value

        value = h[1] / 12
        K_渭[1, 1, 1, 2, 1, 1, 1, 3] = value
        K_渭[1, 1, 1, 2, 1, 1, 2, 3] = value
        K_渭[1, 1, 1, 3, 1, 1, 1, 2] = value
        K_渭[1, 1, 1, 3, 1, 2, 1, 2] = value
        K_渭[1, 1, 2, 2, 1, 2, 1, 3] = value
        K_渭[1, 1, 2, 2, 1, 2, 2, 3] = value
        K_渭[1, 1, 2, 3, 1, 1, 1, 2] = value
        K_渭[1, 1, 2, 3, 1, 2, 1, 2] = value
        K_渭[1, 2, 1, 2, 1, 1, 1, 3] = value
        K_渭[1, 2, 1, 2, 1, 1, 2, 3] = value
        K_渭[1, 2, 1, 3, 1, 1, 2, 2] = value
        K_渭[1, 2, 1, 3, 1, 2, 2, 2] = value
        K_渭[1, 2, 2, 2, 1, 2, 1, 3] = value
        K_渭[1, 2, 2, 2, 1, 2, 2, 3] = value
        K_渭[1, 2, 2, 3, 1, 1, 2, 2] = value
        K_渭[1, 2, 2, 3, 1, 2, 2, 2] = value
        K_渭[2, 1, 1, 2, 2, 1, 1, 3] = value
        K_渭[2, 1, 1, 2, 2, 1, 2, 3] = value
        K_渭[2, 1, 1, 3, 2, 1, 1, 2] = value
        K_渭[2, 1, 1, 3, 2, 2, 1, 2] = value
        K_渭[2, 1, 2, 2, 2, 2, 1, 3] = value
        K_渭[2, 1, 2, 2, 2, 2, 2, 3] = value
        K_渭[2, 1, 2, 3, 2, 1, 1, 2] = value
        K_渭[2, 1, 2, 3, 2, 2, 1, 2] = value
        K_渭[2, 2, 1, 2, 2, 1, 1, 3] = value
        K_渭[2, 2, 1, 2, 2, 1, 2, 3] = value
        K_渭[2, 2, 1, 3, 2, 1, 2, 2] = value
        K_渭[2, 2, 1, 3, 2, 2, 2, 2] = value
        K_渭[2, 2, 2, 2, 2, 2, 1, 3] = value
        K_渭[2, 2, 2, 2, 2, 2, 2, 3] = value
        K_渭[2, 2, 2, 3, 2, 1, 2, 2] = value
        K_渭[2, 2, 2, 3, 2, 2, 2, 2] = value

        value = -h[2] / 12
        K_渭[1, 1, 1, 1, 2, 1, 1, 3] = value
        K_渭[1, 1, 1, 1, 2, 1, 2, 3] = value
        K_渭[1, 1, 1, 3, 1, 1, 2, 1] = value
        K_渭[1, 1, 1, 3, 2, 1, 2, 1] = value
        K_渭[1, 1, 2, 1, 1, 1, 1, 3] = value
        K_渭[1, 1, 2, 1, 1, 1, 2, 3] = value
        K_渭[1, 1, 2, 3, 1, 1, 2, 1] = value
        K_渭[1, 1, 2, 3, 2, 1, 2, 1] = value
        K_渭[1, 2, 1, 1, 2, 2, 1, 3] = value
        K_渭[1, 2, 1, 1, 2, 2, 2, 3] = value
        K_渭[1, 2, 1, 3, 1, 2, 2, 1] = value
        K_渭[1, 2, 1, 3, 2, 2, 2, 1] = value
        K_渭[1, 2, 2, 1, 1, 2, 1, 3] = value
        K_渭[1, 2, 2, 1, 1, 2, 2, 3] = value
        K_渭[1, 2, 2, 3, 1, 2, 2, 1] = value
        K_渭[1, 2, 2, 3, 2, 2, 2, 1] = value
        K_渭[2, 1, 1, 1, 2, 1, 1, 3] = value
        K_渭[2, 1, 1, 1, 2, 1, 2, 3] = value
        K_渭[2, 1, 1, 3, 1, 1, 1, 1] = value
        K_渭[2, 1, 1, 3, 2, 1, 1, 1] = value
        K_渭[2, 1, 2, 1, 1, 1, 1, 3] = value
        K_渭[2, 1, 2, 1, 1, 1, 2, 3] = value
        K_渭[2, 1, 2, 3, 1, 1, 1, 1] = value
        K_渭[2, 1, 2, 3, 2, 1, 1, 1] = value
        K_渭[2, 2, 1, 1, 2, 2, 1, 3] = value
        K_渭[2, 2, 1, 1, 2, 2, 2, 3] = value
        K_渭[2, 2, 1, 3, 1, 2, 1, 1] = value
        K_渭[2, 2, 1, 3, 2, 2, 1, 1] = value
        K_渭[2, 2, 2, 1, 1, 2, 1, 3] = value
        K_渭[2, 2, 2, 1, 1, 2, 2, 3] = value
        K_渭[2, 2, 2, 3, 1, 2, 1, 1] = value
        K_渭[2, 2, 2, 3, 2, 2, 1, 1] = value

        value = -h[2] / 24
        K_渭[1, 1, 1, 1, 2, 2, 1, 3] = value
        K_渭[1, 1, 1, 1, 2, 2, 2, 3] = value
        K_渭[1, 1, 1, 3, 1, 2, 2, 1] = value
        K_渭[1, 1, 1, 3, 2, 2, 2, 1] = value
        K_渭[1, 1, 2, 1, 1, 2, 1, 3] = value
        K_渭[1, 1, 2, 1, 1, 2, 2, 3] = value
        K_渭[1, 1, 2, 3, 1, 2, 2, 1] = value
        K_渭[1, 1, 2, 3, 2, 2, 2, 1] = value
        K_渭[1, 2, 1, 1, 2, 1, 1, 3] = value
        K_渭[1, 2, 1, 1, 2, 1, 2, 3] = value
        K_渭[1, 2, 1, 3, 1, 1, 2, 1] = value
        K_渭[1, 2, 1, 3, 2, 1, 2, 1] = value
        K_渭[1, 2, 2, 1, 1, 1, 1, 3] = value
        K_渭[1, 2, 2, 1, 1, 1, 2, 3] = value
        K_渭[1, 2, 2, 3, 1, 1, 2, 1] = value
        K_渭[1, 2, 2, 3, 2, 1, 2, 1] = value
        K_渭[2, 1, 1, 1, 2, 2, 1, 3] = value
        K_渭[2, 1, 1, 1, 2, 2, 2, 3] = value
        K_渭[2, 1, 1, 3, 1, 2, 1, 1] = value
        K_渭[2, 1, 1, 3, 2, 2, 1, 1] = value
        K_渭[2, 1, 2, 1, 1, 2, 1, 3] = value
        K_渭[2, 1, 2, 1, 1, 2, 2, 3] = value
        K_渭[2, 1, 2, 3, 1, 2, 1, 1] = value
        K_渭[2, 1, 2, 3, 2, 2, 1, 1] = value
        K_渭[2, 2, 1, 1, 2, 1, 1, 3] = value
        K_渭[2, 2, 1, 1, 2, 1, 2, 3] = value
        K_渭[2, 2, 1, 3, 1, 1, 1, 1] = value
        K_渭[2, 2, 1, 3, 2, 1, 1, 1] = value
        K_渭[2, 2, 2, 1, 1, 1, 1, 3] = value
        K_渭[2, 2, 2, 1, 1, 1, 2, 3] = value
        K_渭[2, 2, 2, 3, 1, 1, 1, 1] = value
        K_渭[2, 2, 2, 3, 2, 1, 1, 1] = value

        value = h[2] / 24
        K_渭[1, 1, 1, 1, 1, 2, 1, 3] = value
        K_渭[1, 1, 1, 1, 1, 2, 2, 3] = value
        K_渭[1, 1, 1, 3, 1, 2, 1, 1] = value
        K_渭[1, 1, 1, 3, 2, 2, 1, 1] = value
        K_渭[1, 1, 2, 1, 2, 2, 1, 3] = value
        K_渭[1, 1, 2, 1, 2, 2, 2, 3] = value
        K_渭[1, 1, 2, 3, 1, 2, 1, 1] = value
        K_渭[1, 1, 2, 3, 2, 2, 1, 1] = value
        K_渭[1, 2, 1, 1, 1, 1, 1, 3] = value
        K_渭[1, 2, 1, 1, 1, 1, 2, 3] = value
        K_渭[1, 2, 1, 3, 1, 1, 1, 1] = value
        K_渭[1, 2, 1, 3, 2, 1, 1, 1] = value
        K_渭[1, 2, 2, 1, 2, 1, 1, 3] = value
        K_渭[1, 2, 2, 1, 2, 1, 2, 3] = value
        K_渭[1, 2, 2, 3, 1, 1, 1, 1] = value
        K_渭[1, 2, 2, 3, 2, 1, 1, 1] = value
        K_渭[2, 1, 1, 1, 1, 2, 1, 3] = value
        K_渭[2, 1, 1, 1, 1, 2, 2, 3] = value
        K_渭[2, 1, 1, 3, 1, 2, 2, 1] = value
        K_渭[2, 1, 1, 3, 2, 2, 2, 1] = value
        K_渭[2, 1, 2, 1, 2, 2, 1, 3] = value
        K_渭[2, 1, 2, 1, 2, 2, 2, 3] = value
        K_渭[2, 1, 2, 3, 1, 2, 2, 1] = value
        K_渭[2, 1, 2, 3, 2, 2, 2, 1] = value
        K_渭[2, 2, 1, 1, 1, 1, 1, 3] = value
        K_渭[2, 2, 1, 1, 1, 1, 2, 3] = value
        K_渭[2, 2, 1, 3, 1, 1, 2, 1] = value
        K_渭[2, 2, 1, 3, 2, 1, 2, 1] = value
        K_渭[2, 2, 2, 1, 2, 1, 1, 3] = value
        K_渭[2, 2, 2, 1, 2, 1, 2, 3] = value
        K_渭[2, 2, 2, 3, 1, 1, 2, 1] = value
        K_渭[2, 2, 2, 3, 2, 1, 2, 1] = value

        value = h[2] / 12
        K_渭[1, 1, 1, 1, 1, 1, 1, 3] = value
        K_渭[1, 1, 1, 1, 1, 1, 2, 3] = value
        K_渭[1, 1, 1, 3, 1, 1, 1, 1] = value
        K_渭[1, 1, 1, 3, 2, 1, 1, 1] = value
        K_渭[1, 1, 2, 1, 2, 1, 1, 3] = value
        K_渭[1, 1, 2, 1, 2, 1, 2, 3] = value
        K_渭[1, 1, 2, 3, 1, 1, 1, 1] = value
        K_渭[1, 1, 2, 3, 2, 1, 1, 1] = value
        K_渭[1, 2, 1, 1, 1, 2, 1, 3] = value
        K_渭[1, 2, 1, 1, 1, 2, 2, 3] = value
        K_渭[1, 2, 1, 3, 1, 2, 1, 1] = value
        K_渭[1, 2, 1, 3, 2, 2, 1, 1] = value
        K_渭[1, 2, 2, 1, 2, 2, 1, 3] = value
        K_渭[1, 2, 2, 1, 2, 2, 2, 3] = value
        K_渭[1, 2, 2, 3, 1, 2, 1, 1] = value
        K_渭[1, 2, 2, 3, 2, 2, 1, 1] = value
        K_渭[2, 1, 1, 1, 1, 1, 1, 3] = value
        K_渭[2, 1, 1, 1, 1, 1, 2, 3] = value
        K_渭[2, 1, 1, 3, 1, 1, 2, 1] = value
        K_渭[2, 1, 1, 3, 2, 1, 2, 1] = value
        K_渭[2, 1, 2, 1, 2, 1, 1, 3] = value
        K_渭[2, 1, 2, 1, 2, 1, 2, 3] = value
        K_渭[2, 1, 2, 3, 1, 1, 2, 1] = value
        K_渭[2, 1, 2, 3, 2, 1, 2, 1] = value
        K_渭[2, 2, 1, 1, 1, 2, 1, 3] = value
        K_渭[2, 2, 1, 1, 1, 2, 2, 3] = value
        K_渭[2, 2, 1, 3, 1, 2, 2, 1] = value
        K_渭[2, 2, 1, 3, 2, 2, 2, 1] = value
        K_渭[2, 2, 2, 1, 2, 2, 1, 3] = value
        K_渭[2, 2, 2, 1, 2, 2, 2, 3] = value
        K_渭[2, 2, 2, 3, 1, 2, 2, 1] = value
        K_渭[2, 2, 2, 3, 2, 2, 2, 1] = value

        value = -h[3] / 12
        K_渭[1, 1, 1, 1, 2, 1, 1, 2] = value
        K_渭[1, 1, 1, 1, 2, 2, 1, 2] = value
        K_渭[1, 1, 1, 2, 1, 2, 1, 1] = value
        K_渭[1, 1, 1, 2, 2, 2, 1, 1] = value
        K_渭[1, 1, 2, 1, 2, 1, 2, 2] = value
        K_渭[1, 1, 2, 1, 2, 2, 2, 2] = value
        K_渭[1, 1, 2, 2, 1, 2, 2, 1] = value
        K_渭[1, 1, 2, 2, 2, 2, 2, 1] = value
        K_渭[1, 2, 1, 1, 1, 1, 1, 2] = value
        K_渭[1, 2, 1, 1, 1, 2, 1, 2] = value
        K_渭[1, 2, 1, 2, 1, 2, 1, 1] = value
        K_渭[1, 2, 1, 2, 2, 2, 1, 1] = value
        K_渭[1, 2, 2, 1, 1, 1, 2, 2] = value
        K_渭[1, 2, 2, 1, 1, 2, 2, 2] = value
        K_渭[1, 2, 2, 2, 1, 2, 2, 1] = value
        K_渭[1, 2, 2, 2, 2, 2, 2, 1] = value
        K_渭[2, 1, 1, 1, 2, 1, 1, 2] = value
        K_渭[2, 1, 1, 1, 2, 2, 1, 2] = value
        K_渭[2, 1, 1, 2, 1, 1, 1, 1] = value
        K_渭[2, 1, 1, 2, 2, 1, 1, 1] = value
        K_渭[2, 1, 2, 1, 2, 1, 2, 2] = value
        K_渭[2, 1, 2, 1, 2, 2, 2, 2] = value
        K_渭[2, 1, 2, 2, 1, 1, 2, 1] = value
        K_渭[2, 1, 2, 2, 2, 1, 2, 1] = value
        K_渭[2, 2, 1, 1, 1, 1, 1, 2] = value
        K_渭[2, 2, 1, 1, 1, 2, 1, 2] = value
        K_渭[2, 2, 1, 2, 1, 1, 1, 1] = value
        K_渭[2, 2, 1, 2, 2, 1, 1, 1] = value
        K_渭[2, 2, 2, 1, 1, 1, 2, 2] = value
        K_渭[2, 2, 2, 1, 1, 2, 2, 2] = value
        K_渭[2, 2, 2, 2, 1, 1, 2, 1] = value
        K_渭[2, 2, 2, 2, 2, 1, 2, 1] = value

        value = -h[3] / 24
        K_渭[1, 1, 1, 1, 2, 1, 2, 2] = value
        K_渭[1, 1, 1, 1, 2, 2, 2, 2] = value
        K_渭[1, 1, 1, 2, 1, 2, 2, 1] = value
        K_渭[1, 1, 1, 2, 2, 2, 2, 1] = value
        K_渭[1, 1, 2, 1, 2, 1, 1, 2] = value
        K_渭[1, 1, 2, 1, 2, 2, 1, 2] = value
        K_渭[1, 1, 2, 2, 1, 2, 1, 1] = value
        K_渭[1, 1, 2, 2, 2, 2, 1, 1] = value
        K_渭[1, 2, 1, 1, 1, 1, 2, 2] = value
        K_渭[1, 2, 1, 1, 1, 2, 2, 2] = value
        K_渭[1, 2, 1, 2, 1, 2, 2, 1] = value
        K_渭[1, 2, 1, 2, 2, 2, 2, 1] = value
        K_渭[1, 2, 2, 1, 1, 1, 1, 2] = value
        K_渭[1, 2, 2, 1, 1, 2, 1, 2] = value
        K_渭[1, 2, 2, 2, 1, 2, 1, 1] = value
        K_渭[1, 2, 2, 2, 2, 2, 1, 1] = value
        K_渭[2, 1, 1, 1, 2, 1, 2, 2] = value
        K_渭[2, 1, 1, 1, 2, 2, 2, 2] = value
        K_渭[2, 1, 1, 2, 1, 1, 2, 1] = value
        K_渭[2, 1, 1, 2, 2, 1, 2, 1] = value
        K_渭[2, 1, 2, 1, 2, 1, 1, 2] = value
        K_渭[2, 1, 2, 1, 2, 2, 1, 2] = value
        K_渭[2, 1, 2, 2, 1, 1, 1, 1] = value
        K_渭[2, 1, 2, 2, 2, 1, 1, 1] = value
        K_渭[2, 2, 1, 1, 1, 1, 2, 2] = value
        K_渭[2, 2, 1, 1, 1, 2, 2, 2] = value
        K_渭[2, 2, 1, 2, 1, 1, 2, 1] = value
        K_渭[2, 2, 1, 2, 2, 1, 2, 1] = value
        K_渭[2, 2, 2, 1, 1, 1, 1, 2] = value
        K_渭[2, 2, 2, 1, 1, 2, 1, 2] = value
        K_渭[2, 2, 2, 2, 1, 1, 1, 1] = value
        K_渭[2, 2, 2, 2, 2, 1, 1, 1] = value

        value = h[3] / 24
        K_渭[1, 1, 1, 1, 1, 1, 2, 2] = value
        K_渭[1, 1, 1, 1, 1, 2, 2, 2] = value
        K_渭[1, 1, 1, 2, 1, 1, 2, 1] = value
        K_渭[1, 1, 1, 2, 2, 1, 2, 1] = value
        K_渭[1, 1, 2, 1, 1, 1, 1, 2] = value
        K_渭[1, 1, 2, 1, 1, 2, 1, 2] = value
        K_渭[1, 1, 2, 2, 1, 1, 1, 1] = value
        K_渭[1, 1, 2, 2, 2, 1, 1, 1] = value
        K_渭[1, 2, 1, 1, 2, 1, 2, 2] = value
        K_渭[1, 2, 1, 1, 2, 2, 2, 2] = value
        K_渭[1, 2, 1, 2, 1, 1, 2, 1] = value
        K_渭[1, 2, 1, 2, 2, 1, 2, 1] = value
        K_渭[1, 2, 2, 1, 2, 1, 1, 2] = value
        K_渭[1, 2, 2, 1, 2, 2, 1, 2] = value
        K_渭[1, 2, 2, 2, 1, 1, 1, 1] = value
        K_渭[1, 2, 2, 2, 2, 1, 1, 1] = value
        K_渭[2, 1, 1, 1, 1, 1, 2, 2] = value
        K_渭[2, 1, 1, 1, 1, 2, 2, 2] = value
        K_渭[2, 1, 1, 2, 1, 2, 2, 1] = value
        K_渭[2, 1, 1, 2, 2, 2, 2, 1] = value
        K_渭[2, 1, 2, 1, 1, 1, 1, 2] = value
        K_渭[2, 1, 2, 1, 1, 2, 1, 2] = value
        K_渭[2, 1, 2, 2, 1, 2, 1, 1] = value
        K_渭[2, 1, 2, 2, 2, 2, 1, 1] = value
        K_渭[2, 2, 1, 1, 2, 1, 2, 2] = value
        K_渭[2, 2, 1, 1, 2, 2, 2, 2] = value
        K_渭[2, 2, 1, 2, 1, 2, 2, 1] = value
        K_渭[2, 2, 1, 2, 2, 2, 2, 1] = value
        K_渭[2, 2, 2, 1, 2, 1, 1, 2] = value
        K_渭[2, 2, 2, 1, 2, 2, 1, 2] = value
        K_渭[2, 2, 2, 2, 1, 2, 1, 1] = value
        K_渭[2, 2, 2, 2, 2, 2, 1, 1] = value

        value = h[3] / 12
        K_渭[1, 1, 1, 1, 1, 1, 1, 2] = value
        K_渭[1, 1, 1, 1, 1, 2, 1, 2] = value
        K_渭[1, 1, 1, 2, 1, 1, 1, 1] = value
        K_渭[1, 1, 1, 2, 2, 1, 1, 1] = value
        K_渭[1, 1, 2, 1, 1, 1, 2, 2] = value
        K_渭[1, 1, 2, 1, 1, 2, 2, 2] = value
        K_渭[1, 1, 2, 2, 1, 1, 2, 1] = value
        K_渭[1, 1, 2, 2, 2, 1, 2, 1] = value
        K_渭[1, 2, 1, 1, 2, 1, 1, 2] = value
        K_渭[1, 2, 1, 1, 2, 2, 1, 2] = value
        K_渭[1, 2, 1, 2, 1, 1, 1, 1] = value
        K_渭[1, 2, 1, 2, 2, 1, 1, 1] = value
        K_渭[1, 2, 2, 1, 2, 1, 2, 2] = value
        K_渭[1, 2, 2, 1, 2, 2, 2, 2] = value
        K_渭[1, 2, 2, 2, 1, 1, 2, 1] = value
        K_渭[1, 2, 2, 2, 2, 1, 2, 1] = value
        K_渭[2, 1, 1, 1, 1, 1, 1, 2] = value
        K_渭[2, 1, 1, 1, 1, 2, 1, 2] = value
        K_渭[2, 1, 1, 2, 1, 2, 1, 1] = value
        K_渭[2, 1, 1, 2, 2, 2, 1, 1] = value
        K_渭[2, 1, 2, 1, 1, 1, 2, 2] = value
        K_渭[2, 1, 2, 1, 1, 2, 2, 2] = value
        K_渭[2, 1, 2, 2, 1, 2, 2, 1] = value
        K_渭[2, 1, 2, 2, 2, 2, 2, 1] = value
        K_渭[2, 2, 1, 1, 2, 1, 1, 2] = value
        K_渭[2, 2, 1, 1, 2, 2, 1, 2] = value
        K_渭[2, 2, 1, 2, 1, 2, 1, 1] = value
        K_渭[2, 2, 1, 2, 2, 2, 1, 1] = value
        K_渭[2, 2, 2, 1, 2, 1, 2, 2] = value
        K_渭[2, 2, 2, 1, 2, 2, 2, 2] = value
        K_渭[2, 2, 2, 2, 1, 2, 2, 1] = value
        K_渭[2, 2, 2, 2, 2, 2, 2, 1] = value

        value =
            (-(2 * h[2] * h[3]) / (9 * h[1])) +
            (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 1, 2, 1, 1, 1] = value
        K_渭[1, 1, 2, 1, 2, 1, 2, 1] = value
        K_渭[1, 2, 1, 1, 2, 2, 1, 1] = value
        K_渭[1, 2, 2, 1, 2, 2, 2, 1] = value
        K_渭[2, 1, 1, 1, 1, 1, 1, 1] = value
        K_渭[2, 1, 2, 1, 1, 1, 2, 1] = value
        K_渭[2, 2, 1, 1, 1, 2, 1, 1] = value
        K_渭[2, 2, 2, 1, 1, 2, 2, 1] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) - (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (36 * h[3])
        K_渭[1, 1, 1, 1, 2, 2, 1, 1] = value
        K_渭[1, 1, 2, 1, 2, 2, 2, 1] = value
        K_渭[1, 2, 1, 1, 2, 1, 1, 1] = value
        K_渭[1, 2, 2, 1, 2, 1, 2, 1] = value
        K_渭[2, 1, 1, 1, 1, 2, 1, 1] = value
        K_渭[2, 1, 2, 1, 1, 2, 2, 1] = value
        K_渭[2, 2, 1, 1, 1, 1, 1, 1] = value
        K_渭[2, 2, 2, 1, 1, 1, 2, 1] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) + (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 1, 2, 1, 2, 1] = value
        K_渭[1, 1, 2, 1, 2, 1, 1, 1] = value
        K_渭[1, 2, 1, 1, 2, 2, 2, 1] = value
        K_渭[1, 2, 2, 1, 2, 2, 1, 1] = value
        K_渭[2, 1, 1, 1, 1, 1, 2, 1] = value
        K_渭[2, 1, 2, 1, 1, 1, 1, 1] = value
        K_渭[2, 2, 1, 1, 1, 2, 2, 1] = value
        K_渭[2, 2, 2, 1, 1, 2, 1, 1] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) +
            (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 3, 2, 1, 1, 3] = value
        K_渭[1, 1, 2, 3, 2, 1, 2, 3] = value
        K_渭[1, 2, 1, 3, 2, 2, 1, 3] = value
        K_渭[1, 2, 2, 3, 2, 2, 2, 3] = value
        K_渭[2, 1, 1, 3, 1, 1, 1, 3] = value
        K_渭[2, 1, 2, 3, 1, 1, 2, 3] = value
        K_渭[2, 2, 1, 3, 1, 2, 1, 3] = value
        K_渭[2, 2, 2, 3, 1, 2, 2, 3] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) +
            (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 2, 2, 1, 1, 2] = value
        K_渭[1, 1, 2, 2, 2, 1, 2, 2] = value
        K_渭[1, 2, 1, 2, 2, 2, 1, 2] = value
        K_渭[1, 2, 2, 2, 2, 2, 2, 2] = value
        K_渭[2, 1, 1, 2, 1, 1, 1, 2] = value
        K_渭[2, 1, 2, 2, 1, 1, 2, 2] = value
        K_渭[2, 2, 1, 2, 1, 2, 1, 2] = value
        K_渭[2, 2, 2, 2, 1, 2, 2, 2] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) - (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (36 * h[3])
        K_渭[1, 1, 1, 2, 2, 2, 1, 2] = value
        K_渭[1, 1, 2, 2, 2, 2, 2, 2] = value
        K_渭[1, 2, 1, 2, 2, 1, 1, 2] = value
        K_渭[1, 2, 2, 2, 2, 1, 2, 2] = value
        K_渭[2, 1, 1, 2, 1, 2, 1, 2] = value
        K_渭[2, 1, 2, 2, 1, 2, 2, 2] = value
        K_渭[2, 2, 1, 2, 1, 1, 1, 2] = value
        K_渭[2, 2, 2, 2, 1, 1, 2, 2] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) - (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 3, 2, 2, 1, 3] = value
        K_渭[1, 1, 2, 3, 2, 2, 2, 3] = value
        K_渭[1, 2, 1, 3, 2, 1, 1, 3] = value
        K_渭[1, 2, 2, 3, 2, 1, 2, 3] = value
        K_渭[2, 1, 1, 3, 1, 2, 1, 3] = value
        K_渭[2, 1, 2, 3, 1, 2, 2, 3] = value
        K_渭[2, 2, 1, 3, 1, 1, 1, 3] = value
        K_渭[2, 2, 2, 3, 1, 1, 2, 3] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) - (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (36 * h[3])
        K_渭[1, 1, 1, 1, 2, 2, 2, 1] = value
        K_渭[1, 1, 2, 1, 2, 2, 1, 1] = value
        K_渭[1, 2, 1, 1, 2, 1, 2, 1] = value
        K_渭[1, 2, 2, 1, 2, 1, 1, 1] = value
        K_渭[2, 1, 1, 1, 1, 2, 2, 1] = value
        K_渭[2, 1, 2, 1, 1, 2, 1, 1] = value
        K_渭[2, 2, 1, 1, 1, 1, 2, 1] = value
        K_渭[2, 2, 2, 1, 1, 1, 1, 1] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) + (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 3, 2, 1, 2, 3] = value
        K_渭[1, 1, 2, 3, 2, 1, 1, 3] = value
        K_渭[1, 2, 1, 3, 2, 2, 2, 3] = value
        K_渭[1, 2, 2, 3, 2, 2, 1, 3] = value
        K_渭[2, 1, 1, 3, 1, 1, 2, 3] = value
        K_渭[2, 1, 2, 3, 1, 1, 1, 3] = value
        K_渭[2, 2, 1, 3, 1, 2, 2, 3] = value
        K_渭[2, 2, 2, 3, 1, 2, 1, 3] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) + (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 2, 2, 1, 2, 2] = value
        K_渭[1, 1, 2, 2, 2, 1, 1, 2] = value
        K_渭[1, 2, 1, 2, 2, 2, 2, 2] = value
        K_渭[1, 2, 2, 2, 2, 2, 1, 2] = value
        K_渭[2, 1, 1, 2, 1, 1, 2, 2] = value
        K_渭[2, 1, 2, 2, 1, 1, 1, 2] = value
        K_渭[2, 2, 1, 2, 1, 2, 2, 2] = value
        K_渭[2, 2, 2, 2, 1, 2, 1, 2] = value

        value =
            (-(h[2] * h[3]) / (36 * h[1])) - (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (36 * h[3])
        K_渭[1, 1, 1, 2, 2, 2, 2, 2] = value
        K_渭[1, 1, 2, 2, 2, 2, 1, 2] = value
        K_渭[1, 2, 1, 2, 2, 1, 2, 2] = value
        K_渭[1, 2, 2, 2, 2, 1, 1, 2] = value
        K_渭[2, 1, 1, 2, 1, 2, 2, 2] = value
        K_渭[2, 1, 2, 2, 1, 2, 1, 2] = value
        K_渭[2, 2, 1, 2, 1, 1, 2, 2] = value
        K_渭[2, 2, 2, 2, 1, 1, 1, 2] = value

        value =
            (-(h[2] * h[3]) / (36 * h[1])) - (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 3, 2, 2, 2, 3] = value
        K_渭[1, 1, 2, 3, 2, 2, 1, 3] = value
        K_渭[1, 2, 1, 3, 2, 1, 2, 3] = value
        K_渭[1, 2, 2, 3, 2, 1, 1, 3] = value
        K_渭[2, 1, 1, 3, 1, 2, 2, 3] = value
        K_渭[2, 1, 2, 3, 1, 2, 1, 3] = value
        K_渭[2, 2, 1, 3, 1, 1, 2, 3] = value
        K_渭[2, 2, 2, 3, 1, 1, 1, 3] = value

        value =
            (h[2] * h[3]) / (36 * h[1]) - (h[1] * h[3]) / (9 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 2, 1, 2, 2, 2] = value
        K_渭[1, 1, 2, 2, 1, 2, 1, 2] = value
        K_渭[1, 2, 1, 2, 1, 1, 2, 2] = value
        K_渭[1, 2, 2, 2, 1, 1, 1, 2] = value
        K_渭[2, 1, 1, 2, 2, 2, 2, 2] = value
        K_渭[2, 1, 2, 2, 2, 2, 1, 2] = value
        K_渭[2, 2, 1, 2, 2, 1, 2, 2] = value
        K_渭[2, 2, 2, 2, 2, 1, 1, 2] = value

        value =
            (h[2] * h[3]) / (36 * h[1]) - (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 3, 1, 2, 2, 3] = value
        K_渭[1, 1, 2, 3, 1, 2, 1, 3] = value
        K_渭[1, 2, 1, 3, 1, 1, 2, 3] = value
        K_渭[1, 2, 2, 3, 1, 1, 1, 3] = value
        K_渭[2, 1, 1, 3, 2, 2, 2, 3] = value
        K_渭[2, 1, 2, 3, 2, 2, 1, 3] = value
        K_渭[2, 2, 1, 3, 2, 1, 2, 3] = value
        K_渭[2, 2, 2, 3, 2, 1, 1, 3] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) - (2 * h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 2, 1, 2, 1, 2] = value
        K_渭[1, 1, 2, 2, 1, 2, 2, 2] = value
        K_渭[1, 2, 1, 2, 1, 1, 1, 2] = value
        K_渭[1, 2, 2, 2, 1, 1, 2, 2] = value
        K_渭[2, 1, 1, 2, 2, 2, 1, 2] = value
        K_渭[2, 1, 2, 2, 2, 2, 2, 2] = value
        K_渭[2, 2, 1, 2, 2, 1, 1, 2] = value
        K_渭[2, 2, 2, 2, 2, 1, 2, 2] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) - (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 3, 1, 2, 1, 3] = value
        K_渭[1, 1, 2, 3, 1, 2, 2, 3] = value
        K_渭[1, 2, 1, 3, 1, 1, 1, 3] = value
        K_渭[1, 2, 2, 3, 1, 1, 2, 3] = value
        K_渭[2, 1, 1, 3, 2, 2, 1, 3] = value
        K_渭[2, 1, 2, 3, 2, 2, 2, 3] = value
        K_渭[2, 2, 1, 3, 2, 1, 1, 3] = value
        K_渭[2, 2, 2, 3, 2, 1, 2, 3] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) - (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 1, 1, 2, 2, 1] = value
        K_渭[1, 1, 2, 1, 1, 2, 1, 1] = value
        K_渭[1, 2, 1, 1, 1, 1, 2, 1] = value
        K_渭[1, 2, 2, 1, 1, 1, 1, 1] = value
        K_渭[2, 1, 1, 1, 2, 2, 2, 1] = value
        K_渭[2, 1, 2, 1, 2, 2, 1, 1] = value
        K_渭[2, 2, 1, 1, 2, 1, 2, 1] = value
        K_渭[2, 2, 2, 1, 2, 1, 1, 1] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) + (h[1] * h[3]) / (18 * h[2]) -
            (2 * h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 3, 1, 1, 2, 3] = value
        K_渭[1, 1, 2, 3, 1, 1, 1, 3] = value
        K_渭[1, 2, 1, 3, 1, 2, 2, 3] = value
        K_渭[1, 2, 2, 3, 1, 2, 1, 3] = value
        K_渭[2, 1, 1, 3, 2, 1, 2, 3] = value
        K_渭[2, 1, 2, 3, 2, 1, 1, 3] = value
        K_渭[2, 2, 1, 3, 2, 2, 2, 3] = value
        K_渭[2, 2, 2, 3, 2, 2, 1, 3] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) + (h[1] * h[3]) / (9 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 2, 1, 1, 2, 2] = value
        K_渭[1, 1, 2, 2, 1, 1, 1, 2] = value
        K_渭[1, 2, 1, 2, 1, 2, 2, 2] = value
        K_渭[1, 2, 2, 2, 1, 2, 1, 2] = value
        K_渭[2, 1, 1, 2, 2, 1, 2, 2] = value
        K_渭[2, 1, 2, 2, 2, 1, 1, 2] = value
        K_渭[2, 2, 1, 2, 2, 2, 2, 2] = value
        K_渭[2, 2, 2, 2, 2, 2, 1, 2] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) - (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_渭[1, 1, 1, 1, 1, 2, 1, 1] = value
        K_渭[1, 1, 2, 1, 1, 2, 2, 1] = value
        K_渭[1, 2, 1, 1, 1, 1, 1, 1] = value
        K_渭[1, 2, 2, 1, 1, 1, 2, 1] = value
        K_渭[2, 1, 1, 1, 2, 2, 1, 1] = value
        K_渭[2, 1, 2, 1, 2, 2, 2, 1] = value
        K_渭[2, 2, 1, 1, 2, 1, 1, 1] = value
        K_渭[2, 2, 2, 1, 2, 1, 2, 1] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) + (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 1, 1, 1, 2, 1] = value
        K_渭[1, 1, 2, 1, 1, 1, 1, 1] = value
        K_渭[1, 2, 1, 1, 1, 2, 2, 1] = value
        K_渭[1, 2, 2, 1, 1, 2, 1, 1] = value
        K_渭[2, 1, 1, 1, 2, 1, 2, 1] = value
        K_渭[2, 1, 2, 1, 2, 1, 1, 1] = value
        K_渭[2, 2, 1, 1, 2, 2, 2, 1] = value
        K_渭[2, 2, 2, 1, 2, 2, 1, 1] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) +
            (h[1] * h[3]) / (9 * h[2]) +
            (2 * h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 3, 1, 1, 1, 3] = value
        K_渭[1, 1, 2, 3, 1, 1, 2, 3] = value
        K_渭[1, 2, 1, 3, 1, 2, 1, 3] = value
        K_渭[1, 2, 2, 3, 1, 2, 2, 3] = value
        K_渭[2, 1, 1, 3, 2, 1, 1, 3] = value
        K_渭[2, 1, 2, 3, 2, 1, 2, 3] = value
        K_渭[2, 2, 1, 3, 2, 2, 1, 3] = value
        K_渭[2, 2, 2, 3, 2, 2, 2, 3] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) +
            (2 * h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 2, 1, 1, 1, 2] = value
        K_渭[1, 1, 2, 2, 1, 1, 2, 2] = value
        K_渭[1, 2, 1, 2, 1, 2, 1, 2] = value
        K_渭[1, 2, 2, 2, 1, 2, 2, 2] = value
        K_渭[2, 1, 1, 2, 2, 1, 1, 2] = value
        K_渭[2, 1, 2, 2, 2, 1, 2, 2] = value
        K_渭[2, 2, 1, 2, 2, 2, 1, 2] = value
        K_渭[2, 2, 2, 2, 2, 2, 2, 2] = value

        value =
            (2 * h[2] * h[3]) / (9 * h[1]) +
            (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_渭[1, 1, 1, 1, 1, 1, 1, 1] = value
        K_渭[1, 1, 2, 1, 1, 1, 2, 1] = value
        K_渭[1, 2, 1, 1, 1, 2, 1, 1] = value
        K_渭[1, 2, 2, 1, 1, 2, 2, 1] = value
        K_渭[2, 1, 1, 1, 2, 1, 1, 1] = value
        K_渭[2, 1, 2, 1, 2, 1, 2, 1] = value
        K_渭[2, 2, 1, 1, 2, 2, 1, 1] = value
        K_渭[2, 2, 2, 1, 2, 2, 2, 1] = value
    else
    end
    return K_渭
end

@testset "GaussLegendre integration" begin
    h3 = [1.1, 1.2, 1.3]
    order = 2
    for d = 1:3
        @testset "Gauss-Legendre integration, $(d)d" begin
            for n in map(Tuple, CartesianIndices(Tuple(fill(1:(2*order-1), d))))
                h = h3[1:d]
                actual = integrate(x -> prod(x .^ n), h)
                n1 = n .+ 1
                expected = prod(((h / 2) .^ n1 .- (-h / 2) .^ n1) ./ n1)
                @test actual  expected rtol = 1e-15 atol = 1e-15
            end
        end
    end
end

@testset "Node numbering" begin
    for d = 1:3
        h = [1.1, 1.2, 1.3][1:d]
         = element_nodes(d)
        for m  
            x = h .* (-1) .^ Tuple(m) / 2
            N = shape(x, h)
            for n  
                @test N[n] == Float64(m == n)
            end
        end
    end
end

@testset "Brick element operators" begin
    for d = 2:3
        @testset "Brick element operators, $(d)d" begin
            # Note: reference values where computed with maxima
            # (see `ref/nd_brick_elasticity.mac`).
            h = [1.1, 1.2, 1.3][1:d]
            渭 = 5.6
            谓 = 0.3
            位 = 2渭 * 谓 / (1 - 2谓)

            @testset "Average gradient_operator, $(d)d" begin
                D_act = Scapin.avg_gradient_operator(h)
                D_exp = expected_avg_gradient_operator(h)
                @test D_act  D_exp rtol = 1e-15 atol = 1e-15
            end

            @testset "Average strain-displacement matrix, $(d)d" begin
                B_act = avg_strain_displacement_operator(h)
                B_exp = expected_avg_strain_displacement_operator(h)
                @test B_act  B_exp rtol = 1e-15 atol = 1e-15
            end

            @testset "Stiffness operator, $(d)d" begin
                K_act = stiffness_operator(h, 渭, 谓)
                K_位 = expected_K_位(h)
                K_渭 = expected_K_渭(h)
                K_exp = 位 * K_位 + 渭 * K_渭
                @test K_act  K_exp rtol = 1e-15 atol = 1e-15
            end
        end
    end
end

@testset "Connectivity" begin
    @testset "Connectivity, 2d" begin
        """
        1
                                 
          (1, 4)  (2, 4)  (3, 4) 
                                 
        4尖尖尖
                                 
          (1, 3)  (2, 3)  (3, 3) 
                                 
        3尖尖尖
                                 
          (1, 2)  (2, 2)  (3, 2) 
                                 
        2尖尖尖
                                 
          (1, 1)  (2, 1)  (3, 1) 
                                 
        1尖尖尖
         1        2        3        1
        """
        N = [3, 4]
        d = size(N, 1)
        dims = Tuple(1:n for n in N)
        linear = LinearIndices(dims)
        @test element_nodes((1, 1), N) == [(1, 1), (2, 1), (1, 2), (2, 2)]
        @test element_nodes((2, 1), N) == [(2, 1), (3, 1), (2, 2), (3, 2)]
        @test element_nodes((3, 1), N) == [(3, 1), (1, 1), (3, 2), (1, 2)]
        @test element_nodes((1, 2), N) == [(1, 2), (2, 2), (1, 3), (2, 3)]
        @test element_nodes((2, 2), N) == [(2, 2), (3, 2), (2, 3), (3, 3)]
        @test element_nodes((3, 2), N) == [(3, 2), (1, 2), (3, 3), (1, 3)]
        @test element_nodes((1, 3), N) == [(1, 3), (2, 3), (1, 4), (2, 4)]
        @test element_nodes((2, 3), N) == [(2, 3), (3, 3), (2, 4), (3, 4)]
        @test element_nodes((3, 3), N) == [(3, 3), (1, 3), (3, 4), (1, 4)]
        @test element_nodes((1, 4), N) == [(1, 4), (2, 4), (1, 1), (2, 1)]
        @test element_nodes((2, 4), N) == [(2, 4), (3, 4), (2, 1), (3, 1)]
        @test element_nodes((3, 4), N) == [(3, 4), (1, 4), (3, 1), (1, 1)]
    end

    @testset "Connectivity, 3d" begin
        """
        1234
                                         
         (1, 4, 1)  (2, 4, 1)  (3, 4, 1) 
                                         
        10111210
                                         
         (1, 3, 1)  (2, 3, 1)  (3, 3, 1) 
                                         
        7897
                                         
         (1, 2, 1)  (2, 2, 1)  (3, 2, 1) 
                                         
        4564
                                         
         (1, 1, 1)  (2, 1, 1)  (3, 1, 1) 
                                         
        1231


        13141513
                                         
         (1, 4, 2)  (2, 4, 2)  (3, 4, 2) 
                                         
        22232422
                                         
         (1, 3, 2)  (2, 3, 2)  (3, 3, 2) 
                                         
        19202119
                                         
         (1, 2, 2)  (2, 2, 2)  (3, 2, 2) 
                                         
        16171816
                                         
         (1, 1, 2)  (2, 1, 2)  (3, 1, 2) 
                                         
        13141513


        25262725
                                         
         (1, 4, 3)  (2, 4, 3)  (3, 4, 3) 
                                         
        34353634
                                         
         (1, 3, 3)  (2, 3, 3)  (3, 3, 3) 
                                         
        31323331
                                         
         (1, 2, 3)  (2, 2, 3)  (3, 2, 3) 
                                         
        28293028
                                         
         (1, 1, 3)  (2, 1, 3)  (3, 1, 3) 
                                         
        25262725


        37383937
                                         
         (1, 4, 4)  (2, 4, 4)  (3, 4, 4) 
                                         
        46474846
                                         
         (1, 3, 4)  (2, 3, 4)  (3, 3, 4) 
                                         
        43444543
                                         
         (1, 2, 4)  (2, 2, 4)  (3, 2, 4) 
                                         
        40414240
                                         
         (1, 1, 4)  (2, 1, 4)  (3, 1, 4) 
                                         
        37383937


        49505149
                                         
         (1, 4, 5)  (2, 4, 5)  (3, 4, 5) 
                                         
        58596058
                                         
         (1, 3, 5)  (2, 3, 5)  (3, 3, 5) 
                                         
        55565755
                                         
         (1, 2, 5)  (2, 2, 5)  (3, 2, 5) 
                                         
        52535452
                                         
         (1, 1, 5)  (2, 1, 5)  (3, 1, 5) 
                                         
        49505149


        1234
                                         
                                         
                                         
        10111210
                                         
                                         
                                         
        7897
                                         
                                         
                                         
        4564
                                         
                                         
                                         
        1231

        """
        N = [3, 4, 5]
        d = size(N, 1)
        dims = Tuple(1:n for n in N)
        linear = LinearIndices(dims)
        @test element_nodes((1, 1, 1), N) == [
            (1, 1, 1),
            (2, 1, 1),
            (1, 2, 1),
            (2, 2, 1),
            (1, 1, 2),
            (2, 1, 2),
            (1, 2, 2),
            (2, 2, 2),
        ]
        @test element_nodes((2, 1, 1), N) == [
            (2, 1, 1),
            (3, 1, 1),
            (2, 2, 1),
            (3, 2, 1),
            (2, 1, 2),
            (3, 1, 2),
            (2, 2, 2),
            (3, 2, 2),
        ]
        @test element_nodes((3, 1, 1), N) == [
            (3, 1, 1),
            (1, 1, 1),
            (3, 2, 1),
            (1, 2, 1),
            (3, 1, 2),
            (1, 1, 2),
            (3, 2, 2),
            (1, 2, 2),
        ]
        @test element_nodes((1, 2, 1), N) == [
            (1, 2, 1),
            (2, 2, 1),
            (1, 3, 1),
            (2, 3, 1),
            (1, 2, 2),
            (2, 2, 2),
            (1, 3, 2),
            (2, 3, 2),
        ]
        @test element_nodes((2, 2, 1), N) == [
            (2, 2, 1),
            (3, 2, 1),
            (2, 3, 1),
            (3, 3, 1),
            (2, 2, 2),
            (3, 2, 2),
            (2, 3, 2),
            (3, 3, 2),
        ]
        @test element_nodes((3, 2, 1), N) == [
            (3, 2, 1),
            (1, 2, 1),
            (3, 3, 1),
            (1, 3, 1),
            (3, 2, 2),
            (1, 2, 2),
            (3, 3, 2),
            (1, 3, 2),
        ]
        @test element_nodes((1, 3, 1), N) == [
            (1, 3, 1),
            (2, 3, 1),
            (1, 4, 1),
            (2, 4, 1),
            (1, 3, 2),
            (2, 3, 2),
            (1, 4, 2),
            (2, 4, 2),
        ]
        @test element_nodes((2, 3, 1), N) == [
            (2, 3, 1),
            (3, 3, 1),
            (2, 4, 1),
            (3, 4, 1),
            (2, 3, 2),
            (3, 3, 2),
            (2, 4, 2),
            (3, 4, 2),
        ]
        @test element_nodes((3, 3, 1), N) == [
            (3, 3, 1),
            (1, 3, 1),
            (3, 4, 1),
            (1, 4, 1),
            (3, 3, 2),
            (1, 3, 2),
            (3, 4, 2),
            (1, 4, 2),
        ]
        @test element_nodes((1, 4, 1), N) == [
            (1, 4, 1),
            (2, 4, 1),
            (1, 1, 1),
            (2, 1, 1),
            (1, 4, 2),
            (2, 4, 2),
            (1, 1, 2),
            (2, 1, 2),
        ]
        @test element_nodes((2, 4, 1), N) == [
            (2, 4, 1),
            (3, 4, 1),
            (2, 1, 1),
            (3, 1, 1),
            (2, 4, 2),
            (3, 4, 2),
            (2, 1, 2),
            (3, 1, 2),
        ]
        @test element_nodes((3, 4, 1), N) == [
            (3, 4, 1),
            (1, 4, 1),
            (3, 1, 1),
            (1, 1, 1),
            (3, 4, 2),
            (1, 4, 2),
            (3, 1, 2),
            (1, 1, 2),
        ]

        @test element_nodes((1, 1, 2), N) == [
            (1, 1, 2),
            (2, 1, 2),
            (1, 2, 2),
            (2, 2, 2),
            (1, 1, 3),
            (2, 1, 3),
            (1, 2, 3),
            (2, 2, 3),
        ]
        @test element_nodes((2, 1, 2), N) == [
            (2, 1, 2),
            (3, 1, 2),
            (2, 2, 2),
            (3, 2, 2),
            (2, 1, 3),
            (3, 1, 3),
            (2, 2, 3),
            (3, 2, 3),
        ]
        @test element_nodes((3, 1, 2), N) == [
            (3, 1, 2),
            (1, 1, 2),
            (3, 2, 2),
            (1, 2, 2),
            (3, 1, 3),
            (1, 1, 3),
            (3, 2, 3),
            (1, 2, 3),
        ]
        @test element_nodes((1, 2, 2), N) == [
            (1, 2, 2),
            (2, 2, 2),
            (1, 3, 2),
            (2, 3, 2),
            (1, 2, 3),
            (2, 2, 3),
            (1, 3, 3),
            (2, 3, 3),
        ]
        @test element_nodes((2, 2, 2), N) == [
            (2, 2, 2),
            (3, 2, 2),
            (2, 3, 2),
            (3, 3, 2),
            (2, 2, 3),
            (3, 2, 3),
            (2, 3, 3),
            (3, 3, 3),
        ]
        @test element_nodes((3, 2, 2), N) == [
            (3, 2, 2),
            (1, 2, 2),
            (3, 3, 2),
            (1, 3, 2),
            (3, 2, 3),
            (1, 2, 3),
            (3, 3, 3),
            (1, 3, 3),
        ]
        @test element_nodes((1, 3, 2), N) == [
            (1, 3, 2),
            (2, 3, 2),
            (1, 4, 2),
            (2, 4, 2),
            (1, 3, 3),
            (2, 3, 3),
            (1, 4, 3),
            (2, 4, 3),
        ]
        @test element_nodes((2, 3, 2), N) == [
            (2, 3, 2),
            (3, 3, 2),
            (2, 4, 2),
            (3, 4, 2),
            (2, 3, 3),
            (3, 3, 3),
            (2, 4, 3),
            (3, 4, 3),
        ]
        @test element_nodes((3, 3, 2), N) == [
            (3, 3, 2),
            (1, 3, 2),
            (3, 4, 2),
            (1, 4, 2),
            (3, 3, 3),
            (1, 3, 3),
            (3, 4, 3),
            (1, 4, 3),
        ]
        @test element_nodes((1, 4, 2), N) == [
            (1, 4, 2),
            (2, 4, 2),
            (1, 1, 2),
            (2, 1, 2),
            (1, 4, 3),
            (2, 4, 3),
            (1, 1, 3),
            (2, 1, 3),
        ]
        @test element_nodes((2, 4, 2), N) == [
            (2, 4, 2),
            (3, 4, 2),
            (2, 1, 2),
            (3, 1, 2),
            (2, 4, 3),
            (3, 4, 3),
            (2, 1, 3),
            (3, 1, 3),
        ]
        @test element_nodes((3, 4, 2), N) == [
            (3, 4, 2),
            (1, 4, 2),
            (3, 1, 2),
            (1, 1, 2),
            (3, 4, 3),
            (1, 4, 3),
            (3, 1, 3),
            (1, 1, 3),
        ]

        @test element_nodes((1, 1, 3), N) == [
            (1, 1, 3),
            (2, 1, 3),
            (1, 2, 3),
            (2, 2, 3),
            (1, 1, 4),
            (2, 1, 4),
            (1, 2, 4),
            (2, 2, 4),
        ]
        @test element_nodes((2, 1, 3), N) == [
            (2, 1, 3),
            (3, 1, 3),
            (2, 2, 3),
            (3, 2, 3),
            (2, 1, 4),
            (3, 1, 4),
            (2, 2, 4),
            (3, 2, 4),
        ]
        @test element_nodes((3, 1, 3), N) == [
            (3, 1, 3),
            (1, 1, 3),
            (3, 2, 3),
            (1, 2, 3),
            (3, 1, 4),
            (1, 1, 4),
            (3, 2, 4),
            (1, 2, 4),
        ]
        @test element_nodes((1, 2, 3), N) == [
            (1, 2, 3),
            (2, 2, 3),
            (1, 3, 3),
            (2, 3, 3),
            (1, 2, 4),
            (2, 2, 4),
            (1, 3, 4),
            (2, 3, 4),
        ]
        @test element_nodes((2, 2, 3), N) == [
            (2, 2, 3),
            (3, 2, 3),
            (2, 3, 3),
            (3, 3, 3),
            (2, 2, 4),
            (3, 2, 4),
            (2, 3, 4),
            (3, 3, 4),
        ]
        @test element_nodes((3, 2, 3), N) == [
            (3, 2, 3),
            (1, 2, 3),
            (3, 3, 3),
            (1, 3, 3),
            (3, 2, 4),
            (1, 2, 4),
            (3, 3, 4),
            (1, 3, 4),
        ]
        @test element_nodes((1, 3, 3), N) == [
            (1, 3, 3),
            (2, 3, 3),
            (1, 4, 3),
            (2, 4, 3),
            (1, 3, 4),
            (2, 3, 4),
            (1, 4, 4),
            (2, 4, 4),
        ]
        @test element_nodes((2, 3, 3), N) == [
            (2, 3, 3),
            (3, 3, 3),
            (2, 4, 3),
            (3, 4, 3),
            (2, 3, 4),
            (3, 3, 4),
            (2, 4, 4),
            (3, 4, 4),
        ]
        @test element_nodes((3, 3, 3), N) == [
            (3, 3, 3),
            (1, 3, 3),
            (3, 4, 3),
            (1, 4, 3),
            (3, 3, 4),
            (1, 3, 4),
            (3, 4, 4),
            (1, 4, 4),
        ]
        @test element_nodes((1, 4, 3), N) == [
            (1, 4, 3),
            (2, 4, 3),
            (1, 1, 3),
            (2, 1, 3),
            (1, 4, 4),
            (2, 4, 4),
            (1, 1, 4),
            (2, 1, 4),
        ]
        @test element_nodes((2, 4, 3), N) == [
            (2, 4, 3),
            (3, 4, 3),
            (2, 1, 3),
            (3, 1, 3),
            (2, 4, 4),
            (3, 4, 4),
            (2, 1, 4),
            (3, 1, 4),
        ]
        @test element_nodes((3, 4, 3), N) == [
            (3, 4, 3),
            (1, 4, 3),
            (3, 1, 3),
            (1, 1, 3),
            (3, 4, 4),
            (1, 4, 4),
            (3, 1, 4),
            (1, 1, 4),
        ]

        @test element_nodes((1, 1, 4), N) == [
            (1, 1, 4),
            (2, 1, 4),
            (1, 2, 4),
            (2, 2, 4),
            (1, 1, 5),
            (2, 1, 5),
            (1, 2, 5),
            (2, 2, 5),
        ]
        @test element_nodes((2, 1, 4), N) == [
            (2, 1, 4),
            (3, 1, 4),
            (2, 2, 4),
            (3, 2, 4),
            (2, 1, 5),
            (3, 1, 5),
            (2, 2, 5),
            (3, 2, 5),
        ]
        @test element_nodes((3, 1, 4), N) == [
            (3, 1, 4),
            (1, 1, 4),
            (3, 2, 4),
            (1, 2, 4),
            (3, 1, 5),
            (1, 1, 5),
            (3, 2, 5),
            (1, 2, 5),
        ]
        @test element_nodes((1, 2, 4), N) == [
            (1, 2, 4),
            (2, 2, 4),
            (1, 3, 4),
            (2, 3, 4),
            (1, 2, 5),
            (2, 2, 5),
            (1, 3, 5),
            (2, 3, 5),
        ]
        @test element_nodes((2, 2, 4), N) == [
            (2, 2, 4),
            (3, 2, 4),
            (2, 3, 4),
            (3, 3, 4),
            (2, 2, 5),
            (3, 2, 5),
            (2, 3, 5),
            (3, 3, 5),
        ]
        @test element_nodes((3, 2, 4), N) == [
            (3, 2, 4),
            (1, 2, 4),
            (3, 3, 4),
            (1, 3, 4),
            (3, 2, 5),
            (1, 2, 5),
            (3, 3, 5),
            (1, 3, 5),
        ]
        @test element_nodes((1, 3, 4), N) == [
            (1, 3, 4),
            (2, 3, 4),
            (1, 4, 4),
            (2, 4, 4),
            (1, 3, 5),
            (2, 3, 5),
            (1, 4, 5),
            (2, 4, 5),
        ]
        @test element_nodes((2, 3, 4), N) == [
            (2, 3, 4),
            (3, 3, 4),
            (2, 4, 4),
            (3, 4, 4),
            (2, 3, 5),
            (3, 3, 5),
            (2, 4, 5),
            (3, 4, 5),
        ]
        @test element_nodes((3, 3, 4), N) == [
            (3, 3, 4),
            (1, 3, 4),
            (3, 4, 4),
            (1, 4, 4),
            (3, 3, 5),
            (1, 3, 5),
            (3, 4, 5),
            (1, 4, 5),
        ]
        @test element_nodes((1, 4, 4), N) == [
            (1, 4, 4),
            (2, 4, 4),
            (1, 1, 4),
            (2, 1, 4),
            (1, 4, 5),
            (2, 4, 5),
            (1, 1, 5),
            (2, 1, 5),
        ]
        @test element_nodes((2, 4, 4), N) == [
            (2, 4, 4),
            (3, 4, 4),
            (2, 1, 4),
            (3, 1, 4),
            (2, 4, 5),
            (3, 4, 5),
            (2, 1, 5),
            (3, 1, 5),
        ]
        @test element_nodes((3, 4, 4), N) == [
            (3, 4, 4),
            (1, 4, 4),
            (3, 1, 4),
            (1, 1, 4),
            (3, 4, 5),
            (1, 4, 5),
            (3, 1, 5),
            (1, 1, 5),
        ]

        @test element_nodes((1, 1, 5), N) == [
            (1, 1, 5),
            (2, 1, 5),
            (1, 2, 5),
            (2, 2, 5),
            (1, 1, 1),
            (2, 1, 1),
            (1, 2, 1),
            (2, 2, 1),
        ]
        @test element_nodes((2, 1, 5), N) == [
            (2, 1, 5),
            (3, 1, 5),
            (2, 2, 5),
            (3, 2, 5),
            (2, 1, 1),
            (3, 1, 1),
            (2, 2, 1),
            (3, 2, 1),
        ]
        @test element_nodes((3, 1, 5), N) == [
            (3, 1, 5),
            (1, 1, 5),
            (3, 2, 5),
            (1, 2, 5),
            (3, 1, 1),
            (1, 1, 1),
            (3, 2, 1),
            (1, 2, 1),
        ]
        @test element_nodes((1, 2, 5), N) == [
            (1, 2, 5),
            (2, 2, 5),
            (1, 3, 5),
            (2, 3, 5),
            (1, 2, 1),
            (2, 2, 1),
            (1, 3, 1),
            (2, 3, 1),
        ]
        @test element_nodes((2, 2, 5), N) == [
            (2, 2, 5),
            (3, 2, 5),
            (2, 3, 5),
            (3, 3, 5),
            (2, 2, 1),
            (3, 2, 1),
            (2, 3, 1),
            (3, 3, 1),
        ]
        @test element_nodes((3, 2, 5), N) == [
            (3, 2, 5),
            (1, 2, 5),
            (3, 3, 5),
            (1, 3, 5),
            (3, 2, 1),
            (1, 2, 1),
            (3, 3, 1),
            (1, 3, 1),
        ]
        @test element_nodes((1, 3, 5), N) == [
            (1, 3, 5),
            (2, 3, 5),
            (1, 4, 5),
            (2, 4, 5),
            (1, 3, 1),
            (2, 3, 1),
            (1, 4, 1),
            (2, 4, 1),
        ]
        @test element_nodes((2, 3, 5), N) == [
            (2, 3, 5),
            (3, 3, 5),
            (2, 4, 5),
            (3, 4, 5),
            (2, 3, 1),
            (3, 3, 1),
            (2, 4, 1),
            (3, 4, 1),
        ]
        @test element_nodes((3, 3, 5), N) == [
            (3, 3, 5),
            (1, 3, 5),
            (3, 4, 5),
            (1, 4, 5),
            (3, 3, 1),
            (1, 3, 1),
            (3, 4, 1),
            (1, 4, 1),
        ]
        @test element_nodes((1, 4, 5), N) == [
            (1, 4, 5),
            (2, 4, 5),
            (1, 1, 5),
            (2, 1, 5),
            (1, 4, 1),
            (2, 4, 1),
            (1, 1, 1),
            (2, 1, 1),
        ]
        @test element_nodes((2, 4, 5), N) == [
            (2, 4, 5),
            (3, 4, 5),
            (2, 1, 5),
            (3, 1, 5),
            (2, 4, 1),
            (3, 4, 1),
            (2, 1, 1),
            (3, 1, 1),
        ]
        @test element_nodes((3, 4, 5), N) == [
            (3, 4, 5),
            (1, 4, 5),
            (3, 1, 5),
            (1, 1, 5),
            (3, 4, 1),
            (1, 4, 1),
            (3, 1, 1),
            (1, 1, 1),
        ]

    end
end


# @testset "Global stiffness operator" begin
#     N = [3, 4]
#     h = [1.1, 1.2]
#     渭 = 5.6
#     谓 = 0.3
#     K = global_stiffness_operator(N, h, 渭, 谓)
# end
