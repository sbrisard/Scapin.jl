using Base.Iterators
using LinearAlgebra

Lâˆž = x -> norm(x, Inf)

function expected_avg_gradient_operator(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    ð”‘ = element_nodes(d)
    D = zeros(T, d, fill(2, d)...)
    for i = 1:d, n in ð”‘
        D[i, n] = (-1)^n[i] / 2^(d - 1) / h[i]
    end
    return D
end


function expected_avg_strain_displacement_operator(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    ð”‘ = element_nodes(d)
    D = expected_avg_gradient_operator(h)
    B = zeros(T, d, d, fill(2, d)..., d)
    for i = 1:d, j = 1:d, n in ð”‘, k = 1:d
        B[i, j, n, k] = (D[i, n] * T(j == k) + D[j, n] * T(i == k)) / 2
    end
    return B
end

function expected_K_Î»(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    K_Î» = zeros(Float64, fill(2, d)..., d, fill(2, d)..., d)
    if d == 2
        value = -1 / 4
        K_Î»[1, 1, 1, 1, 2, 2] = value
        K_Î»[1, 1, 1, 2, 2, 2] = value
        K_Î»[1, 1, 2, 2, 1, 1] = value
        K_Î»[1, 1, 2, 2, 2, 1] = value
        K_Î»[1, 2, 1, 1, 2, 2] = value
        K_Î»[1, 2, 1, 2, 2, 2] = value
        K_Î»[1, 2, 2, 1, 1, 1] = value
        K_Î»[1, 2, 2, 1, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 2] = value
        K_Î»[2, 1, 1, 2, 1, 2] = value
        K_Î»[2, 1, 2, 2, 1, 1] = value
        K_Î»[2, 1, 2, 2, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 2] = value
        K_Î»[2, 2, 1, 2, 1, 2] = value
        K_Î»[2, 2, 2, 1, 1, 1] = value
        K_Î»[2, 2, 2, 1, 2, 1] = value

        value = 1 / 4
        K_Î»[1, 1, 1, 1, 1, 2] = value
        K_Î»[1, 1, 1, 2, 1, 2] = value
        K_Î»[1, 1, 2, 1, 1, 1] = value
        K_Î»[1, 1, 2, 1, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 2] = value
        K_Î»[1, 2, 1, 2, 1, 2] = value
        K_Î»[1, 2, 2, 2, 1, 1] = value
        K_Î»[1, 2, 2, 2, 2, 1] = value
        K_Î»[2, 1, 1, 1, 2, 2] = value
        K_Î»[2, 1, 1, 2, 2, 2] = value
        K_Î»[2, 1, 2, 1, 1, 1] = value
        K_Î»[2, 1, 2, 1, 2, 1] = value
        K_Î»[2, 2, 1, 1, 2, 2] = value
        K_Î»[2, 2, 1, 2, 2, 2] = value
        K_Î»[2, 2, 2, 2, 1, 1] = value
        K_Î»[2, 2, 2, 2, 2, 1] = value

        value = -h[1] / (3 * h[2])
        K_Î»[1, 1, 2, 1, 2, 2] = value
        K_Î»[1, 2, 2, 1, 1, 2] = value
        K_Î»[2, 1, 2, 2, 2, 2] = value
        K_Î»[2, 2, 2, 2, 1, 2] = value

        value = -h[1] / (6 * h[2])
        K_Î»[1, 1, 2, 2, 2, 2] = value
        K_Î»[1, 2, 2, 2, 1, 2] = value
        K_Î»[2, 1, 2, 1, 2, 2] = value
        K_Î»[2, 2, 2, 1, 1, 2] = value

        value = h[1] / (6 * h[2])
        K_Î»[1, 1, 2, 2, 1, 2] = value
        K_Î»[1, 2, 2, 2, 2, 2] = value
        K_Î»[2, 1, 2, 1, 1, 2] = value
        K_Î»[2, 2, 2, 1, 2, 2] = value

        value = h[1] / (3 * h[2])
        K_Î»[1, 1, 2, 1, 1, 2] = value
        K_Î»[1, 2, 2, 1, 2, 2] = value
        K_Î»[2, 1, 2, 2, 1, 2] = value
        K_Î»[2, 2, 2, 2, 2, 2] = value

        value = -h[2] / (3 * h[1])
        K_Î»[1, 1, 1, 2, 1, 1] = value
        K_Î»[1, 2, 1, 2, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 1] = value
        K_Î»[2, 2, 1, 1, 2, 1] = value

        value = -h[2] / (6 * h[1])
        K_Î»[1, 1, 1, 2, 2, 1] = value
        K_Î»[1, 2, 1, 2, 1, 1] = value
        K_Î»[2, 1, 1, 1, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 1] = value

        value = h[2] / (6 * h[1])
        K_Î»[1, 1, 1, 1, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 1] = value
        K_Î»[2, 1, 1, 2, 2, 1] = value
        K_Î»[2, 2, 1, 2, 1, 1] = value

        value = h[2] / (3 * h[1])
        K_Î»[1, 1, 1, 1, 1, 1] = value
        K_Î»[1, 2, 1, 1, 2, 1] = value
        K_Î»[2, 1, 1, 2, 1, 1] = value
        K_Î»[2, 2, 1, 2, 2, 1] = value
    elseif d == 3
        value = -h[1] / 12
        K_Î»[1, 1, 1, 2, 1, 1, 2, 3] = value
        K_Î»[1, 1, 1, 2, 1, 2, 2, 3] = value
        K_Î»[1, 1, 1, 3, 1, 2, 1, 2] = value
        K_Î»[1, 1, 1, 3, 1, 2, 2, 2] = value
        K_Î»[1, 1, 2, 2, 1, 1, 2, 3] = value
        K_Î»[1, 1, 2, 2, 1, 2, 2, 3] = value
        K_Î»[1, 1, 2, 3, 1, 1, 1, 2] = value
        K_Î»[1, 1, 2, 3, 1, 1, 2, 2] = value
        K_Î»[1, 2, 1, 2, 1, 1, 1, 3] = value
        K_Î»[1, 2, 1, 2, 1, 2, 1, 3] = value
        K_Î»[1, 2, 1, 3, 1, 2, 1, 2] = value
        K_Î»[1, 2, 1, 3, 1, 2, 2, 2] = value
        K_Î»[1, 2, 2, 2, 1, 1, 1, 3] = value
        K_Î»[1, 2, 2, 2, 1, 2, 1, 3] = value
        K_Î»[1, 2, 2, 3, 1, 1, 1, 2] = value
        K_Î»[1, 2, 2, 3, 1, 1, 2, 2] = value
        K_Î»[2, 1, 1, 2, 2, 1, 2, 3] = value
        K_Î»[2, 1, 1, 2, 2, 2, 2, 3] = value
        K_Î»[2, 1, 1, 3, 2, 2, 1, 2] = value
        K_Î»[2, 1, 1, 3, 2, 2, 2, 2] = value
        K_Î»[2, 1, 2, 2, 2, 1, 2, 3] = value
        K_Î»[2, 1, 2, 2, 2, 2, 2, 3] = value
        K_Î»[2, 1, 2, 3, 2, 1, 1, 2] = value
        K_Î»[2, 1, 2, 3, 2, 1, 2, 2] = value
        K_Î»[2, 2, 1, 2, 2, 1, 1, 3] = value
        K_Î»[2, 2, 1, 2, 2, 2, 1, 3] = value
        K_Î»[2, 2, 1, 3, 2, 2, 1, 2] = value
        K_Î»[2, 2, 1, 3, 2, 2, 2, 2] = value
        K_Î»[2, 2, 2, 2, 2, 1, 1, 3] = value
        K_Î»[2, 2, 2, 2, 2, 2, 1, 3] = value
        K_Î»[2, 2, 2, 3, 2, 1, 1, 2] = value
        K_Î»[2, 2, 2, 3, 2, 1, 2, 2] = value

        value = -h[1] / 24
        K_Î»[1, 1, 1, 2, 2, 1, 2, 3] = value
        K_Î»[1, 1, 1, 2, 2, 2, 2, 3] = value
        K_Î»[1, 1, 1, 3, 2, 2, 1, 2] = value
        K_Î»[1, 1, 1, 3, 2, 2, 2, 2] = value
        K_Î»[1, 1, 2, 2, 2, 1, 2, 3] = value
        K_Î»[1, 1, 2, 2, 2, 2, 2, 3] = value
        K_Î»[1, 1, 2, 3, 2, 1, 1, 2] = value
        K_Î»[1, 1, 2, 3, 2, 1, 2, 2] = value
        K_Î»[1, 2, 1, 2, 2, 1, 1, 3] = value
        K_Î»[1, 2, 1, 2, 2, 2, 1, 3] = value
        K_Î»[1, 2, 1, 3, 2, 2, 1, 2] = value
        K_Î»[1, 2, 1, 3, 2, 2, 2, 2] = value
        K_Î»[1, 2, 2, 2, 2, 1, 1, 3] = value
        K_Î»[1, 2, 2, 2, 2, 2, 1, 3] = value
        K_Î»[1, 2, 2, 3, 2, 1, 1, 2] = value
        K_Î»[1, 2, 2, 3, 2, 1, 2, 2] = value
        K_Î»[2, 1, 1, 2, 1, 1, 2, 3] = value
        K_Î»[2, 1, 1, 2, 1, 2, 2, 3] = value
        K_Î»[2, 1, 1, 3, 1, 2, 1, 2] = value
        K_Î»[2, 1, 1, 3, 1, 2, 2, 2] = value
        K_Î»[2, 1, 2, 2, 1, 1, 2, 3] = value
        K_Î»[2, 1, 2, 2, 1, 2, 2, 3] = value
        K_Î»[2, 1, 2, 3, 1, 1, 1, 2] = value
        K_Î»[2, 1, 2, 3, 1, 1, 2, 2] = value
        K_Î»[2, 2, 1, 2, 1, 1, 1, 3] = value
        K_Î»[2, 2, 1, 2, 1, 2, 1, 3] = value
        K_Î»[2, 2, 1, 3, 1, 2, 1, 2] = value
        K_Î»[2, 2, 1, 3, 1, 2, 2, 2] = value
        K_Î»[2, 2, 2, 2, 1, 1, 1, 3] = value
        K_Î»[2, 2, 2, 2, 1, 2, 1, 3] = value
        K_Î»[2, 2, 2, 3, 1, 1, 1, 2] = value
        K_Î»[2, 2, 2, 3, 1, 1, 2, 2] = value

        value = h[1] / 24
        K_Î»[1, 1, 1, 2, 2, 1, 1, 3] = value
        K_Î»[1, 1, 1, 2, 2, 2, 1, 3] = value
        K_Î»[1, 1, 1, 3, 2, 1, 1, 2] = value
        K_Î»[1, 1, 1, 3, 2, 1, 2, 2] = value
        K_Î»[1, 1, 2, 2, 2, 1, 1, 3] = value
        K_Î»[1, 1, 2, 2, 2, 2, 1, 3] = value
        K_Î»[1, 1, 2, 3, 2, 2, 1, 2] = value
        K_Î»[1, 1, 2, 3, 2, 2, 2, 2] = value
        K_Î»[1, 2, 1, 2, 2, 1, 2, 3] = value
        K_Î»[1, 2, 1, 2, 2, 2, 2, 3] = value
        K_Î»[1, 2, 1, 3, 2, 1, 1, 2] = value
        K_Î»[1, 2, 1, 3, 2, 1, 2, 2] = value
        K_Î»[1, 2, 2, 2, 2, 1, 2, 3] = value
        K_Î»[1, 2, 2, 2, 2, 2, 2, 3] = value
        K_Î»[1, 2, 2, 3, 2, 2, 1, 2] = value
        K_Î»[1, 2, 2, 3, 2, 2, 2, 2] = value
        K_Î»[2, 1, 1, 2, 1, 1, 1, 3] = value
        K_Î»[2, 1, 1, 2, 1, 2, 1, 3] = value
        K_Î»[2, 1, 1, 3, 1, 1, 1, 2] = value
        K_Î»[2, 1, 1, 3, 1, 1, 2, 2] = value
        K_Î»[2, 1, 2, 2, 1, 1, 1, 3] = value
        K_Î»[2, 1, 2, 2, 1, 2, 1, 3] = value
        K_Î»[2, 1, 2, 3, 1, 2, 1, 2] = value
        K_Î»[2, 1, 2, 3, 1, 2, 2, 2] = value
        K_Î»[2, 2, 1, 2, 1, 1, 2, 3] = value
        K_Î»[2, 2, 1, 2, 1, 2, 2, 3] = value
        K_Î»[2, 2, 1, 3, 1, 1, 1, 2] = value
        K_Î»[2, 2, 1, 3, 1, 1, 2, 2] = value
        K_Î»[2, 2, 2, 2, 1, 1, 2, 3] = value
        K_Î»[2, 2, 2, 2, 1, 2, 2, 3] = value
        K_Î»[2, 2, 2, 3, 1, 2, 1, 2] = value
        K_Î»[2, 2, 2, 3, 1, 2, 2, 2] = value

        value = h[1] / 12
        K_Î»[1, 1, 1, 2, 1, 1, 1, 3] = value
        K_Î»[1, 1, 1, 2, 1, 2, 1, 3] = value
        K_Î»[1, 1, 1, 3, 1, 1, 1, 2] = value
        K_Î»[1, 1, 1, 3, 1, 1, 2, 2] = value
        K_Î»[1, 1, 2, 2, 1, 1, 1, 3] = value
        K_Î»[1, 1, 2, 2, 1, 2, 1, 3] = value
        K_Î»[1, 1, 2, 3, 1, 2, 1, 2] = value
        K_Î»[1, 1, 2, 3, 1, 2, 2, 2] = value
        K_Î»[1, 2, 1, 2, 1, 1, 2, 3] = value
        K_Î»[1, 2, 1, 2, 1, 2, 2, 3] = value
        K_Î»[1, 2, 1, 3, 1, 1, 1, 2] = value
        K_Î»[1, 2, 1, 3, 1, 1, 2, 2] = value
        K_Î»[1, 2, 2, 2, 1, 1, 2, 3] = value
        K_Î»[1, 2, 2, 2, 1, 2, 2, 3] = value
        K_Î»[1, 2, 2, 3, 1, 2, 1, 2] = value
        K_Î»[1, 2, 2, 3, 1, 2, 2, 2] = value
        K_Î»[2, 1, 1, 2, 2, 1, 1, 3] = value
        K_Î»[2, 1, 1, 2, 2, 2, 1, 3] = value
        K_Î»[2, 1, 1, 3, 2, 1, 1, 2] = value
        K_Î»[2, 1, 1, 3, 2, 1, 2, 2] = value
        K_Î»[2, 1, 2, 2, 2, 1, 1, 3] = value
        K_Î»[2, 1, 2, 2, 2, 2, 1, 3] = value
        K_Î»[2, 1, 2, 3, 2, 2, 1, 2] = value
        K_Î»[2, 1, 2, 3, 2, 2, 2, 2] = value
        K_Î»[2, 2, 1, 2, 2, 1, 2, 3] = value
        K_Î»[2, 2, 1, 2, 2, 2, 2, 3] = value
        K_Î»[2, 2, 1, 3, 2, 1, 1, 2] = value
        K_Î»[2, 2, 1, 3, 2, 1, 2, 2] = value
        K_Î»[2, 2, 2, 2, 2, 1, 2, 3] = value
        K_Î»[2, 2, 2, 2, 2, 2, 2, 3] = value
        K_Î»[2, 2, 2, 3, 2, 2, 1, 2] = value
        K_Î»[2, 2, 2, 3, 2, 2, 2, 2] = value

        value = -h[2] / 12
        K_Î»[1, 1, 1, 1, 1, 1, 2, 3] = value
        K_Î»[1, 1, 1, 1, 2, 1, 2, 3] = value
        K_Î»[1, 1, 1, 3, 2, 1, 1, 1] = value
        K_Î»[1, 1, 1, 3, 2, 1, 2, 1] = value
        K_Î»[1, 1, 2, 1, 1, 1, 2, 3] = value
        K_Î»[1, 1, 2, 1, 2, 1, 2, 3] = value
        K_Î»[1, 1, 2, 3, 1, 1, 1, 1] = value
        K_Î»[1, 1, 2, 3, 1, 1, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 2, 2, 3] = value
        K_Î»[1, 2, 1, 1, 2, 2, 2, 3] = value
        K_Î»[1, 2, 1, 3, 2, 2, 1, 1] = value
        K_Î»[1, 2, 1, 3, 2, 2, 2, 1] = value
        K_Î»[1, 2, 2, 1, 1, 2, 2, 3] = value
        K_Î»[1, 2, 2, 1, 2, 2, 2, 3] = value
        K_Î»[1, 2, 2, 3, 1, 2, 1, 1] = value
        K_Î»[1, 2, 2, 3, 1, 2, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 1, 1, 3] = value
        K_Î»[2, 1, 1, 1, 2, 1, 1, 3] = value
        K_Î»[2, 1, 1, 3, 2, 1, 1, 1] = value
        K_Î»[2, 1, 1, 3, 2, 1, 2, 1] = value
        K_Î»[2, 1, 2, 1, 1, 1, 1, 3] = value
        K_Î»[2, 1, 2, 1, 2, 1, 1, 3] = value
        K_Î»[2, 1, 2, 3, 1, 1, 1, 1] = value
        K_Î»[2, 1, 2, 3, 1, 1, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 2, 1, 3] = value
        K_Î»[2, 2, 1, 1, 2, 2, 1, 3] = value
        K_Î»[2, 2, 1, 3, 2, 2, 1, 1] = value
        K_Î»[2, 2, 1, 3, 2, 2, 2, 1] = value
        K_Î»[2, 2, 2, 1, 1, 2, 1, 3] = value
        K_Î»[2, 2, 2, 1, 2, 2, 1, 3] = value
        K_Î»[2, 2, 2, 3, 1, 2, 1, 1] = value
        K_Î»[2, 2, 2, 3, 1, 2, 2, 1] = value

        value = -h[2] / 24
        K_Î»[1, 1, 1, 1, 1, 2, 2, 3] = value
        K_Î»[1, 1, 1, 1, 2, 2, 2, 3] = value
        K_Î»[1, 1, 1, 3, 2, 2, 1, 1] = value
        K_Î»[1, 1, 1, 3, 2, 2, 2, 1] = value
        K_Î»[1, 1, 2, 1, 1, 2, 2, 3] = value
        K_Î»[1, 1, 2, 1, 2, 2, 2, 3] = value
        K_Î»[1, 1, 2, 3, 1, 2, 1, 1] = value
        K_Î»[1, 1, 2, 3, 1, 2, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 1, 2, 3] = value
        K_Î»[1, 2, 1, 1, 2, 1, 2, 3] = value
        K_Î»[1, 2, 1, 3, 2, 1, 1, 1] = value
        K_Î»[1, 2, 1, 3, 2, 1, 2, 1] = value
        K_Î»[1, 2, 2, 1, 1, 1, 2, 3] = value
        K_Î»[1, 2, 2, 1, 2, 1, 2, 3] = value
        K_Î»[1, 2, 2, 3, 1, 1, 1, 1] = value
        K_Î»[1, 2, 2, 3, 1, 1, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 2, 1, 3] = value
        K_Î»[2, 1, 1, 1, 2, 2, 1, 3] = value
        K_Î»[2, 1, 1, 3, 2, 2, 1, 1] = value
        K_Î»[2, 1, 1, 3, 2, 2, 2, 1] = value
        K_Î»[2, 1, 2, 1, 1, 2, 1, 3] = value
        K_Î»[2, 1, 2, 1, 2, 2, 1, 3] = value
        K_Î»[2, 1, 2, 3, 1, 2, 1, 1] = value
        K_Î»[2, 1, 2, 3, 1, 2, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 1, 1, 3] = value
        K_Î»[2, 2, 1, 1, 2, 1, 1, 3] = value
        K_Î»[2, 2, 1, 3, 2, 1, 1, 1] = value
        K_Î»[2, 2, 1, 3, 2, 1, 2, 1] = value
        K_Î»[2, 2, 2, 1, 1, 1, 1, 3] = value
        K_Î»[2, 2, 2, 1, 2, 1, 1, 3] = value
        K_Î»[2, 2, 2, 3, 1, 1, 1, 1] = value
        K_Î»[2, 2, 2, 3, 1, 1, 2, 1] = value

        value = h[2] / 24
        K_Î»[1, 1, 1, 1, 1, 2, 1, 3] = value
        K_Î»[1, 1, 1, 1, 2, 2, 1, 3] = value
        K_Î»[1, 1, 1, 3, 1, 2, 1, 1] = value
        K_Î»[1, 1, 1, 3, 1, 2, 2, 1] = value
        K_Î»[1, 1, 2, 1, 1, 2, 1, 3] = value
        K_Î»[1, 1, 2, 1, 2, 2, 1, 3] = value
        K_Î»[1, 1, 2, 3, 2, 2, 1, 1] = value
        K_Î»[1, 1, 2, 3, 2, 2, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 1, 1, 3] = value
        K_Î»[1, 2, 1, 1, 2, 1, 1, 3] = value
        K_Î»[1, 2, 1, 3, 1, 1, 1, 1] = value
        K_Î»[1, 2, 1, 3, 1, 1, 2, 1] = value
        K_Î»[1, 2, 2, 1, 1, 1, 1, 3] = value
        K_Î»[1, 2, 2, 1, 2, 1, 1, 3] = value
        K_Î»[1, 2, 2, 3, 2, 1, 1, 1] = value
        K_Î»[1, 2, 2, 3, 2, 1, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 2, 2, 3] = value
        K_Î»[2, 1, 1, 1, 2, 2, 2, 3] = value
        K_Î»[2, 1, 1, 3, 1, 2, 1, 1] = value
        K_Î»[2, 1, 1, 3, 1, 2, 2, 1] = value
        K_Î»[2, 1, 2, 1, 1, 2, 2, 3] = value
        K_Î»[2, 1, 2, 1, 2, 2, 2, 3] = value
        K_Î»[2, 1, 2, 3, 2, 2, 1, 1] = value
        K_Î»[2, 1, 2, 3, 2, 2, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 1, 2, 3] = value
        K_Î»[2, 2, 1, 1, 2, 1, 2, 3] = value
        K_Î»[2, 2, 1, 3, 1, 1, 1, 1] = value
        K_Î»[2, 2, 1, 3, 1, 1, 2, 1] = value
        K_Î»[2, 2, 2, 1, 1, 1, 2, 3] = value
        K_Î»[2, 2, 2, 1, 2, 1, 2, 3] = value
        K_Î»[2, 2, 2, 3, 2, 1, 1, 1] = value
        K_Î»[2, 2, 2, 3, 2, 1, 2, 1] = value

        value = h[2] / 12
        K_Î»[1, 1, 1, 1, 1, 1, 1, 3] = value
        K_Î»[1, 1, 1, 1, 2, 1, 1, 3] = value
        K_Î»[1, 1, 1, 3, 1, 1, 1, 1] = value
        K_Î»[1, 1, 1, 3, 1, 1, 2, 1] = value
        K_Î»[1, 1, 2, 1, 1, 1, 1, 3] = value
        K_Î»[1, 1, 2, 1, 2, 1, 1, 3] = value
        K_Î»[1, 1, 2, 3, 2, 1, 1, 1] = value
        K_Î»[1, 1, 2, 3, 2, 1, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 2, 1, 3] = value
        K_Î»[1, 2, 1, 1, 2, 2, 1, 3] = value
        K_Î»[1, 2, 1, 3, 1, 2, 1, 1] = value
        K_Î»[1, 2, 1, 3, 1, 2, 2, 1] = value
        K_Î»[1, 2, 2, 1, 1, 2, 1, 3] = value
        K_Î»[1, 2, 2, 1, 2, 2, 1, 3] = value
        K_Î»[1, 2, 2, 3, 2, 2, 1, 1] = value
        K_Î»[1, 2, 2, 3, 2, 2, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 1, 2, 3] = value
        K_Î»[2, 1, 1, 1, 2, 1, 2, 3] = value
        K_Î»[2, 1, 1, 3, 1, 1, 1, 1] = value
        K_Î»[2, 1, 1, 3, 1, 1, 2, 1] = value
        K_Î»[2, 1, 2, 1, 1, 1, 2, 3] = value
        K_Î»[2, 1, 2, 1, 2, 1, 2, 3] = value
        K_Î»[2, 1, 2, 3, 2, 1, 1, 1] = value
        K_Î»[2, 1, 2, 3, 2, 1, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 2, 2, 3] = value
        K_Î»[2, 2, 1, 1, 2, 2, 2, 3] = value
        K_Î»[2, 2, 1, 3, 1, 2, 1, 1] = value
        K_Î»[2, 2, 1, 3, 1, 2, 2, 1] = value
        K_Î»[2, 2, 2, 1, 1, 2, 2, 3] = value
        K_Î»[2, 2, 2, 1, 2, 2, 2, 3] = value
        K_Î»[2, 2, 2, 3, 2, 2, 1, 1] = value
        K_Î»[2, 2, 2, 3, 2, 2, 2, 1] = value

        value = -(h[1] * h[2]) / (9 * h[3])
        K_Î»[1, 1, 1, 3, 1, 1, 2, 3] = value
        K_Î»[1, 1, 2, 3, 1, 1, 1, 3] = value
        K_Î»[1, 2, 1, 3, 1, 2, 2, 3] = value
        K_Î»[1, 2, 2, 3, 1, 2, 1, 3] = value
        K_Î»[2, 1, 1, 3, 2, 1, 2, 3] = value
        K_Î»[2, 1, 2, 3, 2, 1, 1, 3] = value
        K_Î»[2, 2, 1, 3, 2, 2, 2, 3] = value
        K_Î»[2, 2, 2, 3, 2, 2, 1, 3] = value

        value = -(h[1] * h[2]) / (18 * h[3])
        K_Î»[1, 1, 1, 3, 1, 2, 2, 3] = value
        K_Î»[1, 1, 1, 3, 2, 1, 2, 3] = value
        K_Î»[1, 1, 2, 3, 1, 2, 1, 3] = value
        K_Î»[1, 1, 2, 3, 2, 1, 1, 3] = value
        K_Î»[1, 2, 1, 3, 1, 1, 2, 3] = value
        K_Î»[1, 2, 1, 3, 2, 2, 2, 3] = value
        K_Î»[1, 2, 2, 3, 1, 1, 1, 3] = value
        K_Î»[1, 2, 2, 3, 2, 2, 1, 3] = value
        K_Î»[2, 1, 1, 3, 1, 1, 2, 3] = value
        K_Î»[2, 1, 1, 3, 2, 2, 2, 3] = value
        K_Î»[2, 1, 2, 3, 1, 1, 1, 3] = value
        K_Î»[2, 1, 2, 3, 2, 2, 1, 3] = value
        K_Î»[2, 2, 1, 3, 1, 2, 2, 3] = value
        K_Î»[2, 2, 1, 3, 2, 1, 2, 3] = value
        K_Î»[2, 2, 2, 3, 1, 2, 1, 3] = value
        K_Î»[2, 2, 2, 3, 2, 1, 1, 3] = value

        value = -(h[1] * h[2]) / (36 * h[3])
        K_Î»[1, 1, 1, 3, 2, 2, 2, 3] = value
        K_Î»[1, 1, 2, 3, 2, 2, 1, 3] = value
        K_Î»[1, 2, 1, 3, 2, 1, 2, 3] = value
        K_Î»[1, 2, 2, 3, 2, 1, 1, 3] = value
        K_Î»[2, 1, 1, 3, 1, 2, 2, 3] = value
        K_Î»[2, 1, 2, 3, 1, 2, 1, 3] = value
        K_Î»[2, 2, 1, 3, 1, 1, 2, 3] = value
        K_Î»[2, 2, 2, 3, 1, 1, 1, 3] = value

        value = (h[1] * h[2]) / (36 * h[3])
        K_Î»[1, 1, 1, 3, 2, 2, 1, 3] = value
        K_Î»[1, 1, 2, 3, 2, 2, 2, 3] = value
        K_Î»[1, 2, 1, 3, 2, 1, 1, 3] = value
        K_Î»[1, 2, 2, 3, 2, 1, 2, 3] = value
        K_Î»[2, 1, 1, 3, 1, 2, 1, 3] = value
        K_Î»[2, 1, 2, 3, 1, 2, 2, 3] = value
        K_Î»[2, 2, 1, 3, 1, 1, 1, 3] = value
        K_Î»[2, 2, 2, 3, 1, 1, 2, 3] = value

        value = (h[1] * h[2]) / (18 * h[3])
        K_Î»[1, 1, 1, 3, 1, 2, 1, 3] = value
        K_Î»[1, 1, 1, 3, 2, 1, 1, 3] = value
        K_Î»[1, 1, 2, 3, 1, 2, 2, 3] = value
        K_Î»[1, 1, 2, 3, 2, 1, 2, 3] = value
        K_Î»[1, 2, 1, 3, 1, 1, 1, 3] = value
        K_Î»[1, 2, 1, 3, 2, 2, 1, 3] = value
        K_Î»[1, 2, 2, 3, 1, 1, 2, 3] = value
        K_Î»[1, 2, 2, 3, 2, 2, 2, 3] = value
        K_Î»[2, 1, 1, 3, 1, 1, 1, 3] = value
        K_Î»[2, 1, 1, 3, 2, 2, 1, 3] = value
        K_Î»[2, 1, 2, 3, 1, 1, 2, 3] = value
        K_Î»[2, 1, 2, 3, 2, 2, 2, 3] = value
        K_Î»[2, 2, 1, 3, 1, 2, 1, 3] = value
        K_Î»[2, 2, 1, 3, 2, 1, 1, 3] = value
        K_Î»[2, 2, 2, 3, 1, 2, 2, 3] = value
        K_Î»[2, 2, 2, 3, 2, 1, 2, 3] = value

        value = (h[1] * h[2]) / (9 * h[3])
        K_Î»[1, 1, 1, 3, 1, 1, 1, 3] = value
        K_Î»[1, 1, 2, 3, 1, 1, 2, 3] = value
        K_Î»[1, 2, 1, 3, 1, 2, 1, 3] = value
        K_Î»[1, 2, 2, 3, 1, 2, 2, 3] = value
        K_Î»[2, 1, 1, 3, 2, 1, 1, 3] = value
        K_Î»[2, 1, 2, 3, 2, 1, 2, 3] = value
        K_Î»[2, 2, 1, 3, 2, 2, 1, 3] = value
        K_Î»[2, 2, 2, 3, 2, 2, 2, 3] = value

        value = -h[3] / 12
        K_Î»[1, 1, 1, 1, 1, 2, 1, 2] = value
        K_Î»[1, 1, 1, 1, 2, 2, 1, 2] = value
        K_Î»[1, 1, 1, 2, 2, 1, 1, 1] = value
        K_Î»[1, 1, 1, 2, 2, 2, 1, 1] = value
        K_Î»[1, 1, 2, 1, 1, 2, 2, 2] = value
        K_Î»[1, 1, 2, 1, 2, 2, 2, 2] = value
        K_Î»[1, 1, 2, 2, 2, 1, 2, 1] = value
        K_Î»[1, 1, 2, 2, 2, 2, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 2, 1, 2] = value
        K_Î»[1, 2, 1, 1, 2, 2, 1, 2] = value
        K_Î»[1, 2, 1, 2, 1, 1, 1, 1] = value
        K_Î»[1, 2, 1, 2, 1, 2, 1, 1] = value
        K_Î»[1, 2, 2, 1, 1, 2, 2, 2] = value
        K_Î»[1, 2, 2, 1, 2, 2, 2, 2] = value
        K_Î»[1, 2, 2, 2, 1, 1, 2, 1] = value
        K_Î»[1, 2, 2, 2, 1, 2, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 1, 1, 2] = value
        K_Î»[2, 1, 1, 1, 2, 1, 1, 2] = value
        K_Î»[2, 1, 1, 2, 2, 1, 1, 1] = value
        K_Î»[2, 1, 1, 2, 2, 2, 1, 1] = value
        K_Î»[2, 1, 2, 1, 1, 1, 2, 2] = value
        K_Î»[2, 1, 2, 1, 2, 1, 2, 2] = value
        K_Î»[2, 1, 2, 2, 2, 1, 2, 1] = value
        K_Î»[2, 1, 2, 2, 2, 2, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 1, 1, 2] = value
        K_Î»[2, 2, 1, 1, 2, 1, 1, 2] = value
        K_Î»[2, 2, 1, 2, 1, 1, 1, 1] = value
        K_Î»[2, 2, 1, 2, 1, 2, 1, 1] = value
        K_Î»[2, 2, 2, 1, 1, 1, 2, 2] = value
        K_Î»[2, 2, 2, 1, 2, 1, 2, 2] = value
        K_Î»[2, 2, 2, 2, 1, 1, 2, 1] = value
        K_Î»[2, 2, 2, 2, 1, 2, 2, 1] = value

        value = -h[3] / 24
        K_Î»[1, 1, 1, 1, 1, 2, 2, 2] = value
        K_Î»[1, 1, 1, 1, 2, 2, 2, 2] = value
        K_Î»[1, 1, 1, 2, 2, 1, 2, 1] = value
        K_Î»[1, 1, 1, 2, 2, 2, 2, 1] = value
        K_Î»[1, 1, 2, 1, 1, 2, 1, 2] = value
        K_Î»[1, 1, 2, 1, 2, 2, 1, 2] = value
        K_Î»[1, 1, 2, 2, 2, 1, 1, 1] = value
        K_Î»[1, 1, 2, 2, 2, 2, 1, 1] = value
        K_Î»[1, 2, 1, 1, 1, 2, 2, 2] = value
        K_Î»[1, 2, 1, 1, 2, 2, 2, 2] = value
        K_Î»[1, 2, 1, 2, 1, 1, 2, 1] = value
        K_Î»[1, 2, 1, 2, 1, 2, 2, 1] = value
        K_Î»[1, 2, 2, 1, 1, 2, 1, 2] = value
        K_Î»[1, 2, 2, 1, 2, 2, 1, 2] = value
        K_Î»[1, 2, 2, 2, 1, 1, 1, 1] = value
        K_Î»[1, 2, 2, 2, 1, 2, 1, 1] = value
        K_Î»[2, 1, 1, 1, 1, 1, 2, 2] = value
        K_Î»[2, 1, 1, 1, 2, 1, 2, 2] = value
        K_Î»[2, 1, 1, 2, 2, 1, 2, 1] = value
        K_Î»[2, 1, 1, 2, 2, 2, 2, 1] = value
        K_Î»[2, 1, 2, 1, 1, 1, 1, 2] = value
        K_Î»[2, 1, 2, 1, 2, 1, 1, 2] = value
        K_Î»[2, 1, 2, 2, 2, 1, 1, 1] = value
        K_Î»[2, 1, 2, 2, 2, 2, 1, 1] = value
        K_Î»[2, 2, 1, 1, 1, 1, 2, 2] = value
        K_Î»[2, 2, 1, 1, 2, 1, 2, 2] = value
        K_Î»[2, 2, 1, 2, 1, 1, 2, 1] = value
        K_Î»[2, 2, 1, 2, 1, 2, 2, 1] = value
        K_Î»[2, 2, 2, 1, 1, 1, 1, 2] = value
        K_Î»[2, 2, 2, 1, 2, 1, 1, 2] = value
        K_Î»[2, 2, 2, 2, 1, 1, 1, 1] = value
        K_Î»[2, 2, 2, 2, 1, 2, 1, 1] = value

        value = h[3] / 24
        K_Î»[1, 1, 1, 1, 1, 1, 2, 2] = value
        K_Î»[1, 1, 1, 1, 2, 1, 2, 2] = value
        K_Î»[1, 1, 1, 2, 1, 1, 2, 1] = value
        K_Î»[1, 1, 1, 2, 1, 2, 2, 1] = value
        K_Î»[1, 1, 2, 1, 1, 1, 1, 2] = value
        K_Î»[1, 1, 2, 1, 2, 1, 1, 2] = value
        K_Î»[1, 1, 2, 2, 1, 1, 1, 1] = value
        K_Î»[1, 1, 2, 2, 1, 2, 1, 1] = value
        K_Î»[1, 2, 1, 1, 1, 1, 2, 2] = value
        K_Î»[1, 2, 1, 1, 2, 1, 2, 2] = value
        K_Î»[1, 2, 1, 2, 2, 1, 2, 1] = value
        K_Î»[1, 2, 1, 2, 2, 2, 2, 1] = value
        K_Î»[1, 2, 2, 1, 1, 1, 1, 2] = value
        K_Î»[1, 2, 2, 1, 2, 1, 1, 2] = value
        K_Î»[1, 2, 2, 2, 2, 1, 1, 1] = value
        K_Î»[1, 2, 2, 2, 2, 2, 1, 1] = value
        K_Î»[2, 1, 1, 1, 1, 2, 2, 2] = value
        K_Î»[2, 1, 1, 1, 2, 2, 2, 2] = value
        K_Î»[2, 1, 1, 2, 1, 1, 2, 1] = value
        K_Î»[2, 1, 1, 2, 1, 2, 2, 1] = value
        K_Î»[2, 1, 2, 1, 1, 2, 1, 2] = value
        K_Î»[2, 1, 2, 1, 2, 2, 1, 2] = value
        K_Î»[2, 1, 2, 2, 1, 1, 1, 1] = value
        K_Î»[2, 1, 2, 2, 1, 2, 1, 1] = value
        K_Î»[2, 2, 1, 1, 1, 2, 2, 2] = value
        K_Î»[2, 2, 1, 1, 2, 2, 2, 2] = value
        K_Î»[2, 2, 1, 2, 2, 1, 2, 1] = value
        K_Î»[2, 2, 1, 2, 2, 2, 2, 1] = value
        K_Î»[2, 2, 2, 1, 1, 2, 1, 2] = value
        K_Î»[2, 2, 2, 1, 2, 2, 1, 2] = value
        K_Î»[2, 2, 2, 2, 2, 1, 1, 1] = value
        K_Î»[2, 2, 2, 2, 2, 2, 1, 1] = value

        value = h[3] / 12
        K_Î»[1, 1, 1, 1, 1, 1, 1, 2] = value
        K_Î»[1, 1, 1, 1, 2, 1, 1, 2] = value
        K_Î»[1, 1, 1, 2, 1, 1, 1, 1] = value
        K_Î»[1, 1, 1, 2, 1, 2, 1, 1] = value
        K_Î»[1, 1, 2, 1, 1, 1, 2, 2] = value
        K_Î»[1, 1, 2, 1, 2, 1, 2, 2] = value
        K_Î»[1, 1, 2, 2, 1, 1, 2, 1] = value
        K_Î»[1, 1, 2, 2, 1, 2, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 1, 1, 2] = value
        K_Î»[1, 2, 1, 1, 2, 1, 1, 2] = value
        K_Î»[1, 2, 1, 2, 2, 1, 1, 1] = value
        K_Î»[1, 2, 1, 2, 2, 2, 1, 1] = value
        K_Î»[1, 2, 2, 1, 1, 1, 2, 2] = value
        K_Î»[1, 2, 2, 1, 2, 1, 2, 2] = value
        K_Î»[1, 2, 2, 2, 2, 1, 2, 1] = value
        K_Î»[1, 2, 2, 2, 2, 2, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 2, 1, 2] = value
        K_Î»[2, 1, 1, 1, 2, 2, 1, 2] = value
        K_Î»[2, 1, 1, 2, 1, 1, 1, 1] = value
        K_Î»[2, 1, 1, 2, 1, 2, 1, 1] = value
        K_Î»[2, 1, 2, 1, 1, 2, 2, 2] = value
        K_Î»[2, 1, 2, 1, 2, 2, 2, 2] = value
        K_Î»[2, 1, 2, 2, 1, 1, 2, 1] = value
        K_Î»[2, 1, 2, 2, 1, 2, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 2, 1, 2] = value
        K_Î»[2, 2, 1, 1, 2, 2, 1, 2] = value
        K_Î»[2, 2, 1, 2, 2, 1, 1, 1] = value
        K_Î»[2, 2, 1, 2, 2, 2, 1, 1] = value
        K_Î»[2, 2, 2, 1, 1, 2, 2, 2] = value
        K_Î»[2, 2, 2, 1, 2, 2, 2, 2] = value
        K_Î»[2, 2, 2, 2, 2, 1, 2, 1] = value
        K_Î»[2, 2, 2, 2, 2, 2, 2, 1] = value

        value = -(h[1] * h[3]) / (9 * h[2])
        K_Î»[1, 1, 1, 2, 1, 2, 1, 2] = value
        K_Î»[1, 1, 2, 2, 1, 2, 2, 2] = value
        K_Î»[1, 2, 1, 2, 1, 1, 1, 2] = value
        K_Î»[1, 2, 2, 2, 1, 1, 2, 2] = value
        K_Î»[2, 1, 1, 2, 2, 2, 1, 2] = value
        K_Î»[2, 1, 2, 2, 2, 2, 2, 2] = value
        K_Î»[2, 2, 1, 2, 2, 1, 1, 2] = value
        K_Î»[2, 2, 2, 2, 2, 1, 2, 2] = value

        value = -(h[1] * h[3]) / (18 * h[2])
        K_Î»[1, 1, 1, 2, 1, 2, 2, 2] = value
        K_Î»[1, 1, 1, 2, 2, 2, 1, 2] = value
        K_Î»[1, 1, 2, 2, 1, 2, 1, 2] = value
        K_Î»[1, 1, 2, 2, 2, 2, 2, 2] = value
        K_Î»[1, 2, 1, 2, 1, 1, 2, 2] = value
        K_Î»[1, 2, 1, 2, 2, 1, 1, 2] = value
        K_Î»[1, 2, 2, 2, 1, 1, 1, 2] = value
        K_Î»[1, 2, 2, 2, 2, 1, 2, 2] = value
        K_Î»[2, 1, 1, 2, 1, 2, 1, 2] = value
        K_Î»[2, 1, 1, 2, 2, 2, 2, 2] = value
        K_Î»[2, 1, 2, 2, 1, 2, 2, 2] = value
        K_Î»[2, 1, 2, 2, 2, 2, 1, 2] = value
        K_Î»[2, 2, 1, 2, 1, 1, 1, 2] = value
        K_Î»[2, 2, 1, 2, 2, 1, 2, 2] = value
        K_Î»[2, 2, 2, 2, 1, 1, 2, 2] = value
        K_Î»[2, 2, 2, 2, 2, 1, 1, 2] = value

        value = -(h[1] * h[3]) / (36 * h[2])
        K_Î»[1, 1, 1, 2, 2, 2, 2, 2] = value
        K_Î»[1, 1, 2, 2, 2, 2, 1, 2] = value
        K_Î»[1, 2, 1, 2, 2, 1, 2, 2] = value
        K_Î»[1, 2, 2, 2, 2, 1, 1, 2] = value
        K_Î»[2, 1, 1, 2, 1, 2, 2, 2] = value
        K_Î»[2, 1, 2, 2, 1, 2, 1, 2] = value
        K_Î»[2, 2, 1, 2, 1, 1, 2, 2] = value
        K_Î»[2, 2, 2, 2, 1, 1, 1, 2] = value

        value = (h[1] * h[3]) / (36 * h[2])
        K_Î»[1, 1, 1, 2, 2, 1, 2, 2] = value
        K_Î»[1, 1, 2, 2, 2, 1, 1, 2] = value
        K_Î»[1, 2, 1, 2, 2, 2, 2, 2] = value
        K_Î»[1, 2, 2, 2, 2, 2, 1, 2] = value
        K_Î»[2, 1, 1, 2, 1, 1, 2, 2] = value
        K_Î»[2, 1, 2, 2, 1, 1, 1, 2] = value
        K_Î»[2, 2, 1, 2, 1, 2, 2, 2] = value
        K_Î»[2, 2, 2, 2, 1, 2, 1, 2] = value

        value = (h[1] * h[3]) / (18 * h[2])
        K_Î»[1, 1, 1, 2, 1, 1, 2, 2] = value
        K_Î»[1, 1, 1, 2, 2, 1, 1, 2] = value
        K_Î»[1, 1, 2, 2, 1, 1, 1, 2] = value
        K_Î»[1, 1, 2, 2, 2, 1, 2, 2] = value
        K_Î»[1, 2, 1, 2, 1, 2, 2, 2] = value
        K_Î»[1, 2, 1, 2, 2, 2, 1, 2] = value
        K_Î»[1, 2, 2, 2, 1, 2, 1, 2] = value
        K_Î»[1, 2, 2, 2, 2, 2, 2, 2] = value
        K_Î»[2, 1, 1, 2, 1, 1, 1, 2] = value
        K_Î»[2, 1, 1, 2, 2, 1, 2, 2] = value
        K_Î»[2, 1, 2, 2, 1, 1, 2, 2] = value
        K_Î»[2, 1, 2, 2, 2, 1, 1, 2] = value
        K_Î»[2, 2, 1, 2, 1, 2, 1, 2] = value
        K_Î»[2, 2, 1, 2, 2, 2, 2, 2] = value
        K_Î»[2, 2, 2, 2, 1, 2, 2, 2] = value
        K_Î»[2, 2, 2, 2, 2, 2, 1, 2] = value

        value = (h[1] * h[3]) / (9 * h[2])
        K_Î»[1, 1, 1, 2, 1, 1, 1, 2] = value
        K_Î»[1, 1, 2, 2, 1, 1, 2, 2] = value
        K_Î»[1, 2, 1, 2, 1, 2, 1, 2] = value
        K_Î»[1, 2, 2, 2, 1, 2, 2, 2] = value
        K_Î»[2, 1, 1, 2, 2, 1, 1, 2] = value
        K_Î»[2, 1, 2, 2, 2, 1, 2, 2] = value
        K_Î»[2, 2, 1, 2, 2, 2, 1, 2] = value
        K_Î»[2, 2, 2, 2, 2, 2, 2, 2] = value

        value = -(h[2] * h[3]) / (9 * h[1])
        K_Î»[1, 1, 1, 1, 2, 1, 1, 1] = value
        K_Î»[1, 1, 2, 1, 2, 1, 2, 1] = value
        K_Î»[1, 2, 1, 1, 2, 2, 1, 1] = value
        K_Î»[1, 2, 2, 1, 2, 2, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 1, 1, 1] = value
        K_Î»[2, 1, 2, 1, 1, 1, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 2, 1, 1] = value
        K_Î»[2, 2, 2, 1, 1, 2, 2, 1] = value

        value = -(h[2] * h[3]) / (18 * h[1])
        K_Î»[1, 1, 1, 1, 2, 1, 2, 1] = value
        K_Î»[1, 1, 1, 1, 2, 2, 1, 1] = value
        K_Î»[1, 1, 2, 1, 2, 1, 1, 1] = value
        K_Î»[1, 1, 2, 1, 2, 2, 2, 1] = value
        K_Î»[1, 2, 1, 1, 2, 1, 1, 1] = value
        K_Î»[1, 2, 1, 1, 2, 2, 2, 1] = value
        K_Î»[1, 2, 2, 1, 2, 1, 2, 1] = value
        K_Î»[1, 2, 2, 1, 2, 2, 1, 1] = value
        K_Î»[2, 1, 1, 1, 1, 1, 2, 1] = value
        K_Î»[2, 1, 1, 1, 1, 2, 1, 1] = value
        K_Î»[2, 1, 2, 1, 1, 1, 1, 1] = value
        K_Î»[2, 1, 2, 1, 1, 2, 2, 1] = value
        K_Î»[2, 2, 1, 1, 1, 1, 1, 1] = value
        K_Î»[2, 2, 1, 1, 1, 2, 2, 1] = value
        K_Î»[2, 2, 2, 1, 1, 1, 2, 1] = value
        K_Î»[2, 2, 2, 1, 1, 2, 1, 1] = value

        value = -(h[2] * h[3]) / (36 * h[1])
        K_Î»[1, 1, 1, 1, 2, 2, 2, 1] = value
        K_Î»[1, 1, 2, 1, 2, 2, 1, 1] = value
        K_Î»[1, 2, 1, 1, 2, 1, 2, 1] = value
        K_Î»[1, 2, 2, 1, 2, 1, 1, 1] = value
        K_Î»[2, 1, 1, 1, 1, 2, 2, 1] = value
        K_Î»[2, 1, 2, 1, 1, 2, 1, 1] = value
        K_Î»[2, 2, 1, 1, 1, 1, 2, 1] = value
        K_Î»[2, 2, 2, 1, 1, 1, 1, 1] = value

        value = (h[2] * h[3]) / (36 * h[1])
        K_Î»[1, 1, 1, 1, 1, 2, 2, 1] = value
        K_Î»[1, 1, 2, 1, 1, 2, 1, 1] = value
        K_Î»[1, 2, 1, 1, 1, 1, 2, 1] = value
        K_Î»[1, 2, 2, 1, 1, 1, 1, 1] = value
        K_Î»[2, 1, 1, 1, 2, 2, 2, 1] = value
        K_Î»[2, 1, 2, 1, 2, 2, 1, 1] = value
        K_Î»[2, 2, 1, 1, 2, 1, 2, 1] = value
        K_Î»[2, 2, 2, 1, 2, 1, 1, 1] = value

        value = (h[2] * h[3]) / (18 * h[1])
        K_Î»[1, 1, 1, 1, 1, 1, 2, 1] = value
        K_Î»[1, 1, 1, 1, 1, 2, 1, 1] = value
        K_Î»[1, 1, 2, 1, 1, 1, 1, 1] = value
        K_Î»[1, 1, 2, 1, 1, 2, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 1, 1, 1] = value
        K_Î»[1, 2, 1, 1, 1, 2, 2, 1] = value
        K_Î»[1, 2, 2, 1, 1, 1, 2, 1] = value
        K_Î»[1, 2, 2, 1, 1, 2, 1, 1] = value
        K_Î»[2, 1, 1, 1, 2, 1, 2, 1] = value
        K_Î»[2, 1, 1, 1, 2, 2, 1, 1] = value
        K_Î»[2, 1, 2, 1, 2, 1, 1, 1] = value
        K_Î»[2, 1, 2, 1, 2, 2, 2, 1] = value
        K_Î»[2, 2, 1, 1, 2, 1, 1, 1] = value
        K_Î»[2, 2, 1, 1, 2, 2, 2, 1] = value
        K_Î»[2, 2, 2, 1, 2, 1, 2, 1] = value
        K_Î»[2, 2, 2, 1, 2, 2, 1, 1] = value

        value = (h[2] * h[3]) / (9 * h[1])
        K_Î»[1, 1, 1, 1, 1, 1, 1, 1] = value
        K_Î»[1, 1, 2, 1, 1, 1, 2, 1] = value
        K_Î»[1, 2, 1, 1, 1, 2, 1, 1] = value
        K_Î»[1, 2, 2, 1, 1, 2, 2, 1] = value
        K_Î»[2, 1, 1, 1, 2, 1, 1, 1] = value
        K_Î»[2, 1, 2, 1, 2, 1, 2, 1] = value
        K_Î»[2, 2, 1, 1, 2, 2, 1, 1] = value
        K_Î»[2, 2, 2, 1, 2, 2, 2, 1] = value
    else
    end
    return K_Î»
end

function expected_K_Î¼(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    K_Î¼ = zeros(Float64, fill(2, d)..., d, fill(2, d)..., d)
    if d == 2
        value = -1 / 4
        K_Î¼[1, 1, 1, 2, 1, 2] = value
        K_Î¼[1, 1, 1, 2, 2, 2] = value
        K_Î¼[1, 1, 2, 1, 2, 1] = value
        K_Î¼[1, 1, 2, 2, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 2] = value
        K_Î¼[1, 2, 1, 1, 2, 2] = value
        K_Î¼[1, 2, 2, 1, 2, 1] = value
        K_Î¼[1, 2, 2, 2, 2, 1] = value
        K_Î¼[2, 1, 1, 2, 1, 2] = value
        K_Î¼[2, 1, 1, 2, 2, 2] = value
        K_Î¼[2, 1, 2, 1, 1, 1] = value
        K_Î¼[2, 1, 2, 2, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 2] = value
        K_Î¼[2, 2, 1, 1, 2, 2] = value
        K_Î¼[2, 2, 2, 1, 1, 1] = value
        K_Î¼[2, 2, 2, 2, 1, 1] = value

        value = 1 / 4
        K_Î¼[1, 1, 1, 1, 1, 2] = value
        K_Î¼[1, 1, 1, 1, 2, 2] = value
        K_Î¼[1, 1, 2, 1, 1, 1] = value
        K_Î¼[1, 1, 2, 2, 1, 1] = value
        K_Î¼[1, 2, 1, 2, 1, 2] = value
        K_Î¼[1, 2, 1, 2, 2, 2] = value
        K_Î¼[1, 2, 2, 1, 1, 1] = value
        K_Î¼[1, 2, 2, 2, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 2] = value
        K_Î¼[2, 1, 1, 1, 2, 2] = value
        K_Î¼[2, 1, 2, 1, 2, 1] = value
        K_Î¼[2, 1, 2, 2, 2, 1] = value
        K_Î¼[2, 2, 1, 2, 1, 2] = value
        K_Î¼[2, 2, 1, 2, 2, 2] = value
        K_Î¼[2, 2, 2, 1, 2, 1] = value
        K_Î¼[2, 2, 2, 2, 2, 1] = value

        value = h[1] / (6 * h[2]) - (2 * h[2]) / (3 * h[1])
        K_Î¼[1, 1, 1, 2, 1, 1] = value
        K_Î¼[1, 2, 1, 2, 2, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 2, 1] = value

        value = (-h[2] / (3 * h[1])) - h[1] / (6 * h[2])
        K_Î¼[1, 1, 1, 2, 2, 1] = value
        K_Î¼[1, 2, 1, 2, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 2, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 1] = value

        value = h[1] / (3 * h[2]) - h[2] / (3 * h[1])
        K_Î¼[1, 1, 2, 2, 1, 2] = value
        K_Î¼[1, 2, 2, 2, 2, 2] = value
        K_Î¼[2, 1, 2, 1, 1, 2] = value
        K_Î¼[2, 2, 2, 1, 2, 2] = value

        value = (-h[2] / (6 * h[1])) - h[1] / (3 * h[2])
        K_Î¼[1, 1, 2, 2, 2, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 2] = value
        K_Î¼[2, 1, 2, 1, 2, 2] = value
        K_Î¼[2, 2, 2, 1, 1, 2] = value

        value = h[2] / (6 * h[1]) - (2 * h[1]) / (3 * h[2])
        K_Î¼[1, 1, 2, 1, 2, 2] = value
        K_Î¼[1, 2, 2, 1, 1, 2] = value
        K_Î¼[2, 1, 2, 2, 2, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 2] = value

        value = h[2] / (3 * h[1]) - h[1] / (3 * h[2])
        K_Î¼[1, 1, 1, 1, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 1] = value
        K_Î¼[2, 1, 1, 2, 2, 1] = value
        K_Î¼[2, 2, 1, 2, 1, 1] = value

        value = h[2] / (3 * h[1]) + (2 * h[1]) / (3 * h[2])
        K_Î¼[1, 1, 2, 1, 1, 2] = value
        K_Î¼[1, 2, 2, 1, 2, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 2] = value
        K_Î¼[2, 2, 2, 2, 2, 2] = value

        value = (2 * h[2]) / (3 * h[1]) + h[1] / (3 * h[2])
        K_Î¼[1, 1, 1, 1, 1, 1] = value
        K_Î¼[1, 2, 1, 1, 2, 1] = value
        K_Î¼[2, 1, 1, 2, 1, 1] = value
        K_Î¼[2, 2, 1, 2, 2, 1] = value
    elseif d == 3
        value = -h[1] / 12
        K_Î¼[1, 1, 1, 2, 1, 2, 1, 3] = value
        K_Î¼[1, 1, 1, 2, 1, 2, 2, 3] = value
        K_Î¼[1, 1, 1, 3, 1, 1, 2, 2] = value
        K_Î¼[1, 1, 1, 3, 1, 2, 2, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 1, 1, 3] = value
        K_Î¼[1, 1, 2, 2, 1, 1, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 1, 2, 2] = value
        K_Î¼[1, 1, 2, 3, 1, 2, 2, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 2, 1, 3] = value
        K_Î¼[1, 2, 1, 2, 1, 2, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 1, 1, 2] = value
        K_Î¼[1, 2, 1, 3, 1, 2, 1, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 1, 1, 3] = value
        K_Î¼[1, 2, 2, 2, 1, 1, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 1, 1, 2] = value
        K_Î¼[1, 2, 2, 3, 1, 2, 1, 2] = value
        K_Î¼[2, 1, 1, 2, 2, 2, 1, 3] = value
        K_Î¼[2, 1, 1, 2, 2, 2, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 2, 1, 2, 2] = value
        K_Î¼[2, 1, 1, 3, 2, 2, 2, 2] = value
        K_Î¼[2, 1, 2, 2, 2, 1, 1, 3] = value
        K_Î¼[2, 1, 2, 2, 2, 1, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 2, 1, 2, 2] = value
        K_Î¼[2, 1, 2, 3, 2, 2, 2, 2] = value
        K_Î¼[2, 2, 1, 2, 2, 2, 1, 3] = value
        K_Î¼[2, 2, 1, 2, 2, 2, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 2, 1, 1, 2] = value
        K_Î¼[2, 2, 1, 3, 2, 2, 1, 2] = value
        K_Î¼[2, 2, 2, 2, 2, 1, 1, 3] = value
        K_Î¼[2, 2, 2, 2, 2, 1, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 2, 1, 1, 2] = value
        K_Î¼[2, 2, 2, 3, 2, 2, 1, 2] = value

        value = -h[1] / 24
        K_Î¼[1, 1, 1, 2, 2, 2, 1, 3] = value
        K_Î¼[1, 1, 1, 2, 2, 2, 2, 3] = value
        K_Î¼[1, 1, 1, 3, 2, 1, 2, 2] = value
        K_Î¼[1, 1, 1, 3, 2, 2, 2, 2] = value
        K_Î¼[1, 1, 2, 2, 2, 1, 1, 3] = value
        K_Î¼[1, 1, 2, 2, 2, 1, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 2, 1, 2, 2] = value
        K_Î¼[1, 1, 2, 3, 2, 2, 2, 2] = value
        K_Î¼[1, 2, 1, 2, 2, 2, 1, 3] = value
        K_Î¼[1, 2, 1, 2, 2, 2, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 2, 1, 1, 2] = value
        K_Î¼[1, 2, 1, 3, 2, 2, 1, 2] = value
        K_Î¼[1, 2, 2, 2, 2, 1, 1, 3] = value
        K_Î¼[1, 2, 2, 2, 2, 1, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 2, 1, 1, 2] = value
        K_Î¼[1, 2, 2, 3, 2, 2, 1, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 2, 1, 3] = value
        K_Î¼[2, 1, 1, 2, 1, 2, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 1, 2, 2] = value
        K_Î¼[2, 1, 1, 3, 1, 2, 2, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 1, 1, 3] = value
        K_Î¼[2, 1, 2, 2, 1, 1, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 1, 2, 2] = value
        K_Î¼[2, 1, 2, 3, 1, 2, 2, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 2, 1, 3] = value
        K_Î¼[2, 2, 1, 2, 1, 2, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 1, 1, 2] = value
        K_Î¼[2, 2, 1, 3, 1, 2, 1, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 1, 1, 3] = value
        K_Î¼[2, 2, 2, 2, 1, 1, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 1, 1, 2] = value
        K_Î¼[2, 2, 2, 3, 1, 2, 1, 2] = value

        value = h[1] / 24
        K_Î¼[1, 1, 1, 2, 2, 1, 1, 3] = value
        K_Î¼[1, 1, 1, 2, 2, 1, 2, 3] = value
        K_Î¼[1, 1, 1, 3, 2, 1, 1, 2] = value
        K_Î¼[1, 1, 1, 3, 2, 2, 1, 2] = value
        K_Î¼[1, 1, 2, 2, 2, 2, 1, 3] = value
        K_Î¼[1, 1, 2, 2, 2, 2, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 2, 1, 1, 2] = value
        K_Î¼[1, 1, 2, 3, 2, 2, 1, 2] = value
        K_Î¼[1, 2, 1, 2, 2, 1, 1, 3] = value
        K_Î¼[1, 2, 1, 2, 2, 1, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 2, 1, 2, 2] = value
        K_Î¼[1, 2, 1, 3, 2, 2, 2, 2] = value
        K_Î¼[1, 2, 2, 2, 2, 2, 1, 3] = value
        K_Î¼[1, 2, 2, 2, 2, 2, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 2, 1, 2, 2] = value
        K_Î¼[1, 2, 2, 3, 2, 2, 2, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 1, 1, 3] = value
        K_Î¼[2, 1, 1, 2, 1, 1, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 1, 1, 2] = value
        K_Î¼[2, 1, 1, 3, 1, 2, 1, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 2, 1, 3] = value
        K_Î¼[2, 1, 2, 2, 1, 2, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 1, 1, 2] = value
        K_Î¼[2, 1, 2, 3, 1, 2, 1, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 1, 1, 3] = value
        K_Î¼[2, 2, 1, 2, 1, 1, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 1, 2, 2] = value
        K_Î¼[2, 2, 1, 3, 1, 2, 2, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 2, 1, 3] = value
        K_Î¼[2, 2, 2, 2, 1, 2, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 1, 2, 2] = value
        K_Î¼[2, 2, 2, 3, 1, 2, 2, 2] = value

        value = h[1] / 12
        K_Î¼[1, 1, 1, 2, 1, 1, 1, 3] = value
        K_Î¼[1, 1, 1, 2, 1, 1, 2, 3] = value
        K_Î¼[1, 1, 1, 3, 1, 1, 1, 2] = value
        K_Î¼[1, 1, 1, 3, 1, 2, 1, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 2, 1, 3] = value
        K_Î¼[1, 1, 2, 2, 1, 2, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 1, 1, 2] = value
        K_Î¼[1, 1, 2, 3, 1, 2, 1, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 1, 1, 3] = value
        K_Î¼[1, 2, 1, 2, 1, 1, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 1, 2, 2] = value
        K_Î¼[1, 2, 1, 3, 1, 2, 2, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 2, 1, 3] = value
        K_Î¼[1, 2, 2, 2, 1, 2, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 1, 2, 2] = value
        K_Î¼[1, 2, 2, 3, 1, 2, 2, 2] = value
        K_Î¼[2, 1, 1, 2, 2, 1, 1, 3] = value
        K_Î¼[2, 1, 1, 2, 2, 1, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 2, 1, 1, 2] = value
        K_Î¼[2, 1, 1, 3, 2, 2, 1, 2] = value
        K_Î¼[2, 1, 2, 2, 2, 2, 1, 3] = value
        K_Î¼[2, 1, 2, 2, 2, 2, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 2, 1, 1, 2] = value
        K_Î¼[2, 1, 2, 3, 2, 2, 1, 2] = value
        K_Î¼[2, 2, 1, 2, 2, 1, 1, 3] = value
        K_Î¼[2, 2, 1, 2, 2, 1, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 2, 1, 2, 2] = value
        K_Î¼[2, 2, 1, 3, 2, 2, 2, 2] = value
        K_Î¼[2, 2, 2, 2, 2, 2, 1, 3] = value
        K_Î¼[2, 2, 2, 2, 2, 2, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 2, 1, 2, 2] = value
        K_Î¼[2, 2, 2, 3, 2, 2, 2, 2] = value

        value = -h[2] / 12
        K_Î¼[1, 1, 1, 1, 2, 1, 1, 3] = value
        K_Î¼[1, 1, 1, 1, 2, 1, 2, 3] = value
        K_Î¼[1, 1, 1, 3, 1, 1, 2, 1] = value
        K_Î¼[1, 1, 1, 3, 2, 1, 2, 1] = value
        K_Î¼[1, 1, 2, 1, 1, 1, 1, 3] = value
        K_Î¼[1, 1, 2, 1, 1, 1, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 1, 2, 1] = value
        K_Î¼[1, 1, 2, 3, 2, 1, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 2, 2, 1, 3] = value
        K_Î¼[1, 2, 1, 1, 2, 2, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 2, 2, 1] = value
        K_Î¼[1, 2, 1, 3, 2, 2, 2, 1] = value
        K_Î¼[1, 2, 2, 1, 1, 2, 1, 3] = value
        K_Î¼[1, 2, 2, 1, 1, 2, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 2, 2, 1] = value
        K_Î¼[1, 2, 2, 3, 2, 2, 2, 1] = value
        K_Î¼[2, 1, 1, 1, 2, 1, 1, 3] = value
        K_Î¼[2, 1, 1, 1, 2, 1, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 1, 1, 1] = value
        K_Î¼[2, 1, 1, 3, 2, 1, 1, 1] = value
        K_Î¼[2, 1, 2, 1, 1, 1, 1, 3] = value
        K_Î¼[2, 1, 2, 1, 1, 1, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 1, 1, 1] = value
        K_Î¼[2, 1, 2, 3, 2, 1, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 2, 2, 1, 3] = value
        K_Î¼[2, 2, 1, 1, 2, 2, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 2, 1, 1] = value
        K_Î¼[2, 2, 1, 3, 2, 2, 1, 1] = value
        K_Î¼[2, 2, 2, 1, 1, 2, 1, 3] = value
        K_Î¼[2, 2, 2, 1, 1, 2, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 2, 1, 1] = value
        K_Î¼[2, 2, 2, 3, 2, 2, 1, 1] = value

        value = -h[2] / 24
        K_Î¼[1, 1, 1, 1, 2, 2, 1, 3] = value
        K_Î¼[1, 1, 1, 1, 2, 2, 2, 3] = value
        K_Î¼[1, 1, 1, 3, 1, 2, 2, 1] = value
        K_Î¼[1, 1, 1, 3, 2, 2, 2, 1] = value
        K_Î¼[1, 1, 2, 1, 1, 2, 1, 3] = value
        K_Î¼[1, 1, 2, 1, 1, 2, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 2, 2, 1] = value
        K_Î¼[1, 1, 2, 3, 2, 2, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 2, 1, 1, 3] = value
        K_Î¼[1, 2, 1, 1, 2, 1, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 1, 2, 1] = value
        K_Î¼[1, 2, 1, 3, 2, 1, 2, 1] = value
        K_Î¼[1, 2, 2, 1, 1, 1, 1, 3] = value
        K_Î¼[1, 2, 2, 1, 1, 1, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 1, 2, 1] = value
        K_Î¼[1, 2, 2, 3, 2, 1, 2, 1] = value
        K_Î¼[2, 1, 1, 1, 2, 2, 1, 3] = value
        K_Î¼[2, 1, 1, 1, 2, 2, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 2, 1, 1] = value
        K_Î¼[2, 1, 1, 3, 2, 2, 1, 1] = value
        K_Î¼[2, 1, 2, 1, 1, 2, 1, 3] = value
        K_Î¼[2, 1, 2, 1, 1, 2, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 2, 1, 1] = value
        K_Î¼[2, 1, 2, 3, 2, 2, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 2, 1, 1, 3] = value
        K_Î¼[2, 2, 1, 1, 2, 1, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 1, 1, 1] = value
        K_Î¼[2, 2, 1, 3, 2, 1, 1, 1] = value
        K_Î¼[2, 2, 2, 1, 1, 1, 1, 3] = value
        K_Î¼[2, 2, 2, 1, 1, 1, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 1, 1, 1] = value
        K_Î¼[2, 2, 2, 3, 2, 1, 1, 1] = value

        value = h[2] / 24
        K_Î¼[1, 1, 1, 1, 1, 2, 1, 3] = value
        K_Î¼[1, 1, 1, 1, 1, 2, 2, 3] = value
        K_Î¼[1, 1, 1, 3, 1, 2, 1, 1] = value
        K_Î¼[1, 1, 1, 3, 2, 2, 1, 1] = value
        K_Î¼[1, 1, 2, 1, 2, 2, 1, 3] = value
        K_Î¼[1, 1, 2, 1, 2, 2, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 2, 1, 1] = value
        K_Î¼[1, 1, 2, 3, 2, 2, 1, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 1, 1, 3] = value
        K_Î¼[1, 2, 1, 1, 1, 1, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 1, 1, 1] = value
        K_Î¼[1, 2, 1, 3, 2, 1, 1, 1] = value
        K_Î¼[1, 2, 2, 1, 2, 1, 1, 3] = value
        K_Î¼[1, 2, 2, 1, 2, 1, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 1, 1, 1] = value
        K_Î¼[1, 2, 2, 3, 2, 1, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 2, 1, 3] = value
        K_Î¼[2, 1, 1, 1, 1, 2, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 2, 2, 1] = value
        K_Î¼[2, 1, 1, 3, 2, 2, 2, 1] = value
        K_Î¼[2, 1, 2, 1, 2, 2, 1, 3] = value
        K_Î¼[2, 1, 2, 1, 2, 2, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 2, 2, 1] = value
        K_Î¼[2, 1, 2, 3, 2, 2, 2, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 1, 1, 3] = value
        K_Î¼[2, 2, 1, 1, 1, 1, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 1, 2, 1] = value
        K_Î¼[2, 2, 1, 3, 2, 1, 2, 1] = value
        K_Î¼[2, 2, 2, 1, 2, 1, 1, 3] = value
        K_Î¼[2, 2, 2, 1, 2, 1, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 1, 2, 1] = value
        K_Î¼[2, 2, 2, 3, 2, 1, 2, 1] = value

        value = h[2] / 12
        K_Î¼[1, 1, 1, 1, 1, 1, 1, 3] = value
        K_Î¼[1, 1, 1, 1, 1, 1, 2, 3] = value
        K_Î¼[1, 1, 1, 3, 1, 1, 1, 1] = value
        K_Î¼[1, 1, 1, 3, 2, 1, 1, 1] = value
        K_Î¼[1, 1, 2, 1, 2, 1, 1, 3] = value
        K_Î¼[1, 1, 2, 1, 2, 1, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 1, 1, 1] = value
        K_Î¼[1, 1, 2, 3, 2, 1, 1, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 2, 1, 3] = value
        K_Î¼[1, 2, 1, 1, 1, 2, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 2, 1, 1] = value
        K_Î¼[1, 2, 1, 3, 2, 2, 1, 1] = value
        K_Î¼[1, 2, 2, 1, 2, 2, 1, 3] = value
        K_Î¼[1, 2, 2, 1, 2, 2, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 2, 1, 1] = value
        K_Î¼[1, 2, 2, 3, 2, 2, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 1, 1, 3] = value
        K_Î¼[2, 1, 1, 1, 1, 1, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 1, 2, 1] = value
        K_Î¼[2, 1, 1, 3, 2, 1, 2, 1] = value
        K_Î¼[2, 1, 2, 1, 2, 1, 1, 3] = value
        K_Î¼[2, 1, 2, 1, 2, 1, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 1, 2, 1] = value
        K_Î¼[2, 1, 2, 3, 2, 1, 2, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 2, 1, 3] = value
        K_Î¼[2, 2, 1, 1, 1, 2, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 2, 2, 1] = value
        K_Î¼[2, 2, 1, 3, 2, 2, 2, 1] = value
        K_Î¼[2, 2, 2, 1, 2, 2, 1, 3] = value
        K_Î¼[2, 2, 2, 1, 2, 2, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 2, 2, 1] = value
        K_Î¼[2, 2, 2, 3, 2, 2, 2, 1] = value

        value = -h[3] / 12
        K_Î¼[1, 1, 1, 1, 2, 1, 1, 2] = value
        K_Î¼[1, 1, 1, 1, 2, 2, 1, 2] = value
        K_Î¼[1, 1, 1, 2, 1, 2, 1, 1] = value
        K_Î¼[1, 1, 1, 2, 2, 2, 1, 1] = value
        K_Î¼[1, 1, 2, 1, 2, 1, 2, 2] = value
        K_Î¼[1, 1, 2, 1, 2, 2, 2, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 2, 2, 1] = value
        K_Î¼[1, 1, 2, 2, 2, 2, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 1, 1, 2] = value
        K_Î¼[1, 2, 1, 1, 1, 2, 1, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 2, 1, 1] = value
        K_Î¼[1, 2, 1, 2, 2, 2, 1, 1] = value
        K_Î¼[1, 2, 2, 1, 1, 1, 2, 2] = value
        K_Î¼[1, 2, 2, 1, 1, 2, 2, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 2, 2, 1] = value
        K_Î¼[1, 2, 2, 2, 2, 2, 2, 1] = value
        K_Î¼[2, 1, 1, 1, 2, 1, 1, 2] = value
        K_Î¼[2, 1, 1, 1, 2, 2, 1, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 1, 1, 1] = value
        K_Î¼[2, 1, 1, 2, 2, 1, 1, 1] = value
        K_Î¼[2, 1, 2, 1, 2, 1, 2, 2] = value
        K_Î¼[2, 1, 2, 1, 2, 2, 2, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 1, 2, 1] = value
        K_Î¼[2, 1, 2, 2, 2, 1, 2, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 1, 1, 2] = value
        K_Î¼[2, 2, 1, 1, 1, 2, 1, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 1, 1, 1] = value
        K_Î¼[2, 2, 1, 2, 2, 1, 1, 1] = value
        K_Î¼[2, 2, 2, 1, 1, 1, 2, 2] = value
        K_Î¼[2, 2, 2, 1, 1, 2, 2, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 1, 2, 1] = value
        K_Î¼[2, 2, 2, 2, 2, 1, 2, 1] = value

        value = -h[3] / 24
        K_Î¼[1, 1, 1, 1, 2, 1, 2, 2] = value
        K_Î¼[1, 1, 1, 1, 2, 2, 2, 2] = value
        K_Î¼[1, 1, 1, 2, 1, 2, 2, 1] = value
        K_Î¼[1, 1, 1, 2, 2, 2, 2, 1] = value
        K_Î¼[1, 1, 2, 1, 2, 1, 1, 2] = value
        K_Î¼[1, 1, 2, 1, 2, 2, 1, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 2, 1, 1] = value
        K_Î¼[1, 1, 2, 2, 2, 2, 1, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 1, 2, 2] = value
        K_Î¼[1, 2, 1, 1, 1, 2, 2, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 2, 2, 1] = value
        K_Î¼[1, 2, 1, 2, 2, 2, 2, 1] = value
        K_Î¼[1, 2, 2, 1, 1, 1, 1, 2] = value
        K_Î¼[1, 2, 2, 1, 1, 2, 1, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 2, 1, 1] = value
        K_Î¼[1, 2, 2, 2, 2, 2, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 2, 1, 2, 2] = value
        K_Î¼[2, 1, 1, 1, 2, 2, 2, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 1, 2, 1] = value
        K_Î¼[2, 1, 1, 2, 2, 1, 2, 1] = value
        K_Î¼[2, 1, 2, 1, 2, 1, 1, 2] = value
        K_Î¼[2, 1, 2, 1, 2, 2, 1, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 1, 1, 1] = value
        K_Î¼[2, 1, 2, 2, 2, 1, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 1, 2, 2] = value
        K_Î¼[2, 2, 1, 1, 1, 2, 2, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 1, 2, 1] = value
        K_Î¼[2, 2, 1, 2, 2, 1, 2, 1] = value
        K_Î¼[2, 2, 2, 1, 1, 1, 1, 2] = value
        K_Î¼[2, 2, 2, 1, 1, 2, 1, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 1, 1, 1] = value
        K_Î¼[2, 2, 2, 2, 2, 1, 1, 1] = value

        value = h[3] / 24
        K_Î¼[1, 1, 1, 1, 1, 1, 2, 2] = value
        K_Î¼[1, 1, 1, 1, 1, 2, 2, 2] = value
        K_Î¼[1, 1, 1, 2, 1, 1, 2, 1] = value
        K_Î¼[1, 1, 1, 2, 2, 1, 2, 1] = value
        K_Î¼[1, 1, 2, 1, 1, 1, 1, 2] = value
        K_Î¼[1, 1, 2, 1, 1, 2, 1, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 1, 1, 1] = value
        K_Î¼[1, 1, 2, 2, 2, 1, 1, 1] = value
        K_Î¼[1, 2, 1, 1, 2, 1, 2, 2] = value
        K_Î¼[1, 2, 1, 1, 2, 2, 2, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 1, 2, 1] = value
        K_Î¼[1, 2, 1, 2, 2, 1, 2, 1] = value
        K_Î¼[1, 2, 2, 1, 2, 1, 1, 2] = value
        K_Î¼[1, 2, 2, 1, 2, 2, 1, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 1, 1, 1] = value
        K_Î¼[1, 2, 2, 2, 2, 1, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 1, 2, 2] = value
        K_Î¼[2, 1, 1, 1, 1, 2, 2, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 2, 2, 1] = value
        K_Î¼[2, 1, 1, 2, 2, 2, 2, 1] = value
        K_Î¼[2, 1, 2, 1, 1, 1, 1, 2] = value
        K_Î¼[2, 1, 2, 1, 1, 2, 1, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 2, 1, 1] = value
        K_Î¼[2, 1, 2, 2, 2, 2, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 2, 1, 2, 2] = value
        K_Î¼[2, 2, 1, 1, 2, 2, 2, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 2, 2, 1] = value
        K_Î¼[2, 2, 1, 2, 2, 2, 2, 1] = value
        K_Î¼[2, 2, 2, 1, 2, 1, 1, 2] = value
        K_Î¼[2, 2, 2, 1, 2, 2, 1, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 2, 1, 1] = value
        K_Î¼[2, 2, 2, 2, 2, 2, 1, 1] = value

        value = h[3] / 12
        K_Î¼[1, 1, 1, 1, 1, 1, 1, 2] = value
        K_Î¼[1, 1, 1, 1, 1, 2, 1, 2] = value
        K_Î¼[1, 1, 1, 2, 1, 1, 1, 1] = value
        K_Î¼[1, 1, 1, 2, 2, 1, 1, 1] = value
        K_Î¼[1, 1, 2, 1, 1, 1, 2, 2] = value
        K_Î¼[1, 1, 2, 1, 1, 2, 2, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 1, 2, 1] = value
        K_Î¼[1, 1, 2, 2, 2, 1, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 2, 1, 1, 2] = value
        K_Î¼[1, 2, 1, 1, 2, 2, 1, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 1, 1, 1] = value
        K_Î¼[1, 2, 1, 2, 2, 1, 1, 1] = value
        K_Î¼[1, 2, 2, 1, 2, 1, 2, 2] = value
        K_Î¼[1, 2, 2, 1, 2, 2, 2, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 1, 2, 1] = value
        K_Î¼[1, 2, 2, 2, 2, 1, 2, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 1, 1, 2] = value
        K_Î¼[2, 1, 1, 1, 1, 2, 1, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 2, 1, 1] = value
        K_Î¼[2, 1, 1, 2, 2, 2, 1, 1] = value
        K_Î¼[2, 1, 2, 1, 1, 1, 2, 2] = value
        K_Î¼[2, 1, 2, 1, 1, 2, 2, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 2, 2, 1] = value
        K_Î¼[2, 1, 2, 2, 2, 2, 2, 1] = value
        K_Î¼[2, 2, 1, 1, 2, 1, 1, 2] = value
        K_Î¼[2, 2, 1, 1, 2, 2, 1, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 2, 1, 1] = value
        K_Î¼[2, 2, 1, 2, 2, 2, 1, 1] = value
        K_Î¼[2, 2, 2, 1, 2, 1, 2, 2] = value
        K_Î¼[2, 2, 2, 1, 2, 2, 2, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 2, 2, 1] = value
        K_Î¼[2, 2, 2, 2, 2, 2, 2, 1] = value

        value =
            (-(2 * h[2] * h[3]) / (9 * h[1])) +
            (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 1, 2, 1, 1, 1] = value
        K_Î¼[1, 1, 2, 1, 2, 1, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 2, 2, 1, 1] = value
        K_Î¼[1, 2, 2, 1, 2, 2, 2, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 1, 1, 1] = value
        K_Î¼[2, 1, 2, 1, 1, 1, 2, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 2, 1, 1] = value
        K_Î¼[2, 2, 2, 1, 1, 2, 2, 1] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) - (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (36 * h[3])
        K_Î¼[1, 1, 1, 1, 2, 2, 1, 1] = value
        K_Î¼[1, 1, 2, 1, 2, 2, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 2, 1, 1, 1] = value
        K_Î¼[1, 2, 2, 1, 2, 1, 2, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 2, 1, 1] = value
        K_Î¼[2, 1, 2, 1, 1, 2, 2, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 1, 1, 1] = value
        K_Î¼[2, 2, 2, 1, 1, 1, 2, 1] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) + (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 1, 2, 1, 2, 1] = value
        K_Î¼[1, 1, 2, 1, 2, 1, 1, 1] = value
        K_Î¼[1, 2, 1, 1, 2, 2, 2, 1] = value
        K_Î¼[1, 2, 2, 1, 2, 2, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 1, 2, 1] = value
        K_Î¼[2, 1, 2, 1, 1, 1, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 2, 2, 1] = value
        K_Î¼[2, 2, 2, 1, 1, 2, 1, 1] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) +
            (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 3, 2, 1, 1, 3] = value
        K_Î¼[1, 1, 2, 3, 2, 1, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 2, 2, 1, 3] = value
        K_Î¼[1, 2, 2, 3, 2, 2, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 1, 1, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 1, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 2, 1, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 2, 2, 3] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) +
            (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 2, 2, 1, 1, 2] = value
        K_Î¼[1, 1, 2, 2, 2, 1, 2, 2] = value
        K_Î¼[1, 2, 1, 2, 2, 2, 1, 2] = value
        K_Î¼[1, 2, 2, 2, 2, 2, 2, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 1, 1, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 1, 2, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 2, 1, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 2, 2, 2] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) - (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (36 * h[3])
        K_Î¼[1, 1, 1, 2, 2, 2, 1, 2] = value
        K_Î¼[1, 1, 2, 2, 2, 2, 2, 2] = value
        K_Î¼[1, 2, 1, 2, 2, 1, 1, 2] = value
        K_Î¼[1, 2, 2, 2, 2, 1, 2, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 2, 1, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 2, 2, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 1, 1, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 1, 2, 2] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) - (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 3, 2, 2, 1, 3] = value
        K_Î¼[1, 1, 2, 3, 2, 2, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 2, 1, 1, 3] = value
        K_Î¼[1, 2, 2, 3, 2, 1, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 2, 1, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 2, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 1, 1, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 1, 2, 3] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) - (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (36 * h[3])
        K_Î¼[1, 1, 1, 1, 2, 2, 2, 1] = value
        K_Î¼[1, 1, 2, 1, 2, 2, 1, 1] = value
        K_Î¼[1, 2, 1, 1, 2, 1, 2, 1] = value
        K_Î¼[1, 2, 2, 1, 2, 1, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 1, 2, 2, 1] = value
        K_Î¼[2, 1, 2, 1, 1, 2, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 1, 1, 2, 1] = value
        K_Î¼[2, 2, 2, 1, 1, 1, 1, 1] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) + (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 3, 2, 1, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 2, 1, 1, 3] = value
        K_Î¼[1, 2, 1, 3, 2, 2, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 2, 2, 1, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 1, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 1, 1, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 2, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 2, 1, 3] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) + (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 2, 2, 1, 2, 2] = value
        K_Î¼[1, 1, 2, 2, 2, 1, 1, 2] = value
        K_Î¼[1, 2, 1, 2, 2, 2, 2, 2] = value
        K_Î¼[1, 2, 2, 2, 2, 2, 1, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 1, 2, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 1, 1, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 2, 2, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 2, 1, 2] = value

        value =
            (-(h[2] * h[3]) / (36 * h[1])) - (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (36 * h[3])
        K_Î¼[1, 1, 1, 2, 2, 2, 2, 2] = value
        K_Î¼[1, 1, 2, 2, 2, 2, 1, 2] = value
        K_Î¼[1, 2, 1, 2, 2, 1, 2, 2] = value
        K_Î¼[1, 2, 2, 2, 2, 1, 1, 2] = value
        K_Î¼[2, 1, 1, 2, 1, 2, 2, 2] = value
        K_Î¼[2, 1, 2, 2, 1, 2, 1, 2] = value
        K_Î¼[2, 2, 1, 2, 1, 1, 2, 2] = value
        K_Î¼[2, 2, 2, 2, 1, 1, 1, 2] = value

        value =
            (-(h[2] * h[3]) / (36 * h[1])) - (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 3, 2, 2, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 2, 2, 1, 3] = value
        K_Î¼[1, 2, 1, 3, 2, 1, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 2, 1, 1, 3] = value
        K_Î¼[2, 1, 1, 3, 1, 2, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 1, 2, 1, 3] = value
        K_Î¼[2, 2, 1, 3, 1, 1, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 1, 1, 1, 3] = value

        value =
            (h[2] * h[3]) / (36 * h[1]) - (h[1] * h[3]) / (9 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 2, 1, 2, 2, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 2, 1, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 1, 2, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 1, 1, 2] = value
        K_Î¼[2, 1, 1, 2, 2, 2, 2, 2] = value
        K_Î¼[2, 1, 2, 2, 2, 2, 1, 2] = value
        K_Î¼[2, 2, 1, 2, 2, 1, 2, 2] = value
        K_Î¼[2, 2, 2, 2, 2, 1, 1, 2] = value

        value =
            (h[2] * h[3]) / (36 * h[1]) - (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 3, 1, 2, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 2, 1, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 1, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 1, 1, 3] = value
        K_Î¼[2, 1, 1, 3, 2, 2, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 2, 2, 1, 3] = value
        K_Î¼[2, 2, 1, 3, 2, 1, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 2, 1, 1, 3] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) - (2 * h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 2, 1, 2, 1, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 2, 2, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 1, 1, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 1, 2, 2] = value
        K_Î¼[2, 1, 1, 2, 2, 2, 1, 2] = value
        K_Î¼[2, 1, 2, 2, 2, 2, 2, 2] = value
        K_Î¼[2, 2, 1, 2, 2, 1, 1, 2] = value
        K_Î¼[2, 2, 2, 2, 2, 1, 2, 2] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) - (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 3, 1, 2, 1, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 2, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 1, 1, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 1, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 2, 2, 1, 3] = value
        K_Î¼[2, 1, 2, 3, 2, 2, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 2, 1, 1, 3] = value
        K_Î¼[2, 2, 2, 3, 2, 1, 2, 3] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) - (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 1, 1, 2, 2, 1] = value
        K_Î¼[1, 1, 2, 1, 1, 2, 1, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 1, 2, 1] = value
        K_Î¼[1, 2, 2, 1, 1, 1, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 2, 2, 2, 1] = value
        K_Î¼[2, 1, 2, 1, 2, 2, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 2, 1, 2, 1] = value
        K_Î¼[2, 2, 2, 1, 2, 1, 1, 1] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) + (h[1] * h[3]) / (18 * h[2]) -
            (2 * h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 3, 1, 1, 2, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 1, 1, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 2, 2, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 2, 1, 3] = value
        K_Î¼[2, 1, 1, 3, 2, 1, 2, 3] = value
        K_Î¼[2, 1, 2, 3, 2, 1, 1, 3] = value
        K_Î¼[2, 2, 1, 3, 2, 2, 2, 3] = value
        K_Î¼[2, 2, 2, 3, 2, 2, 1, 3] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) + (h[1] * h[3]) / (9 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 2, 1, 1, 2, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 1, 1, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 2, 2, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 2, 1, 2] = value
        K_Î¼[2, 1, 1, 2, 2, 1, 2, 2] = value
        K_Î¼[2, 1, 2, 2, 2, 1, 1, 2] = value
        K_Î¼[2, 2, 1, 2, 2, 2, 2, 2] = value
        K_Î¼[2, 2, 2, 2, 2, 2, 1, 2] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) - (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_Î¼[1, 1, 1, 1, 1, 2, 1, 1] = value
        K_Î¼[1, 1, 2, 1, 1, 2, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 1, 1, 1] = value
        K_Î¼[1, 2, 2, 1, 1, 1, 2, 1] = value
        K_Î¼[2, 1, 1, 1, 2, 2, 1, 1] = value
        K_Î¼[2, 1, 2, 1, 2, 2, 2, 1] = value
        K_Î¼[2, 2, 1, 1, 2, 1, 1, 1] = value
        K_Î¼[2, 2, 2, 1, 2, 1, 2, 1] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) + (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 1, 1, 1, 2, 1] = value
        K_Î¼[1, 1, 2, 1, 1, 1, 1, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 2, 2, 1] = value
        K_Î¼[1, 2, 2, 1, 1, 2, 1, 1] = value
        K_Î¼[2, 1, 1, 1, 2, 1, 2, 1] = value
        K_Î¼[2, 1, 2, 1, 2, 1, 1, 1] = value
        K_Î¼[2, 2, 1, 1, 2, 2, 2, 1] = value
        K_Î¼[2, 2, 2, 1, 2, 2, 1, 1] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) +
            (h[1] * h[3]) / (9 * h[2]) +
            (2 * h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 3, 1, 1, 1, 3] = value
        K_Î¼[1, 1, 2, 3, 1, 1, 2, 3] = value
        K_Î¼[1, 2, 1, 3, 1, 2, 1, 3] = value
        K_Î¼[1, 2, 2, 3, 1, 2, 2, 3] = value
        K_Î¼[2, 1, 1, 3, 2, 1, 1, 3] = value
        K_Î¼[2, 1, 2, 3, 2, 1, 2, 3] = value
        K_Î¼[2, 2, 1, 3, 2, 2, 1, 3] = value
        K_Î¼[2, 2, 2, 3, 2, 2, 2, 3] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) +
            (2 * h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 2, 1, 1, 1, 2] = value
        K_Î¼[1, 1, 2, 2, 1, 1, 2, 2] = value
        K_Î¼[1, 2, 1, 2, 1, 2, 1, 2] = value
        K_Î¼[1, 2, 2, 2, 1, 2, 2, 2] = value
        K_Î¼[2, 1, 1, 2, 2, 1, 1, 2] = value
        K_Î¼[2, 1, 2, 2, 2, 1, 2, 2] = value
        K_Î¼[2, 2, 1, 2, 2, 2, 1, 2] = value
        K_Î¼[2, 2, 2, 2, 2, 2, 2, 2] = value

        value =
            (2 * h[2] * h[3]) / (9 * h[1]) +
            (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_Î¼[1, 1, 1, 1, 1, 1, 1, 1] = value
        K_Î¼[1, 1, 2, 1, 1, 1, 2, 1] = value
        K_Î¼[1, 2, 1, 1, 1, 2, 1, 1] = value
        K_Î¼[1, 2, 2, 1, 1, 2, 2, 1] = value
        K_Î¼[2, 1, 1, 1, 2, 1, 1, 1] = value
        K_Î¼[2, 1, 2, 1, 2, 1, 2, 1] = value
        K_Î¼[2, 2, 1, 1, 2, 2, 1, 1] = value
        K_Î¼[2, 2, 2, 1, 2, 2, 2, 1] = value
    else
    end
    return K_Î¼
end

@testset "Gaussâ€“Legendre integration" begin
    h3 = [1.1, 1.2, 1.3]
    order = 2
    for d = 1:3
        @testset "Gauss-Legendre integration, $(d)d" begin
            for n in map(Tuple, CartesianIndices(Tuple(fill(1:(2*order-1), d))))
                h = h3[1:d]
                actual = integrate(x -> prod(x .^ n), h)
                n1 = n .+ 1
                expected = prod(((h / 2) .^ n1 .- (-h / 2) .^ n1) ./ n1)
                @test actual â‰ˆ expected rtol = 1e-15 atol = 1e-15
            end
        end
    end
end

@testset "Node numbering" begin
    for d = 1:3
        h = [1.1, 1.2, 1.3][1:d]
        ð”‘ = element_nodes(d)
        for m âˆˆ ð”‘
            x = h .* (-1) .^ Tuple(m) / 2
            N = shape(x, h)
            for n âˆˆ ð”‘
                @test N[n] == Float64(m == n)
            end
        end
    end
end

@testset "Brick element operators" begin
    for d = 2:3
        @testset "Brick element operators, $(d)d" begin
            # Note: reference values where computed with maxima
            # (see `ref/nd_brick_elasticity.mac`).
            h = [1.1, 1.2, 1.3][1:d]
            Î¼ = 5.6
            Î½ = 0.3
            Î» = 2Î¼ * Î½ / (1 - 2Î½)

            @testset "Average gradient_operator, $(d)d" begin
                D_act = Scapin.avg_gradient_operator(h)
                D_exp = expected_avg_gradient_operator(h)
                @test D_act â‰ˆ D_exp norm = Lâˆž rtol = 1e-15
            end

            @testset "Average strain-displacement matrix, $(d)d" begin
                B_act = avg_strain_displacement_operator(h)
                B_exp = expected_avg_strain_displacement_operator(h)
                @test isapprox(B_act, B_exp, rtol = 1e-15)
            end

            @testset "Stiffness operator, $(d)d" begin
                K_act = stiffness_operator(h, Î¼, Î½)
                K_Î» = expected_K_Î»(h)
                K_Î¼ = expected_K_Î¼(h)
                K_exp = Î» * K_Î» + Î¼ * K_Î¼
                @test K_act â‰ˆ K_exp rtol = 1e-15
            end
        end
    end
end

# # @testset "Cell vertices" begin
# #     @testset "Cell vertices, 2d" begin
# #         """
# #         1â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€3â”€â”€â”€â”€â”€â”€â”€â”€4
# #         â”‚        â”‚        â”‚        â”‚
# #         â”‚ (1, 4) â”‚ (2, 4) â”‚ (3, 4) â”‚
# #         â”‚        â”‚        â”‚        â”‚
# #         10â”€â”€â”€â”€â”€â”€11â”€â”€â”€â”€â”€â”€â”€â”€12â”€â”€â”€â”€â”€â”€10
# #         â”‚        â”‚        â”‚        â”‚
# #         â”‚ (1, 3) â”‚ (2, 3) â”‚ (3, 3) â”‚
# #         â”‚        â”‚        â”‚        â”‚
# #         7â”€â”€â”€â”€â”€â”€â”€â”€8â”€â”€â”€â”€â”€â”€â”€â”€9â”€â”€â”€â”€â”€â”€â”€â”€7
# #         â”‚        â”‚        â”‚        â”‚
# #         â”‚ (1, 2) â”‚ (2, 2) â”‚ (3, 2) â”‚
# #         â”‚        â”‚        â”‚        â”‚
# #         4â”€â”€â”€â”€â”€â”€â”€â”€5â”€â”€â”€â”€â”€â”€â”€â”€6â”€â”€â”€â”€â”€â”€â”€â”€4
# #         â”‚        â”‚        â”‚        â”‚
# #         â”‚ (1, 1) â”‚ (2, 1) â”‚ (3, 1) â”‚
# #         â”‚        â”‚        â”‚        â”‚
# #         1â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€3â”€â”€â”€â”€â”€â”€â”€â”€1
# #         """
# #         N = [3, 4]
# #         d = size(N, 1)
# #         dims = Tuple(1:n for n in N)
# #         linear = LinearIndices(dims)
# #         @test cell_vertices((1, 1), linear) == [1, 2, 4, 5]
# #         @test cell_vertices((2, 1), linear) == [2, 3, 5, 6]
# #         @test cell_vertices((3, 1), linear) == [3, 1, 6, 4]
# #         @test cell_vertices((1, 2), linear) == [4, 5, 7, 8]
# #         @test cell_vertices((2, 2), linear) == [5, 6, 8, 9]
# #         @test cell_vertices((3, 2), linear) == [6, 4, 9, 7]
# #         @test cell_vertices((1, 3), linear) == [7, 8, 10, 11]
# #         @test cell_vertices((2, 3), linear) == [8, 9, 11, 12]
# #         @test cell_vertices((3, 3), linear) == [9, 7, 12, 10]
# #         @test cell_vertices((1, 4), linear) == [10, 11, 1, 2]
# #         @test cell_vertices((2, 4), linear) == [11, 12, 2, 3]
# #         @test cell_vertices((3, 4), linear) == [12, 10, 3, 1]
# #     end

# #     @testset "Cell vertices, 3d" begin
# #         """
# #         1â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€3â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€4
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 4, 1) â”‚ (2, 4, 1) â”‚ (3, 4, 1) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         10â”€â”€â”€â”€â”€â”€â”€â”€â”€11â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€12â”€â”€â”€â”€â”€â”€â”€â”€â”€10
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 3, 1) â”‚ (2, 3, 1) â”‚ (3, 3, 1) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         7â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€8â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€9â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€7
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 2, 1) â”‚ (2, 2, 1) â”‚ (3, 2, 1) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         4â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€5â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€6â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€4
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 1, 1) â”‚ (2, 1, 1) â”‚ (3, 1, 1) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         1â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€3â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€1


# #         13â”€â”€â”€â”€â”€â”€â”€â”€â”€14â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€15â”€â”€â”€â”€â”€â”€â”€â”€â”€13
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 4, 2) â”‚ (2, 4, 2) â”‚ (3, 4, 2) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         22â”€â”€â”€â”€â”€â”€â”€â”€â”€23â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€24â”€â”€â”€â”€â”€â”€â”€â”€â”€22
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 3, 2) â”‚ (2, 3, 2) â”‚ (3, 3, 2) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         19â”€â”€â”€â”€â”€â”€â”€â”€â”€20â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€21â”€â”€â”€â”€â”€â”€â”€â”€â”€19
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 2, 2) â”‚ (2, 2, 2) â”‚ (3, 2, 2) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         16â”€â”€â”€â”€â”€â”€â”€â”€â”€17â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€18â”€â”€â”€â”€â”€â”€â”€â”€â”€16
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 1, 2) â”‚ (2, 1, 2) â”‚ (3, 1, 2) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         13â”€â”€â”€â”€â”€â”€â”€â”€â”€14â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€15â”€â”€â”€â”€â”€â”€â”€â”€â”€13


# #         25â”€â”€â”€â”€â”€â”€â”€â”€â”€26â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€27â”€â”€â”€â”€â”€â”€â”€â”€â”€25
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 4, 3) â”‚ (2, 4, 3) â”‚ (3, 4, 3) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         34â”€â”€â”€â”€â”€â”€â”€â”€â”€35â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€36â”€â”€â”€â”€â”€â”€â”€â”€â”€34
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 3, 3) â”‚ (2, 3, 3) â”‚ (3, 3, 3) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         31â”€â”€â”€â”€â”€â”€â”€â”€â”€32â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€33â”€â”€â”€â”€â”€â”€â”€â”€â”€31
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 2, 3) â”‚ (2, 2, 3) â”‚ (3, 2, 3) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         28â”€â”€â”€â”€â”€â”€â”€â”€â”€29â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€30â”€â”€â”€â”€â”€â”€â”€â”€â”€28
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 1, 3) â”‚ (2, 1, 3) â”‚ (3, 1, 3) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         25â”€â”€â”€â”€â”€â”€â”€â”€â”€26â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€27â”€â”€â”€â”€â”€â”€â”€â”€â”€25


# #         37â”€â”€â”€â”€â”€â”€â”€â”€â”€38â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€39â”€â”€â”€â”€â”€â”€â”€â”€â”€37
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 4, 4) â”‚ (2, 4, 4) â”‚ (3, 4, 4) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         46â”€â”€â”€â”€â”€â”€â”€â”€â”€47â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€48â”€â”€â”€â”€â”€â”€â”€â”€â”€46
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 3, 4) â”‚ (2, 3, 4) â”‚ (3, 3, 4) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         43â”€â”€â”€â”€â”€â”€â”€â”€â”€44â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€45â”€â”€â”€â”€â”€â”€â”€â”€â”€43
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 2, 4) â”‚ (2, 2, 4) â”‚ (3, 2, 4) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         40â”€â”€â”€â”€â”€â”€â”€â”€â”€41â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€42â”€â”€â”€â”€â”€â”€â”€â”€â”€40
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 1, 4) â”‚ (2, 1, 4) â”‚ (3, 1, 4) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         37â”€â”€â”€â”€â”€â”€â”€â”€â”€38â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€39â”€â”€â”€â”€â”€â”€â”€â”€â”€37


# #         49â”€â”€â”€â”€â”€â”€â”€â”€â”€50â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€51â”€â”€â”€â”€â”€â”€â”€â”€â”€49
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 4, 5) â”‚ (2, 4, 5) â”‚ (3, 4, 5) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         58â”€â”€â”€â”€â”€â”€â”€â”€â”€59â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€60â”€â”€â”€â”€â”€â”€â”€â”€â”€58
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 3, 5) â”‚ (2, 3, 5) â”‚ (3, 3, 5) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         55â”€â”€â”€â”€â”€â”€â”€â”€â”€56â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€57â”€â”€â”€â”€â”€â”€â”€â”€â”€55
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 2, 5) â”‚ (2, 2, 5) â”‚ (3, 2, 5) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         52â”€â”€â”€â”€â”€â”€â”€â”€â”€53â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€54â”€â”€â”€â”€â”€â”€â”€â”€â”€52
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚ (1, 1, 5) â”‚ (2, 1, 5) â”‚ (3, 1, 5) â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         49â”€â”€â”€â”€â”€â”€â”€â”€â”€50â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€51â”€â”€â”€â”€â”€â”€â”€â”€â”€49


# #         1â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€3â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€4
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         10â”€â”€â”€â”€â”€â”€â”€â”€â”€11â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€12â”€â”€â”€â”€â”€â”€â”€â”€â”€10
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         7â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€8â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€9â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€7
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         4â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€5â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€6â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€4
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         â”‚           â”‚           â”‚           â”‚
# #         1â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€2â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€3â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€1

# #         """
# #         N = [3, 4, 5]
# #         d = size(N, 1)
# #         dims = Tuple(1:n for n in N)
# #         linear = LinearIndices(dims)
# #         @test cell_vertices((1, 1, 1), linear) == [1, 2, 4, 5, 13, 14, 16, 17]
# #         @test cell_vertices((2, 1, 1), linear) == [2, 3, 5, 6, 14, 15, 17, 18]
# #         @test cell_vertices((3, 1, 1), linear) == [3, 1, 6, 4, 15, 13, 18, 16]
# #         @test cell_vertices((1, 2, 1), linear) == [4, 5, 7, 8, 16, 17, 19, 20]
# #         @test cell_vertices((2, 2, 1), linear) == [5, 6, 8, 9, 17, 18, 20, 21]
# #         @test cell_vertices((3, 2, 1), linear) == [6, 4, 9, 7, 18, 16, 21, 19]
# #         @test cell_vertices((1, 3, 1), linear) == [7, 8, 10, 11, 19, 20, 22, 23]
# #         @test cell_vertices((2, 3, 1), linear) == [8, 9, 11, 12, 20, 21, 23, 24]
# #         @test cell_vertices((3, 3, 1), linear) == [9, 7, 12, 10, 21, 19, 24, 22]
# #         @test cell_vertices((1, 4, 1), linear) == [10, 11, 1, 2, 22, 23, 13, 14]
# #         @test cell_vertices((2, 4, 1), linear) == [11, 12, 2, 3, 23, 24, 14, 15]
# #         @test cell_vertices((3, 4, 1), linear) == [12, 10, 3, 1, 24, 22, 15, 13]

# #         @test cell_vertices((1, 1, 2), linear) == [13, 14, 16, 17, 25, 26, 28, 29]
# #         @test cell_vertices((2, 1, 2), linear) == [14, 15, 17, 18, 26, 27, 29, 30]
# #         @test cell_vertices((3, 1, 2), linear) == [15, 13, 18, 16, 27, 25, 30, 28]
# #         @test cell_vertices((1, 2, 2), linear) == [16, 17, 19, 20, 28, 29, 31, 32]
# #         @test cell_vertices((2, 2, 2), linear) == [17, 18, 20, 21, 29, 30, 32, 33]
# #         @test cell_vertices((3, 2, 2), linear) == [18, 16, 21, 19, 30, 28, 33, 31]
# #         @test cell_vertices((1, 3, 2), linear) == [19, 20, 22, 23, 31, 32, 34, 35]
# #         @test cell_vertices((2, 3, 2), linear) == [20, 21, 23, 24, 32, 33, 35, 36]
# #         @test cell_vertices((3, 3, 2), linear) == [21, 19, 24, 22, 33, 31, 36, 34]
# #         @test cell_vertices((1, 4, 2), linear) == [22, 23, 13, 14, 34, 35, 25, 26]
# #         @test cell_vertices((2, 4, 2), linear) == [23, 24, 14, 15, 35, 36, 26, 27]
# #         @test cell_vertices((3, 4, 2), linear) == [24, 22, 15, 13, 36, 34, 27, 25]

# #         @test cell_vertices((1, 1, 3), linear) == [25, 26, 28, 29, 37, 38, 40, 41]
# #         @test cell_vertices((2, 1, 3), linear) == [26, 27, 29, 30, 38, 39, 41, 42]
# #         @test cell_vertices((3, 1, 3), linear) == [27, 25, 30, 28, 39, 37, 42, 40]
# #         @test cell_vertices((1, 2, 3), linear) == [28, 29, 31, 32, 40, 41, 43, 44]
# #         @test cell_vertices((2, 2, 3), linear) == [29, 30, 32, 33, 41, 42, 44, 45]
# #         @test cell_vertices((3, 2, 3), linear) == [30, 28, 33, 31, 42, 40, 45, 43]
# #         @test cell_vertices((1, 3, 3), linear) == [31, 32, 34, 35, 43, 44, 46, 47]
# #         @test cell_vertices((2, 3, 3), linear) == [32, 33, 35, 36, 44, 45, 47, 48]
# #         @test cell_vertices((3, 3, 3), linear) == [33, 31, 36, 34, 45, 43, 48, 46]
# #         @test cell_vertices((1, 4, 3), linear) == [34, 35, 25, 26, 46, 47, 37, 38]
# #         @test cell_vertices((2, 4, 3), linear) == [35, 36, 26, 27, 47, 48, 38, 39]
# #         @test cell_vertices((3, 4, 3), linear) == [36, 34, 27, 25, 48, 46, 39, 37]

# #         @test cell_vertices((1, 1, 4), linear) == [37, 38, 40, 41, 49, 50, 52, 53]
# #         @test cell_vertices((2, 1, 4), linear) == [38, 39, 41, 42, 50, 51, 53, 54]
# #         @test cell_vertices((3, 1, 4), linear) == [39, 37, 42, 40, 51, 49, 54, 52]
# #         @test cell_vertices((1, 2, 4), linear) == [40, 41, 43, 44, 52, 53, 55, 56]
# #         @test cell_vertices((2, 2, 4), linear) == [41, 42, 44, 45, 53, 54, 56, 57]
# #         @test cell_vertices((3, 2, 4), linear) == [42, 40, 45, 43, 54, 52, 57, 55]
# #         @test cell_vertices((1, 3, 4), linear) == [43, 44, 46, 47, 55, 56, 58, 59]
# #         @test cell_vertices((2, 3, 4), linear) == [44, 45, 47, 48, 56, 57, 59, 60]
# #         @test cell_vertices((3, 3, 4), linear) == [45, 43, 48, 46, 57, 55, 60, 58]
# #         @test cell_vertices((1, 4, 4), linear) == [46, 47, 37, 38, 58, 59, 49, 50]
# #         @test cell_vertices((2, 4, 4), linear) == [47, 48, 38, 39, 59, 60, 50, 51]
# #         @test cell_vertices((3, 4, 4), linear) == [48, 46, 39, 37, 60, 58, 51, 49]

# #         @test cell_vertices((1, 1, 5), linear) == [49, 50, 52, 53, 1, 2, 4, 5]
# #         @test cell_vertices((2, 1, 5), linear) == [50, 51, 53, 54, 2, 3, 5, 6]
# #         @test cell_vertices((3, 1, 5), linear) == [51, 49, 54, 52, 3, 1, 6, 4]
# #         @test cell_vertices((1, 2, 5), linear) == [52, 53, 55, 56, 4, 5, 7, 8]
# #         @test cell_vertices((2, 2, 5), linear) == [53, 54, 56, 57, 5, 6, 8, 9]
# #         @test cell_vertices((3, 2, 5), linear) == [54, 52, 57, 55, 6, 4, 9, 7]
# #         @test cell_vertices((1, 3, 5), linear) == [55, 56, 58, 59, 7, 8, 10, 11]
# #         @test cell_vertices((2, 3, 5), linear) == [56, 57, 59, 60, 8, 9, 11, 12]
# #         @test cell_vertices((3, 3, 5), linear) == [57, 55, 60, 58, 9, 7, 12, 10]
# #         @test cell_vertices((1, 4, 5), linear) == [58, 59, 49, 50, 10, 11, 1, 2]
# #         @test cell_vertices((2, 4, 5), linear) == [59, 60, 50, 51, 11, 12, 2, 3]
# #         @test cell_vertices((3, 4, 5), linear) == [60, 58, 51, 49, 12, 10, 3, 1]
# #     end
# # end

# # # @testset "bri17, 2D" begin
# # #     C = Hooke{Float64, 2}(5.6, 0.3)
# # #     N = [2, 4]
# # #     h = [1.1, 1.2]
# # # end
