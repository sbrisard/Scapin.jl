using Base.Iterators
using LinearAlgebra

function expected_avg_gradient_operator(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    𝔑 = element_nodes(d)
    D = zeros(T, d, fill(2, d)...)
    for i = 1:d, n in 𝔑
        D[i, n] = (-1)^n[i] / 2^(d - 1) / h[i]
    end
    return D
end


function expected_avg_strain_displacement_operator(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    𝔑 = element_nodes(d)
    D = expected_avg_gradient_operator(h)
    B = zeros(T, d, d, fill(2, d)..., d)
    for i = 1:d, j = 1:d, n in 𝔑, k = 1:d
        B[i, j, n, k] = (D[i, n] * T(j == k) + D[j, n] * T(i == k)) / 2
    end
    return B
end

function expected_K_λ(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    K_λ = zeros(Float64, fill(2, d)..., d, fill(2, d)..., d)
    if d == 2
        value = -1 / 4
        K_λ[1, 1, 1, 1, 2, 2] = value
        K_λ[1, 1, 1, 2, 2, 2] = value
        K_λ[1, 1, 2, 2, 1, 1] = value
        K_λ[1, 1, 2, 2, 2, 1] = value
        K_λ[1, 2, 1, 1, 2, 2] = value
        K_λ[1, 2, 1, 2, 2, 2] = value
        K_λ[1, 2, 2, 1, 1, 1] = value
        K_λ[1, 2, 2, 1, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 2] = value
        K_λ[2, 1, 1, 2, 1, 2] = value
        K_λ[2, 1, 2, 2, 1, 1] = value
        K_λ[2, 1, 2, 2, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 2] = value
        K_λ[2, 2, 1, 2, 1, 2] = value
        K_λ[2, 2, 2, 1, 1, 1] = value
        K_λ[2, 2, 2, 1, 2, 1] = value

        value = 1 / 4
        K_λ[1, 1, 1, 1, 1, 2] = value
        K_λ[1, 1, 1, 2, 1, 2] = value
        K_λ[1, 1, 2, 1, 1, 1] = value
        K_λ[1, 1, 2, 1, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 2] = value
        K_λ[1, 2, 1, 2, 1, 2] = value
        K_λ[1, 2, 2, 2, 1, 1] = value
        K_λ[1, 2, 2, 2, 2, 1] = value
        K_λ[2, 1, 1, 1, 2, 2] = value
        K_λ[2, 1, 1, 2, 2, 2] = value
        K_λ[2, 1, 2, 1, 1, 1] = value
        K_λ[2, 1, 2, 1, 2, 1] = value
        K_λ[2, 2, 1, 1, 2, 2] = value
        K_λ[2, 2, 1, 2, 2, 2] = value
        K_λ[2, 2, 2, 2, 1, 1] = value
        K_λ[2, 2, 2, 2, 2, 1] = value

        value = -h[1] / (3 * h[2])
        K_λ[1, 1, 2, 1, 2, 2] = value
        K_λ[1, 2, 2, 1, 1, 2] = value
        K_λ[2, 1, 2, 2, 2, 2] = value
        K_λ[2, 2, 2, 2, 1, 2] = value

        value = -h[1] / (6 * h[2])
        K_λ[1, 1, 2, 2, 2, 2] = value
        K_λ[1, 2, 2, 2, 1, 2] = value
        K_λ[2, 1, 2, 1, 2, 2] = value
        K_λ[2, 2, 2, 1, 1, 2] = value

        value = h[1] / (6 * h[2])
        K_λ[1, 1, 2, 2, 1, 2] = value
        K_λ[1, 2, 2, 2, 2, 2] = value
        K_λ[2, 1, 2, 1, 1, 2] = value
        K_λ[2, 2, 2, 1, 2, 2] = value

        value = h[1] / (3 * h[2])
        K_λ[1, 1, 2, 1, 1, 2] = value
        K_λ[1, 2, 2, 1, 2, 2] = value
        K_λ[2, 1, 2, 2, 1, 2] = value
        K_λ[2, 2, 2, 2, 2, 2] = value

        value = -h[2] / (3 * h[1])
        K_λ[1, 1, 1, 2, 1, 1] = value
        K_λ[1, 2, 1, 2, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 1] = value
        K_λ[2, 2, 1, 1, 2, 1] = value

        value = -h[2] / (6 * h[1])
        K_λ[1, 1, 1, 2, 2, 1] = value
        K_λ[1, 2, 1, 2, 1, 1] = value
        K_λ[2, 1, 1, 1, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 1] = value

        value = h[2] / (6 * h[1])
        K_λ[1, 1, 1, 1, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 1] = value
        K_λ[2, 1, 1, 2, 2, 1] = value
        K_λ[2, 2, 1, 2, 1, 1] = value

        value = h[2] / (3 * h[1])
        K_λ[1, 1, 1, 1, 1, 1] = value
        K_λ[1, 2, 1, 1, 2, 1] = value
        K_λ[2, 1, 1, 2, 1, 1] = value
        K_λ[2, 2, 1, 2, 2, 1] = value
    elseif d == 3
        value = -h[1] / 12
        K_λ[1, 1, 1, 2, 1, 1, 2, 3] = value
        K_λ[1, 1, 1, 2, 1, 2, 2, 3] = value
        K_λ[1, 1, 1, 3, 1, 2, 1, 2] = value
        K_λ[1, 1, 1, 3, 1, 2, 2, 2] = value
        K_λ[1, 1, 2, 2, 1, 1, 2, 3] = value
        K_λ[1, 1, 2, 2, 1, 2, 2, 3] = value
        K_λ[1, 1, 2, 3, 1, 1, 1, 2] = value
        K_λ[1, 1, 2, 3, 1, 1, 2, 2] = value
        K_λ[1, 2, 1, 2, 1, 1, 1, 3] = value
        K_λ[1, 2, 1, 2, 1, 2, 1, 3] = value
        K_λ[1, 2, 1, 3, 1, 2, 1, 2] = value
        K_λ[1, 2, 1, 3, 1, 2, 2, 2] = value
        K_λ[1, 2, 2, 2, 1, 1, 1, 3] = value
        K_λ[1, 2, 2, 2, 1, 2, 1, 3] = value
        K_λ[1, 2, 2, 3, 1, 1, 1, 2] = value
        K_λ[1, 2, 2, 3, 1, 1, 2, 2] = value
        K_λ[2, 1, 1, 2, 2, 1, 2, 3] = value
        K_λ[2, 1, 1, 2, 2, 2, 2, 3] = value
        K_λ[2, 1, 1, 3, 2, 2, 1, 2] = value
        K_λ[2, 1, 1, 3, 2, 2, 2, 2] = value
        K_λ[2, 1, 2, 2, 2, 1, 2, 3] = value
        K_λ[2, 1, 2, 2, 2, 2, 2, 3] = value
        K_λ[2, 1, 2, 3, 2, 1, 1, 2] = value
        K_λ[2, 1, 2, 3, 2, 1, 2, 2] = value
        K_λ[2, 2, 1, 2, 2, 1, 1, 3] = value
        K_λ[2, 2, 1, 2, 2, 2, 1, 3] = value
        K_λ[2, 2, 1, 3, 2, 2, 1, 2] = value
        K_λ[2, 2, 1, 3, 2, 2, 2, 2] = value
        K_λ[2, 2, 2, 2, 2, 1, 1, 3] = value
        K_λ[2, 2, 2, 2, 2, 2, 1, 3] = value
        K_λ[2, 2, 2, 3, 2, 1, 1, 2] = value
        K_λ[2, 2, 2, 3, 2, 1, 2, 2] = value

        value = -h[1] / 24
        K_λ[1, 1, 1, 2, 2, 1, 2, 3] = value
        K_λ[1, 1, 1, 2, 2, 2, 2, 3] = value
        K_λ[1, 1, 1, 3, 2, 2, 1, 2] = value
        K_λ[1, 1, 1, 3, 2, 2, 2, 2] = value
        K_λ[1, 1, 2, 2, 2, 1, 2, 3] = value
        K_λ[1, 1, 2, 2, 2, 2, 2, 3] = value
        K_λ[1, 1, 2, 3, 2, 1, 1, 2] = value
        K_λ[1, 1, 2, 3, 2, 1, 2, 2] = value
        K_λ[1, 2, 1, 2, 2, 1, 1, 3] = value
        K_λ[1, 2, 1, 2, 2, 2, 1, 3] = value
        K_λ[1, 2, 1, 3, 2, 2, 1, 2] = value
        K_λ[1, 2, 1, 3, 2, 2, 2, 2] = value
        K_λ[1, 2, 2, 2, 2, 1, 1, 3] = value
        K_λ[1, 2, 2, 2, 2, 2, 1, 3] = value
        K_λ[1, 2, 2, 3, 2, 1, 1, 2] = value
        K_λ[1, 2, 2, 3, 2, 1, 2, 2] = value
        K_λ[2, 1, 1, 2, 1, 1, 2, 3] = value
        K_λ[2, 1, 1, 2, 1, 2, 2, 3] = value
        K_λ[2, 1, 1, 3, 1, 2, 1, 2] = value
        K_λ[2, 1, 1, 3, 1, 2, 2, 2] = value
        K_λ[2, 1, 2, 2, 1, 1, 2, 3] = value
        K_λ[2, 1, 2, 2, 1, 2, 2, 3] = value
        K_λ[2, 1, 2, 3, 1, 1, 1, 2] = value
        K_λ[2, 1, 2, 3, 1, 1, 2, 2] = value
        K_λ[2, 2, 1, 2, 1, 1, 1, 3] = value
        K_λ[2, 2, 1, 2, 1, 2, 1, 3] = value
        K_λ[2, 2, 1, 3, 1, 2, 1, 2] = value
        K_λ[2, 2, 1, 3, 1, 2, 2, 2] = value
        K_λ[2, 2, 2, 2, 1, 1, 1, 3] = value
        K_λ[2, 2, 2, 2, 1, 2, 1, 3] = value
        K_λ[2, 2, 2, 3, 1, 1, 1, 2] = value
        K_λ[2, 2, 2, 3, 1, 1, 2, 2] = value

        value = h[1] / 24
        K_λ[1, 1, 1, 2, 2, 1, 1, 3] = value
        K_λ[1, 1, 1, 2, 2, 2, 1, 3] = value
        K_λ[1, 1, 1, 3, 2, 1, 1, 2] = value
        K_λ[1, 1, 1, 3, 2, 1, 2, 2] = value
        K_λ[1, 1, 2, 2, 2, 1, 1, 3] = value
        K_λ[1, 1, 2, 2, 2, 2, 1, 3] = value
        K_λ[1, 1, 2, 3, 2, 2, 1, 2] = value
        K_λ[1, 1, 2, 3, 2, 2, 2, 2] = value
        K_λ[1, 2, 1, 2, 2, 1, 2, 3] = value
        K_λ[1, 2, 1, 2, 2, 2, 2, 3] = value
        K_λ[1, 2, 1, 3, 2, 1, 1, 2] = value
        K_λ[1, 2, 1, 3, 2, 1, 2, 2] = value
        K_λ[1, 2, 2, 2, 2, 1, 2, 3] = value
        K_λ[1, 2, 2, 2, 2, 2, 2, 3] = value
        K_λ[1, 2, 2, 3, 2, 2, 1, 2] = value
        K_λ[1, 2, 2, 3, 2, 2, 2, 2] = value
        K_λ[2, 1, 1, 2, 1, 1, 1, 3] = value
        K_λ[2, 1, 1, 2, 1, 2, 1, 3] = value
        K_λ[2, 1, 1, 3, 1, 1, 1, 2] = value
        K_λ[2, 1, 1, 3, 1, 1, 2, 2] = value
        K_λ[2, 1, 2, 2, 1, 1, 1, 3] = value
        K_λ[2, 1, 2, 2, 1, 2, 1, 3] = value
        K_λ[2, 1, 2, 3, 1, 2, 1, 2] = value
        K_λ[2, 1, 2, 3, 1, 2, 2, 2] = value
        K_λ[2, 2, 1, 2, 1, 1, 2, 3] = value
        K_λ[2, 2, 1, 2, 1, 2, 2, 3] = value
        K_λ[2, 2, 1, 3, 1, 1, 1, 2] = value
        K_λ[2, 2, 1, 3, 1, 1, 2, 2] = value
        K_λ[2, 2, 2, 2, 1, 1, 2, 3] = value
        K_λ[2, 2, 2, 2, 1, 2, 2, 3] = value
        K_λ[2, 2, 2, 3, 1, 2, 1, 2] = value
        K_λ[2, 2, 2, 3, 1, 2, 2, 2] = value

        value = h[1] / 12
        K_λ[1, 1, 1, 2, 1, 1, 1, 3] = value
        K_λ[1, 1, 1, 2, 1, 2, 1, 3] = value
        K_λ[1, 1, 1, 3, 1, 1, 1, 2] = value
        K_λ[1, 1, 1, 3, 1, 1, 2, 2] = value
        K_λ[1, 1, 2, 2, 1, 1, 1, 3] = value
        K_λ[1, 1, 2, 2, 1, 2, 1, 3] = value
        K_λ[1, 1, 2, 3, 1, 2, 1, 2] = value
        K_λ[1, 1, 2, 3, 1, 2, 2, 2] = value
        K_λ[1, 2, 1, 2, 1, 1, 2, 3] = value
        K_λ[1, 2, 1, 2, 1, 2, 2, 3] = value
        K_λ[1, 2, 1, 3, 1, 1, 1, 2] = value
        K_λ[1, 2, 1, 3, 1, 1, 2, 2] = value
        K_λ[1, 2, 2, 2, 1, 1, 2, 3] = value
        K_λ[1, 2, 2, 2, 1, 2, 2, 3] = value
        K_λ[1, 2, 2, 3, 1, 2, 1, 2] = value
        K_λ[1, 2, 2, 3, 1, 2, 2, 2] = value
        K_λ[2, 1, 1, 2, 2, 1, 1, 3] = value
        K_λ[2, 1, 1, 2, 2, 2, 1, 3] = value
        K_λ[2, 1, 1, 3, 2, 1, 1, 2] = value
        K_λ[2, 1, 1, 3, 2, 1, 2, 2] = value
        K_λ[2, 1, 2, 2, 2, 1, 1, 3] = value
        K_λ[2, 1, 2, 2, 2, 2, 1, 3] = value
        K_λ[2, 1, 2, 3, 2, 2, 1, 2] = value
        K_λ[2, 1, 2, 3, 2, 2, 2, 2] = value
        K_λ[2, 2, 1, 2, 2, 1, 2, 3] = value
        K_λ[2, 2, 1, 2, 2, 2, 2, 3] = value
        K_λ[2, 2, 1, 3, 2, 1, 1, 2] = value
        K_λ[2, 2, 1, 3, 2, 1, 2, 2] = value
        K_λ[2, 2, 2, 2, 2, 1, 2, 3] = value
        K_λ[2, 2, 2, 2, 2, 2, 2, 3] = value
        K_λ[2, 2, 2, 3, 2, 2, 1, 2] = value
        K_λ[2, 2, 2, 3, 2, 2, 2, 2] = value

        value = -h[2] / 12
        K_λ[1, 1, 1, 1, 1, 1, 2, 3] = value
        K_λ[1, 1, 1, 1, 2, 1, 2, 3] = value
        K_λ[1, 1, 1, 3, 2, 1, 1, 1] = value
        K_λ[1, 1, 1, 3, 2, 1, 2, 1] = value
        K_λ[1, 1, 2, 1, 1, 1, 2, 3] = value
        K_λ[1, 1, 2, 1, 2, 1, 2, 3] = value
        K_λ[1, 1, 2, 3, 1, 1, 1, 1] = value
        K_λ[1, 1, 2, 3, 1, 1, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 2, 2, 3] = value
        K_λ[1, 2, 1, 1, 2, 2, 2, 3] = value
        K_λ[1, 2, 1, 3, 2, 2, 1, 1] = value
        K_λ[1, 2, 1, 3, 2, 2, 2, 1] = value
        K_λ[1, 2, 2, 1, 1, 2, 2, 3] = value
        K_λ[1, 2, 2, 1, 2, 2, 2, 3] = value
        K_λ[1, 2, 2, 3, 1, 2, 1, 1] = value
        K_λ[1, 2, 2, 3, 1, 2, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 1, 1, 3] = value
        K_λ[2, 1, 1, 1, 2, 1, 1, 3] = value
        K_λ[2, 1, 1, 3, 2, 1, 1, 1] = value
        K_λ[2, 1, 1, 3, 2, 1, 2, 1] = value
        K_λ[2, 1, 2, 1, 1, 1, 1, 3] = value
        K_λ[2, 1, 2, 1, 2, 1, 1, 3] = value
        K_λ[2, 1, 2, 3, 1, 1, 1, 1] = value
        K_λ[2, 1, 2, 3, 1, 1, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 2, 1, 3] = value
        K_λ[2, 2, 1, 1, 2, 2, 1, 3] = value
        K_λ[2, 2, 1, 3, 2, 2, 1, 1] = value
        K_λ[2, 2, 1, 3, 2, 2, 2, 1] = value
        K_λ[2, 2, 2, 1, 1, 2, 1, 3] = value
        K_λ[2, 2, 2, 1, 2, 2, 1, 3] = value
        K_λ[2, 2, 2, 3, 1, 2, 1, 1] = value
        K_λ[2, 2, 2, 3, 1, 2, 2, 1] = value

        value = -h[2] / 24
        K_λ[1, 1, 1, 1, 1, 2, 2, 3] = value
        K_λ[1, 1, 1, 1, 2, 2, 2, 3] = value
        K_λ[1, 1, 1, 3, 2, 2, 1, 1] = value
        K_λ[1, 1, 1, 3, 2, 2, 2, 1] = value
        K_λ[1, 1, 2, 1, 1, 2, 2, 3] = value
        K_λ[1, 1, 2, 1, 2, 2, 2, 3] = value
        K_λ[1, 1, 2, 3, 1, 2, 1, 1] = value
        K_λ[1, 1, 2, 3, 1, 2, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 1, 2, 3] = value
        K_λ[1, 2, 1, 1, 2, 1, 2, 3] = value
        K_λ[1, 2, 1, 3, 2, 1, 1, 1] = value
        K_λ[1, 2, 1, 3, 2, 1, 2, 1] = value
        K_λ[1, 2, 2, 1, 1, 1, 2, 3] = value
        K_λ[1, 2, 2, 1, 2, 1, 2, 3] = value
        K_λ[1, 2, 2, 3, 1, 1, 1, 1] = value
        K_λ[1, 2, 2, 3, 1, 1, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 2, 1, 3] = value
        K_λ[2, 1, 1, 1, 2, 2, 1, 3] = value
        K_λ[2, 1, 1, 3, 2, 2, 1, 1] = value
        K_λ[2, 1, 1, 3, 2, 2, 2, 1] = value
        K_λ[2, 1, 2, 1, 1, 2, 1, 3] = value
        K_λ[2, 1, 2, 1, 2, 2, 1, 3] = value
        K_λ[2, 1, 2, 3, 1, 2, 1, 1] = value
        K_λ[2, 1, 2, 3, 1, 2, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 1, 1, 3] = value
        K_λ[2, 2, 1, 1, 2, 1, 1, 3] = value
        K_λ[2, 2, 1, 3, 2, 1, 1, 1] = value
        K_λ[2, 2, 1, 3, 2, 1, 2, 1] = value
        K_λ[2, 2, 2, 1, 1, 1, 1, 3] = value
        K_λ[2, 2, 2, 1, 2, 1, 1, 3] = value
        K_λ[2, 2, 2, 3, 1, 1, 1, 1] = value
        K_λ[2, 2, 2, 3, 1, 1, 2, 1] = value

        value = h[2] / 24
        K_λ[1, 1, 1, 1, 1, 2, 1, 3] = value
        K_λ[1, 1, 1, 1, 2, 2, 1, 3] = value
        K_λ[1, 1, 1, 3, 1, 2, 1, 1] = value
        K_λ[1, 1, 1, 3, 1, 2, 2, 1] = value
        K_λ[1, 1, 2, 1, 1, 2, 1, 3] = value
        K_λ[1, 1, 2, 1, 2, 2, 1, 3] = value
        K_λ[1, 1, 2, 3, 2, 2, 1, 1] = value
        K_λ[1, 1, 2, 3, 2, 2, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 1, 1, 3] = value
        K_λ[1, 2, 1, 1, 2, 1, 1, 3] = value
        K_λ[1, 2, 1, 3, 1, 1, 1, 1] = value
        K_λ[1, 2, 1, 3, 1, 1, 2, 1] = value
        K_λ[1, 2, 2, 1, 1, 1, 1, 3] = value
        K_λ[1, 2, 2, 1, 2, 1, 1, 3] = value
        K_λ[1, 2, 2, 3, 2, 1, 1, 1] = value
        K_λ[1, 2, 2, 3, 2, 1, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 2, 2, 3] = value
        K_λ[2, 1, 1, 1, 2, 2, 2, 3] = value
        K_λ[2, 1, 1, 3, 1, 2, 1, 1] = value
        K_λ[2, 1, 1, 3, 1, 2, 2, 1] = value
        K_λ[2, 1, 2, 1, 1, 2, 2, 3] = value
        K_λ[2, 1, 2, 1, 2, 2, 2, 3] = value
        K_λ[2, 1, 2, 3, 2, 2, 1, 1] = value
        K_λ[2, 1, 2, 3, 2, 2, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 1, 2, 3] = value
        K_λ[2, 2, 1, 1, 2, 1, 2, 3] = value
        K_λ[2, 2, 1, 3, 1, 1, 1, 1] = value
        K_λ[2, 2, 1, 3, 1, 1, 2, 1] = value
        K_λ[2, 2, 2, 1, 1, 1, 2, 3] = value
        K_λ[2, 2, 2, 1, 2, 1, 2, 3] = value
        K_λ[2, 2, 2, 3, 2, 1, 1, 1] = value
        K_λ[2, 2, 2, 3, 2, 1, 2, 1] = value

        value = h[2] / 12
        K_λ[1, 1, 1, 1, 1, 1, 1, 3] = value
        K_λ[1, 1, 1, 1, 2, 1, 1, 3] = value
        K_λ[1, 1, 1, 3, 1, 1, 1, 1] = value
        K_λ[1, 1, 1, 3, 1, 1, 2, 1] = value
        K_λ[1, 1, 2, 1, 1, 1, 1, 3] = value
        K_λ[1, 1, 2, 1, 2, 1, 1, 3] = value
        K_λ[1, 1, 2, 3, 2, 1, 1, 1] = value
        K_λ[1, 1, 2, 3, 2, 1, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 2, 1, 3] = value
        K_λ[1, 2, 1, 1, 2, 2, 1, 3] = value
        K_λ[1, 2, 1, 3, 1, 2, 1, 1] = value
        K_λ[1, 2, 1, 3, 1, 2, 2, 1] = value
        K_λ[1, 2, 2, 1, 1, 2, 1, 3] = value
        K_λ[1, 2, 2, 1, 2, 2, 1, 3] = value
        K_λ[1, 2, 2, 3, 2, 2, 1, 1] = value
        K_λ[1, 2, 2, 3, 2, 2, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 1, 2, 3] = value
        K_λ[2, 1, 1, 1, 2, 1, 2, 3] = value
        K_λ[2, 1, 1, 3, 1, 1, 1, 1] = value
        K_λ[2, 1, 1, 3, 1, 1, 2, 1] = value
        K_λ[2, 1, 2, 1, 1, 1, 2, 3] = value
        K_λ[2, 1, 2, 1, 2, 1, 2, 3] = value
        K_λ[2, 1, 2, 3, 2, 1, 1, 1] = value
        K_λ[2, 1, 2, 3, 2, 1, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 2, 2, 3] = value
        K_λ[2, 2, 1, 1, 2, 2, 2, 3] = value
        K_λ[2, 2, 1, 3, 1, 2, 1, 1] = value
        K_λ[2, 2, 1, 3, 1, 2, 2, 1] = value
        K_λ[2, 2, 2, 1, 1, 2, 2, 3] = value
        K_λ[2, 2, 2, 1, 2, 2, 2, 3] = value
        K_λ[2, 2, 2, 3, 2, 2, 1, 1] = value
        K_λ[2, 2, 2, 3, 2, 2, 2, 1] = value

        value = -(h[1] * h[2]) / (9 * h[3])
        K_λ[1, 1, 1, 3, 1, 1, 2, 3] = value
        K_λ[1, 1, 2, 3, 1, 1, 1, 3] = value
        K_λ[1, 2, 1, 3, 1, 2, 2, 3] = value
        K_λ[1, 2, 2, 3, 1, 2, 1, 3] = value
        K_λ[2, 1, 1, 3, 2, 1, 2, 3] = value
        K_λ[2, 1, 2, 3, 2, 1, 1, 3] = value
        K_λ[2, 2, 1, 3, 2, 2, 2, 3] = value
        K_λ[2, 2, 2, 3, 2, 2, 1, 3] = value

        value = -(h[1] * h[2]) / (18 * h[3])
        K_λ[1, 1, 1, 3, 1, 2, 2, 3] = value
        K_λ[1, 1, 1, 3, 2, 1, 2, 3] = value
        K_λ[1, 1, 2, 3, 1, 2, 1, 3] = value
        K_λ[1, 1, 2, 3, 2, 1, 1, 3] = value
        K_λ[1, 2, 1, 3, 1, 1, 2, 3] = value
        K_λ[1, 2, 1, 3, 2, 2, 2, 3] = value
        K_λ[1, 2, 2, 3, 1, 1, 1, 3] = value
        K_λ[1, 2, 2, 3, 2, 2, 1, 3] = value
        K_λ[2, 1, 1, 3, 1, 1, 2, 3] = value
        K_λ[2, 1, 1, 3, 2, 2, 2, 3] = value
        K_λ[2, 1, 2, 3, 1, 1, 1, 3] = value
        K_λ[2, 1, 2, 3, 2, 2, 1, 3] = value
        K_λ[2, 2, 1, 3, 1, 2, 2, 3] = value
        K_λ[2, 2, 1, 3, 2, 1, 2, 3] = value
        K_λ[2, 2, 2, 3, 1, 2, 1, 3] = value
        K_λ[2, 2, 2, 3, 2, 1, 1, 3] = value

        value = -(h[1] * h[2]) / (36 * h[3])
        K_λ[1, 1, 1, 3, 2, 2, 2, 3] = value
        K_λ[1, 1, 2, 3, 2, 2, 1, 3] = value
        K_λ[1, 2, 1, 3, 2, 1, 2, 3] = value
        K_λ[1, 2, 2, 3, 2, 1, 1, 3] = value
        K_λ[2, 1, 1, 3, 1, 2, 2, 3] = value
        K_λ[2, 1, 2, 3, 1, 2, 1, 3] = value
        K_λ[2, 2, 1, 3, 1, 1, 2, 3] = value
        K_λ[2, 2, 2, 3, 1, 1, 1, 3] = value

        value = (h[1] * h[2]) / (36 * h[3])
        K_λ[1, 1, 1, 3, 2, 2, 1, 3] = value
        K_λ[1, 1, 2, 3, 2, 2, 2, 3] = value
        K_λ[1, 2, 1, 3, 2, 1, 1, 3] = value
        K_λ[1, 2, 2, 3, 2, 1, 2, 3] = value
        K_λ[2, 1, 1, 3, 1, 2, 1, 3] = value
        K_λ[2, 1, 2, 3, 1, 2, 2, 3] = value
        K_λ[2, 2, 1, 3, 1, 1, 1, 3] = value
        K_λ[2, 2, 2, 3, 1, 1, 2, 3] = value

        value = (h[1] * h[2]) / (18 * h[3])
        K_λ[1, 1, 1, 3, 1, 2, 1, 3] = value
        K_λ[1, 1, 1, 3, 2, 1, 1, 3] = value
        K_λ[1, 1, 2, 3, 1, 2, 2, 3] = value
        K_λ[1, 1, 2, 3, 2, 1, 2, 3] = value
        K_λ[1, 2, 1, 3, 1, 1, 1, 3] = value
        K_λ[1, 2, 1, 3, 2, 2, 1, 3] = value
        K_λ[1, 2, 2, 3, 1, 1, 2, 3] = value
        K_λ[1, 2, 2, 3, 2, 2, 2, 3] = value
        K_λ[2, 1, 1, 3, 1, 1, 1, 3] = value
        K_λ[2, 1, 1, 3, 2, 2, 1, 3] = value
        K_λ[2, 1, 2, 3, 1, 1, 2, 3] = value
        K_λ[2, 1, 2, 3, 2, 2, 2, 3] = value
        K_λ[2, 2, 1, 3, 1, 2, 1, 3] = value
        K_λ[2, 2, 1, 3, 2, 1, 1, 3] = value
        K_λ[2, 2, 2, 3, 1, 2, 2, 3] = value
        K_λ[2, 2, 2, 3, 2, 1, 2, 3] = value

        value = (h[1] * h[2]) / (9 * h[3])
        K_λ[1, 1, 1, 3, 1, 1, 1, 3] = value
        K_λ[1, 1, 2, 3, 1, 1, 2, 3] = value
        K_λ[1, 2, 1, 3, 1, 2, 1, 3] = value
        K_λ[1, 2, 2, 3, 1, 2, 2, 3] = value
        K_λ[2, 1, 1, 3, 2, 1, 1, 3] = value
        K_λ[2, 1, 2, 3, 2, 1, 2, 3] = value
        K_λ[2, 2, 1, 3, 2, 2, 1, 3] = value
        K_λ[2, 2, 2, 3, 2, 2, 2, 3] = value

        value = -h[3] / 12
        K_λ[1, 1, 1, 1, 1, 2, 1, 2] = value
        K_λ[1, 1, 1, 1, 2, 2, 1, 2] = value
        K_λ[1, 1, 1, 2, 2, 1, 1, 1] = value
        K_λ[1, 1, 1, 2, 2, 2, 1, 1] = value
        K_λ[1, 1, 2, 1, 1, 2, 2, 2] = value
        K_λ[1, 1, 2, 1, 2, 2, 2, 2] = value
        K_λ[1, 1, 2, 2, 2, 1, 2, 1] = value
        K_λ[1, 1, 2, 2, 2, 2, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 2, 1, 2] = value
        K_λ[1, 2, 1, 1, 2, 2, 1, 2] = value
        K_λ[1, 2, 1, 2, 1, 1, 1, 1] = value
        K_λ[1, 2, 1, 2, 1, 2, 1, 1] = value
        K_λ[1, 2, 2, 1, 1, 2, 2, 2] = value
        K_λ[1, 2, 2, 1, 2, 2, 2, 2] = value
        K_λ[1, 2, 2, 2, 1, 1, 2, 1] = value
        K_λ[1, 2, 2, 2, 1, 2, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 1, 1, 2] = value
        K_λ[2, 1, 1, 1, 2, 1, 1, 2] = value
        K_λ[2, 1, 1, 2, 2, 1, 1, 1] = value
        K_λ[2, 1, 1, 2, 2, 2, 1, 1] = value
        K_λ[2, 1, 2, 1, 1, 1, 2, 2] = value
        K_λ[2, 1, 2, 1, 2, 1, 2, 2] = value
        K_λ[2, 1, 2, 2, 2, 1, 2, 1] = value
        K_λ[2, 1, 2, 2, 2, 2, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 1, 1, 2] = value
        K_λ[2, 2, 1, 1, 2, 1, 1, 2] = value
        K_λ[2, 2, 1, 2, 1, 1, 1, 1] = value
        K_λ[2, 2, 1, 2, 1, 2, 1, 1] = value
        K_λ[2, 2, 2, 1, 1, 1, 2, 2] = value
        K_λ[2, 2, 2, 1, 2, 1, 2, 2] = value
        K_λ[2, 2, 2, 2, 1, 1, 2, 1] = value
        K_λ[2, 2, 2, 2, 1, 2, 2, 1] = value

        value = -h[3] / 24
        K_λ[1, 1, 1, 1, 1, 2, 2, 2] = value
        K_λ[1, 1, 1, 1, 2, 2, 2, 2] = value
        K_λ[1, 1, 1, 2, 2, 1, 2, 1] = value
        K_λ[1, 1, 1, 2, 2, 2, 2, 1] = value
        K_λ[1, 1, 2, 1, 1, 2, 1, 2] = value
        K_λ[1, 1, 2, 1, 2, 2, 1, 2] = value
        K_λ[1, 1, 2, 2, 2, 1, 1, 1] = value
        K_λ[1, 1, 2, 2, 2, 2, 1, 1] = value
        K_λ[1, 2, 1, 1, 1, 2, 2, 2] = value
        K_λ[1, 2, 1, 1, 2, 2, 2, 2] = value
        K_λ[1, 2, 1, 2, 1, 1, 2, 1] = value
        K_λ[1, 2, 1, 2, 1, 2, 2, 1] = value
        K_λ[1, 2, 2, 1, 1, 2, 1, 2] = value
        K_λ[1, 2, 2, 1, 2, 2, 1, 2] = value
        K_λ[1, 2, 2, 2, 1, 1, 1, 1] = value
        K_λ[1, 2, 2, 2, 1, 2, 1, 1] = value
        K_λ[2, 1, 1, 1, 1, 1, 2, 2] = value
        K_λ[2, 1, 1, 1, 2, 1, 2, 2] = value
        K_λ[2, 1, 1, 2, 2, 1, 2, 1] = value
        K_λ[2, 1, 1, 2, 2, 2, 2, 1] = value
        K_λ[2, 1, 2, 1, 1, 1, 1, 2] = value
        K_λ[2, 1, 2, 1, 2, 1, 1, 2] = value
        K_λ[2, 1, 2, 2, 2, 1, 1, 1] = value
        K_λ[2, 1, 2, 2, 2, 2, 1, 1] = value
        K_λ[2, 2, 1, 1, 1, 1, 2, 2] = value
        K_λ[2, 2, 1, 1, 2, 1, 2, 2] = value
        K_λ[2, 2, 1, 2, 1, 1, 2, 1] = value
        K_λ[2, 2, 1, 2, 1, 2, 2, 1] = value
        K_λ[2, 2, 2, 1, 1, 1, 1, 2] = value
        K_λ[2, 2, 2, 1, 2, 1, 1, 2] = value
        K_λ[2, 2, 2, 2, 1, 1, 1, 1] = value
        K_λ[2, 2, 2, 2, 1, 2, 1, 1] = value

        value = h[3] / 24
        K_λ[1, 1, 1, 1, 1, 1, 2, 2] = value
        K_λ[1, 1, 1, 1, 2, 1, 2, 2] = value
        K_λ[1, 1, 1, 2, 1, 1, 2, 1] = value
        K_λ[1, 1, 1, 2, 1, 2, 2, 1] = value
        K_λ[1, 1, 2, 1, 1, 1, 1, 2] = value
        K_λ[1, 1, 2, 1, 2, 1, 1, 2] = value
        K_λ[1, 1, 2, 2, 1, 1, 1, 1] = value
        K_λ[1, 1, 2, 2, 1, 2, 1, 1] = value
        K_λ[1, 2, 1, 1, 1, 1, 2, 2] = value
        K_λ[1, 2, 1, 1, 2, 1, 2, 2] = value
        K_λ[1, 2, 1, 2, 2, 1, 2, 1] = value
        K_λ[1, 2, 1, 2, 2, 2, 2, 1] = value
        K_λ[1, 2, 2, 1, 1, 1, 1, 2] = value
        K_λ[1, 2, 2, 1, 2, 1, 1, 2] = value
        K_λ[1, 2, 2, 2, 2, 1, 1, 1] = value
        K_λ[1, 2, 2, 2, 2, 2, 1, 1] = value
        K_λ[2, 1, 1, 1, 1, 2, 2, 2] = value
        K_λ[2, 1, 1, 1, 2, 2, 2, 2] = value
        K_λ[2, 1, 1, 2, 1, 1, 2, 1] = value
        K_λ[2, 1, 1, 2, 1, 2, 2, 1] = value
        K_λ[2, 1, 2, 1, 1, 2, 1, 2] = value
        K_λ[2, 1, 2, 1, 2, 2, 1, 2] = value
        K_λ[2, 1, 2, 2, 1, 1, 1, 1] = value
        K_λ[2, 1, 2, 2, 1, 2, 1, 1] = value
        K_λ[2, 2, 1, 1, 1, 2, 2, 2] = value
        K_λ[2, 2, 1, 1, 2, 2, 2, 2] = value
        K_λ[2, 2, 1, 2, 2, 1, 2, 1] = value
        K_λ[2, 2, 1, 2, 2, 2, 2, 1] = value
        K_λ[2, 2, 2, 1, 1, 2, 1, 2] = value
        K_λ[2, 2, 2, 1, 2, 2, 1, 2] = value
        K_λ[2, 2, 2, 2, 2, 1, 1, 1] = value
        K_λ[2, 2, 2, 2, 2, 2, 1, 1] = value

        value = h[3] / 12
        K_λ[1, 1, 1, 1, 1, 1, 1, 2] = value
        K_λ[1, 1, 1, 1, 2, 1, 1, 2] = value
        K_λ[1, 1, 1, 2, 1, 1, 1, 1] = value
        K_λ[1, 1, 1, 2, 1, 2, 1, 1] = value
        K_λ[1, 1, 2, 1, 1, 1, 2, 2] = value
        K_λ[1, 1, 2, 1, 2, 1, 2, 2] = value
        K_λ[1, 1, 2, 2, 1, 1, 2, 1] = value
        K_λ[1, 1, 2, 2, 1, 2, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 1, 1, 2] = value
        K_λ[1, 2, 1, 1, 2, 1, 1, 2] = value
        K_λ[1, 2, 1, 2, 2, 1, 1, 1] = value
        K_λ[1, 2, 1, 2, 2, 2, 1, 1] = value
        K_λ[1, 2, 2, 1, 1, 1, 2, 2] = value
        K_λ[1, 2, 2, 1, 2, 1, 2, 2] = value
        K_λ[1, 2, 2, 2, 2, 1, 2, 1] = value
        K_λ[1, 2, 2, 2, 2, 2, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 2, 1, 2] = value
        K_λ[2, 1, 1, 1, 2, 2, 1, 2] = value
        K_λ[2, 1, 1, 2, 1, 1, 1, 1] = value
        K_λ[2, 1, 1, 2, 1, 2, 1, 1] = value
        K_λ[2, 1, 2, 1, 1, 2, 2, 2] = value
        K_λ[2, 1, 2, 1, 2, 2, 2, 2] = value
        K_λ[2, 1, 2, 2, 1, 1, 2, 1] = value
        K_λ[2, 1, 2, 2, 1, 2, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 2, 1, 2] = value
        K_λ[2, 2, 1, 1, 2, 2, 1, 2] = value
        K_λ[2, 2, 1, 2, 2, 1, 1, 1] = value
        K_λ[2, 2, 1, 2, 2, 2, 1, 1] = value
        K_λ[2, 2, 2, 1, 1, 2, 2, 2] = value
        K_λ[2, 2, 2, 1, 2, 2, 2, 2] = value
        K_λ[2, 2, 2, 2, 2, 1, 2, 1] = value
        K_λ[2, 2, 2, 2, 2, 2, 2, 1] = value

        value = -(h[1] * h[3]) / (9 * h[2])
        K_λ[1, 1, 1, 2, 1, 2, 1, 2] = value
        K_λ[1, 1, 2, 2, 1, 2, 2, 2] = value
        K_λ[1, 2, 1, 2, 1, 1, 1, 2] = value
        K_λ[1, 2, 2, 2, 1, 1, 2, 2] = value
        K_λ[2, 1, 1, 2, 2, 2, 1, 2] = value
        K_λ[2, 1, 2, 2, 2, 2, 2, 2] = value
        K_λ[2, 2, 1, 2, 2, 1, 1, 2] = value
        K_λ[2, 2, 2, 2, 2, 1, 2, 2] = value

        value = -(h[1] * h[3]) / (18 * h[2])
        K_λ[1, 1, 1, 2, 1, 2, 2, 2] = value
        K_λ[1, 1, 1, 2, 2, 2, 1, 2] = value
        K_λ[1, 1, 2, 2, 1, 2, 1, 2] = value
        K_λ[1, 1, 2, 2, 2, 2, 2, 2] = value
        K_λ[1, 2, 1, 2, 1, 1, 2, 2] = value
        K_λ[1, 2, 1, 2, 2, 1, 1, 2] = value
        K_λ[1, 2, 2, 2, 1, 1, 1, 2] = value
        K_λ[1, 2, 2, 2, 2, 1, 2, 2] = value
        K_λ[2, 1, 1, 2, 1, 2, 1, 2] = value
        K_λ[2, 1, 1, 2, 2, 2, 2, 2] = value
        K_λ[2, 1, 2, 2, 1, 2, 2, 2] = value
        K_λ[2, 1, 2, 2, 2, 2, 1, 2] = value
        K_λ[2, 2, 1, 2, 1, 1, 1, 2] = value
        K_λ[2, 2, 1, 2, 2, 1, 2, 2] = value
        K_λ[2, 2, 2, 2, 1, 1, 2, 2] = value
        K_λ[2, 2, 2, 2, 2, 1, 1, 2] = value

        value = -(h[1] * h[3]) / (36 * h[2])
        K_λ[1, 1, 1, 2, 2, 2, 2, 2] = value
        K_λ[1, 1, 2, 2, 2, 2, 1, 2] = value
        K_λ[1, 2, 1, 2, 2, 1, 2, 2] = value
        K_λ[1, 2, 2, 2, 2, 1, 1, 2] = value
        K_λ[2, 1, 1, 2, 1, 2, 2, 2] = value
        K_λ[2, 1, 2, 2, 1, 2, 1, 2] = value
        K_λ[2, 2, 1, 2, 1, 1, 2, 2] = value
        K_λ[2, 2, 2, 2, 1, 1, 1, 2] = value

        value = (h[1] * h[3]) / (36 * h[2])
        K_λ[1, 1, 1, 2, 2, 1, 2, 2] = value
        K_λ[1, 1, 2, 2, 2, 1, 1, 2] = value
        K_λ[1, 2, 1, 2, 2, 2, 2, 2] = value
        K_λ[1, 2, 2, 2, 2, 2, 1, 2] = value
        K_λ[2, 1, 1, 2, 1, 1, 2, 2] = value
        K_λ[2, 1, 2, 2, 1, 1, 1, 2] = value
        K_λ[2, 2, 1, 2, 1, 2, 2, 2] = value
        K_λ[2, 2, 2, 2, 1, 2, 1, 2] = value

        value = (h[1] * h[3]) / (18 * h[2])
        K_λ[1, 1, 1, 2, 1, 1, 2, 2] = value
        K_λ[1, 1, 1, 2, 2, 1, 1, 2] = value
        K_λ[1, 1, 2, 2, 1, 1, 1, 2] = value
        K_λ[1, 1, 2, 2, 2, 1, 2, 2] = value
        K_λ[1, 2, 1, 2, 1, 2, 2, 2] = value
        K_λ[1, 2, 1, 2, 2, 2, 1, 2] = value
        K_λ[1, 2, 2, 2, 1, 2, 1, 2] = value
        K_λ[1, 2, 2, 2, 2, 2, 2, 2] = value
        K_λ[2, 1, 1, 2, 1, 1, 1, 2] = value
        K_λ[2, 1, 1, 2, 2, 1, 2, 2] = value
        K_λ[2, 1, 2, 2, 1, 1, 2, 2] = value
        K_λ[2, 1, 2, 2, 2, 1, 1, 2] = value
        K_λ[2, 2, 1, 2, 1, 2, 1, 2] = value
        K_λ[2, 2, 1, 2, 2, 2, 2, 2] = value
        K_λ[2, 2, 2, 2, 1, 2, 2, 2] = value
        K_λ[2, 2, 2, 2, 2, 2, 1, 2] = value

        value = (h[1] * h[3]) / (9 * h[2])
        K_λ[1, 1, 1, 2, 1, 1, 1, 2] = value
        K_λ[1, 1, 2, 2, 1, 1, 2, 2] = value
        K_λ[1, 2, 1, 2, 1, 2, 1, 2] = value
        K_λ[1, 2, 2, 2, 1, 2, 2, 2] = value
        K_λ[2, 1, 1, 2, 2, 1, 1, 2] = value
        K_λ[2, 1, 2, 2, 2, 1, 2, 2] = value
        K_λ[2, 2, 1, 2, 2, 2, 1, 2] = value
        K_λ[2, 2, 2, 2, 2, 2, 2, 2] = value

        value = -(h[2] * h[3]) / (9 * h[1])
        K_λ[1, 1, 1, 1, 2, 1, 1, 1] = value
        K_λ[1, 1, 2, 1, 2, 1, 2, 1] = value
        K_λ[1, 2, 1, 1, 2, 2, 1, 1] = value
        K_λ[1, 2, 2, 1, 2, 2, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 1, 1, 1] = value
        K_λ[2, 1, 2, 1, 1, 1, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 2, 1, 1] = value
        K_λ[2, 2, 2, 1, 1, 2, 2, 1] = value

        value = -(h[2] * h[3]) / (18 * h[1])
        K_λ[1, 1, 1, 1, 2, 1, 2, 1] = value
        K_λ[1, 1, 1, 1, 2, 2, 1, 1] = value
        K_λ[1, 1, 2, 1, 2, 1, 1, 1] = value
        K_λ[1, 1, 2, 1, 2, 2, 2, 1] = value
        K_λ[1, 2, 1, 1, 2, 1, 1, 1] = value
        K_λ[1, 2, 1, 1, 2, 2, 2, 1] = value
        K_λ[1, 2, 2, 1, 2, 1, 2, 1] = value
        K_λ[1, 2, 2, 1, 2, 2, 1, 1] = value
        K_λ[2, 1, 1, 1, 1, 1, 2, 1] = value
        K_λ[2, 1, 1, 1, 1, 2, 1, 1] = value
        K_λ[2, 1, 2, 1, 1, 1, 1, 1] = value
        K_λ[2, 1, 2, 1, 1, 2, 2, 1] = value
        K_λ[2, 2, 1, 1, 1, 1, 1, 1] = value
        K_λ[2, 2, 1, 1, 1, 2, 2, 1] = value
        K_λ[2, 2, 2, 1, 1, 1, 2, 1] = value
        K_λ[2, 2, 2, 1, 1, 2, 1, 1] = value

        value = -(h[2] * h[3]) / (36 * h[1])
        K_λ[1, 1, 1, 1, 2, 2, 2, 1] = value
        K_λ[1, 1, 2, 1, 2, 2, 1, 1] = value
        K_λ[1, 2, 1, 1, 2, 1, 2, 1] = value
        K_λ[1, 2, 2, 1, 2, 1, 1, 1] = value
        K_λ[2, 1, 1, 1, 1, 2, 2, 1] = value
        K_λ[2, 1, 2, 1, 1, 2, 1, 1] = value
        K_λ[2, 2, 1, 1, 1, 1, 2, 1] = value
        K_λ[2, 2, 2, 1, 1, 1, 1, 1] = value

        value = (h[2] * h[3]) / (36 * h[1])
        K_λ[1, 1, 1, 1, 1, 2, 2, 1] = value
        K_λ[1, 1, 2, 1, 1, 2, 1, 1] = value
        K_λ[1, 2, 1, 1, 1, 1, 2, 1] = value
        K_λ[1, 2, 2, 1, 1, 1, 1, 1] = value
        K_λ[2, 1, 1, 1, 2, 2, 2, 1] = value
        K_λ[2, 1, 2, 1, 2, 2, 1, 1] = value
        K_λ[2, 2, 1, 1, 2, 1, 2, 1] = value
        K_λ[2, 2, 2, 1, 2, 1, 1, 1] = value

        value = (h[2] * h[3]) / (18 * h[1])
        K_λ[1, 1, 1, 1, 1, 1, 2, 1] = value
        K_λ[1, 1, 1, 1, 1, 2, 1, 1] = value
        K_λ[1, 1, 2, 1, 1, 1, 1, 1] = value
        K_λ[1, 1, 2, 1, 1, 2, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 1, 1, 1] = value
        K_λ[1, 2, 1, 1, 1, 2, 2, 1] = value
        K_λ[1, 2, 2, 1, 1, 1, 2, 1] = value
        K_λ[1, 2, 2, 1, 1, 2, 1, 1] = value
        K_λ[2, 1, 1, 1, 2, 1, 2, 1] = value
        K_λ[2, 1, 1, 1, 2, 2, 1, 1] = value
        K_λ[2, 1, 2, 1, 2, 1, 1, 1] = value
        K_λ[2, 1, 2, 1, 2, 2, 2, 1] = value
        K_λ[2, 2, 1, 1, 2, 1, 1, 1] = value
        K_λ[2, 2, 1, 1, 2, 2, 2, 1] = value
        K_λ[2, 2, 2, 1, 2, 1, 2, 1] = value
        K_λ[2, 2, 2, 1, 2, 2, 1, 1] = value

        value = (h[2] * h[3]) / (9 * h[1])
        K_λ[1, 1, 1, 1, 1, 1, 1, 1] = value
        K_λ[1, 1, 2, 1, 1, 1, 2, 1] = value
        K_λ[1, 2, 1, 1, 1, 2, 1, 1] = value
        K_λ[1, 2, 2, 1, 1, 2, 2, 1] = value
        K_λ[2, 1, 1, 1, 2, 1, 1, 1] = value
        K_λ[2, 1, 2, 1, 2, 1, 2, 1] = value
        K_λ[2, 2, 1, 1, 2, 2, 1, 1] = value
        K_λ[2, 2, 2, 1, 2, 2, 2, 1] = value
    else
    end
    return K_λ
end

function expected_K_μ(h::AbstractVector{T}) where {T<:Number}
    d = size(h, 1)
    K_μ = zeros(Float64, fill(2, d)..., d, fill(2, d)..., d)
    if d == 2
        value = -1 / 4
        K_μ[1, 1, 1, 2, 1, 2] = value
        K_μ[1, 1, 1, 2, 2, 2] = value
        K_μ[1, 1, 2, 1, 2, 1] = value
        K_μ[1, 1, 2, 2, 2, 1] = value
        K_μ[1, 2, 1, 1, 1, 2] = value
        K_μ[1, 2, 1, 1, 2, 2] = value
        K_μ[1, 2, 2, 1, 2, 1] = value
        K_μ[1, 2, 2, 2, 2, 1] = value
        K_μ[2, 1, 1, 2, 1, 2] = value
        K_μ[2, 1, 1, 2, 2, 2] = value
        K_μ[2, 1, 2, 1, 1, 1] = value
        K_μ[2, 1, 2, 2, 1, 1] = value
        K_μ[2, 2, 1, 1, 1, 2] = value
        K_μ[2, 2, 1, 1, 2, 2] = value
        K_μ[2, 2, 2, 1, 1, 1] = value
        K_μ[2, 2, 2, 2, 1, 1] = value

        value = 1 / 4
        K_μ[1, 1, 1, 1, 1, 2] = value
        K_μ[1, 1, 1, 1, 2, 2] = value
        K_μ[1, 1, 2, 1, 1, 1] = value
        K_μ[1, 1, 2, 2, 1, 1] = value
        K_μ[1, 2, 1, 2, 1, 2] = value
        K_μ[1, 2, 1, 2, 2, 2] = value
        K_μ[1, 2, 2, 1, 1, 1] = value
        K_μ[1, 2, 2, 2, 1, 1] = value
        K_μ[2, 1, 1, 1, 1, 2] = value
        K_μ[2, 1, 1, 1, 2, 2] = value
        K_μ[2, 1, 2, 1, 2, 1] = value
        K_μ[2, 1, 2, 2, 2, 1] = value
        K_μ[2, 2, 1, 2, 1, 2] = value
        K_μ[2, 2, 1, 2, 2, 2] = value
        K_μ[2, 2, 2, 1, 2, 1] = value
        K_μ[2, 2, 2, 2, 2, 1] = value

        value = h[1] / (6 * h[2]) - (2 * h[2]) / (3 * h[1])
        K_μ[1, 1, 1, 2, 1, 1] = value
        K_μ[1, 2, 1, 2, 2, 1] = value
        K_μ[2, 1, 1, 1, 1, 1] = value
        K_μ[2, 2, 1, 1, 2, 1] = value

        value = (-h[2] / (3 * h[1])) - h[1] / (6 * h[2])
        K_μ[1, 1, 1, 2, 2, 1] = value
        K_μ[1, 2, 1, 2, 1, 1] = value
        K_μ[2, 1, 1, 1, 2, 1] = value
        K_μ[2, 2, 1, 1, 1, 1] = value

        value = h[1] / (3 * h[2]) - h[2] / (3 * h[1])
        K_μ[1, 1, 2, 2, 1, 2] = value
        K_μ[1, 2, 2, 2, 2, 2] = value
        K_μ[2, 1, 2, 1, 1, 2] = value
        K_μ[2, 2, 2, 1, 2, 2] = value

        value = (-h[2] / (6 * h[1])) - h[1] / (3 * h[2])
        K_μ[1, 1, 2, 2, 2, 2] = value
        K_μ[1, 2, 2, 2, 1, 2] = value
        K_μ[2, 1, 2, 1, 2, 2] = value
        K_μ[2, 2, 2, 1, 1, 2] = value

        value = h[2] / (6 * h[1]) - (2 * h[1]) / (3 * h[2])
        K_μ[1, 1, 2, 1, 2, 2] = value
        K_μ[1, 2, 2, 1, 1, 2] = value
        K_μ[2, 1, 2, 2, 2, 2] = value
        K_μ[2, 2, 2, 2, 1, 2] = value

        value = h[2] / (3 * h[1]) - h[1] / (3 * h[2])
        K_μ[1, 1, 1, 1, 2, 1] = value
        K_μ[1, 2, 1, 1, 1, 1] = value
        K_μ[2, 1, 1, 2, 2, 1] = value
        K_μ[2, 2, 1, 2, 1, 1] = value

        value = h[2] / (3 * h[1]) + (2 * h[1]) / (3 * h[2])
        K_μ[1, 1, 2, 1, 1, 2] = value
        K_μ[1, 2, 2, 1, 2, 2] = value
        K_μ[2, 1, 2, 2, 1, 2] = value
        K_μ[2, 2, 2, 2, 2, 2] = value

        value = (2 * h[2]) / (3 * h[1]) + h[1] / (3 * h[2])
        K_μ[1, 1, 1, 1, 1, 1] = value
        K_μ[1, 2, 1, 1, 2, 1] = value
        K_μ[2, 1, 1, 2, 1, 1] = value
        K_μ[2, 2, 1, 2, 2, 1] = value
    elseif d == 3
        value = -h[1] / 12
        K_μ[1, 1, 1, 2, 1, 2, 1, 3] = value
        K_μ[1, 1, 1, 2, 1, 2, 2, 3] = value
        K_μ[1, 1, 1, 3, 1, 1, 2, 2] = value
        K_μ[1, 1, 1, 3, 1, 2, 2, 2] = value
        K_μ[1, 1, 2, 2, 1, 1, 1, 3] = value
        K_μ[1, 1, 2, 2, 1, 1, 2, 3] = value
        K_μ[1, 1, 2, 3, 1, 1, 2, 2] = value
        K_μ[1, 1, 2, 3, 1, 2, 2, 2] = value
        K_μ[1, 2, 1, 2, 1, 2, 1, 3] = value
        K_μ[1, 2, 1, 2, 1, 2, 2, 3] = value
        K_μ[1, 2, 1, 3, 1, 1, 1, 2] = value
        K_μ[1, 2, 1, 3, 1, 2, 1, 2] = value
        K_μ[1, 2, 2, 2, 1, 1, 1, 3] = value
        K_μ[1, 2, 2, 2, 1, 1, 2, 3] = value
        K_μ[1, 2, 2, 3, 1, 1, 1, 2] = value
        K_μ[1, 2, 2, 3, 1, 2, 1, 2] = value
        K_μ[2, 1, 1, 2, 2, 2, 1, 3] = value
        K_μ[2, 1, 1, 2, 2, 2, 2, 3] = value
        K_μ[2, 1, 1, 3, 2, 1, 2, 2] = value
        K_μ[2, 1, 1, 3, 2, 2, 2, 2] = value
        K_μ[2, 1, 2, 2, 2, 1, 1, 3] = value
        K_μ[2, 1, 2, 2, 2, 1, 2, 3] = value
        K_μ[2, 1, 2, 3, 2, 1, 2, 2] = value
        K_μ[2, 1, 2, 3, 2, 2, 2, 2] = value
        K_μ[2, 2, 1, 2, 2, 2, 1, 3] = value
        K_μ[2, 2, 1, 2, 2, 2, 2, 3] = value
        K_μ[2, 2, 1, 3, 2, 1, 1, 2] = value
        K_μ[2, 2, 1, 3, 2, 2, 1, 2] = value
        K_μ[2, 2, 2, 2, 2, 1, 1, 3] = value
        K_μ[2, 2, 2, 2, 2, 1, 2, 3] = value
        K_μ[2, 2, 2, 3, 2, 1, 1, 2] = value
        K_μ[2, 2, 2, 3, 2, 2, 1, 2] = value

        value = -h[1] / 24
        K_μ[1, 1, 1, 2, 2, 2, 1, 3] = value
        K_μ[1, 1, 1, 2, 2, 2, 2, 3] = value
        K_μ[1, 1, 1, 3, 2, 1, 2, 2] = value
        K_μ[1, 1, 1, 3, 2, 2, 2, 2] = value
        K_μ[1, 1, 2, 2, 2, 1, 1, 3] = value
        K_μ[1, 1, 2, 2, 2, 1, 2, 3] = value
        K_μ[1, 1, 2, 3, 2, 1, 2, 2] = value
        K_μ[1, 1, 2, 3, 2, 2, 2, 2] = value
        K_μ[1, 2, 1, 2, 2, 2, 1, 3] = value
        K_μ[1, 2, 1, 2, 2, 2, 2, 3] = value
        K_μ[1, 2, 1, 3, 2, 1, 1, 2] = value
        K_μ[1, 2, 1, 3, 2, 2, 1, 2] = value
        K_μ[1, 2, 2, 2, 2, 1, 1, 3] = value
        K_μ[1, 2, 2, 2, 2, 1, 2, 3] = value
        K_μ[1, 2, 2, 3, 2, 1, 1, 2] = value
        K_μ[1, 2, 2, 3, 2, 2, 1, 2] = value
        K_μ[2, 1, 1, 2, 1, 2, 1, 3] = value
        K_μ[2, 1, 1, 2, 1, 2, 2, 3] = value
        K_μ[2, 1, 1, 3, 1, 1, 2, 2] = value
        K_μ[2, 1, 1, 3, 1, 2, 2, 2] = value
        K_μ[2, 1, 2, 2, 1, 1, 1, 3] = value
        K_μ[2, 1, 2, 2, 1, 1, 2, 3] = value
        K_μ[2, 1, 2, 3, 1, 1, 2, 2] = value
        K_μ[2, 1, 2, 3, 1, 2, 2, 2] = value
        K_μ[2, 2, 1, 2, 1, 2, 1, 3] = value
        K_μ[2, 2, 1, 2, 1, 2, 2, 3] = value
        K_μ[2, 2, 1, 3, 1, 1, 1, 2] = value
        K_μ[2, 2, 1, 3, 1, 2, 1, 2] = value
        K_μ[2, 2, 2, 2, 1, 1, 1, 3] = value
        K_μ[2, 2, 2, 2, 1, 1, 2, 3] = value
        K_μ[2, 2, 2, 3, 1, 1, 1, 2] = value
        K_μ[2, 2, 2, 3, 1, 2, 1, 2] = value

        value = h[1] / 24
        K_μ[1, 1, 1, 2, 2, 1, 1, 3] = value
        K_μ[1, 1, 1, 2, 2, 1, 2, 3] = value
        K_μ[1, 1, 1, 3, 2, 1, 1, 2] = value
        K_μ[1, 1, 1, 3, 2, 2, 1, 2] = value
        K_μ[1, 1, 2, 2, 2, 2, 1, 3] = value
        K_μ[1, 1, 2, 2, 2, 2, 2, 3] = value
        K_μ[1, 1, 2, 3, 2, 1, 1, 2] = value
        K_μ[1, 1, 2, 3, 2, 2, 1, 2] = value
        K_μ[1, 2, 1, 2, 2, 1, 1, 3] = value
        K_μ[1, 2, 1, 2, 2, 1, 2, 3] = value
        K_μ[1, 2, 1, 3, 2, 1, 2, 2] = value
        K_μ[1, 2, 1, 3, 2, 2, 2, 2] = value
        K_μ[1, 2, 2, 2, 2, 2, 1, 3] = value
        K_μ[1, 2, 2, 2, 2, 2, 2, 3] = value
        K_μ[1, 2, 2, 3, 2, 1, 2, 2] = value
        K_μ[1, 2, 2, 3, 2, 2, 2, 2] = value
        K_μ[2, 1, 1, 2, 1, 1, 1, 3] = value
        K_μ[2, 1, 1, 2, 1, 1, 2, 3] = value
        K_μ[2, 1, 1, 3, 1, 1, 1, 2] = value
        K_μ[2, 1, 1, 3, 1, 2, 1, 2] = value
        K_μ[2, 1, 2, 2, 1, 2, 1, 3] = value
        K_μ[2, 1, 2, 2, 1, 2, 2, 3] = value
        K_μ[2, 1, 2, 3, 1, 1, 1, 2] = value
        K_μ[2, 1, 2, 3, 1, 2, 1, 2] = value
        K_μ[2, 2, 1, 2, 1, 1, 1, 3] = value
        K_μ[2, 2, 1, 2, 1, 1, 2, 3] = value
        K_μ[2, 2, 1, 3, 1, 1, 2, 2] = value
        K_μ[2, 2, 1, 3, 1, 2, 2, 2] = value
        K_μ[2, 2, 2, 2, 1, 2, 1, 3] = value
        K_μ[2, 2, 2, 2, 1, 2, 2, 3] = value
        K_μ[2, 2, 2, 3, 1, 1, 2, 2] = value
        K_μ[2, 2, 2, 3, 1, 2, 2, 2] = value

        value = h[1] / 12
        K_μ[1, 1, 1, 2, 1, 1, 1, 3] = value
        K_μ[1, 1, 1, 2, 1, 1, 2, 3] = value
        K_μ[1, 1, 1, 3, 1, 1, 1, 2] = value
        K_μ[1, 1, 1, 3, 1, 2, 1, 2] = value
        K_μ[1, 1, 2, 2, 1, 2, 1, 3] = value
        K_μ[1, 1, 2, 2, 1, 2, 2, 3] = value
        K_μ[1, 1, 2, 3, 1, 1, 1, 2] = value
        K_μ[1, 1, 2, 3, 1, 2, 1, 2] = value
        K_μ[1, 2, 1, 2, 1, 1, 1, 3] = value
        K_μ[1, 2, 1, 2, 1, 1, 2, 3] = value
        K_μ[1, 2, 1, 3, 1, 1, 2, 2] = value
        K_μ[1, 2, 1, 3, 1, 2, 2, 2] = value
        K_μ[1, 2, 2, 2, 1, 2, 1, 3] = value
        K_μ[1, 2, 2, 2, 1, 2, 2, 3] = value
        K_μ[1, 2, 2, 3, 1, 1, 2, 2] = value
        K_μ[1, 2, 2, 3, 1, 2, 2, 2] = value
        K_μ[2, 1, 1, 2, 2, 1, 1, 3] = value
        K_μ[2, 1, 1, 2, 2, 1, 2, 3] = value
        K_μ[2, 1, 1, 3, 2, 1, 1, 2] = value
        K_μ[2, 1, 1, 3, 2, 2, 1, 2] = value
        K_μ[2, 1, 2, 2, 2, 2, 1, 3] = value
        K_μ[2, 1, 2, 2, 2, 2, 2, 3] = value
        K_μ[2, 1, 2, 3, 2, 1, 1, 2] = value
        K_μ[2, 1, 2, 3, 2, 2, 1, 2] = value
        K_μ[2, 2, 1, 2, 2, 1, 1, 3] = value
        K_μ[2, 2, 1, 2, 2, 1, 2, 3] = value
        K_μ[2, 2, 1, 3, 2, 1, 2, 2] = value
        K_μ[2, 2, 1, 3, 2, 2, 2, 2] = value
        K_μ[2, 2, 2, 2, 2, 2, 1, 3] = value
        K_μ[2, 2, 2, 2, 2, 2, 2, 3] = value
        K_μ[2, 2, 2, 3, 2, 1, 2, 2] = value
        K_μ[2, 2, 2, 3, 2, 2, 2, 2] = value

        value = -h[2] / 12
        K_μ[1, 1, 1, 1, 2, 1, 1, 3] = value
        K_μ[1, 1, 1, 1, 2, 1, 2, 3] = value
        K_μ[1, 1, 1, 3, 1, 1, 2, 1] = value
        K_μ[1, 1, 1, 3, 2, 1, 2, 1] = value
        K_μ[1, 1, 2, 1, 1, 1, 1, 3] = value
        K_μ[1, 1, 2, 1, 1, 1, 2, 3] = value
        K_μ[1, 1, 2, 3, 1, 1, 2, 1] = value
        K_μ[1, 1, 2, 3, 2, 1, 2, 1] = value
        K_μ[1, 2, 1, 1, 2, 2, 1, 3] = value
        K_μ[1, 2, 1, 1, 2, 2, 2, 3] = value
        K_μ[1, 2, 1, 3, 1, 2, 2, 1] = value
        K_μ[1, 2, 1, 3, 2, 2, 2, 1] = value
        K_μ[1, 2, 2, 1, 1, 2, 1, 3] = value
        K_μ[1, 2, 2, 1, 1, 2, 2, 3] = value
        K_μ[1, 2, 2, 3, 1, 2, 2, 1] = value
        K_μ[1, 2, 2, 3, 2, 2, 2, 1] = value
        K_μ[2, 1, 1, 1, 2, 1, 1, 3] = value
        K_μ[2, 1, 1, 1, 2, 1, 2, 3] = value
        K_μ[2, 1, 1, 3, 1, 1, 1, 1] = value
        K_μ[2, 1, 1, 3, 2, 1, 1, 1] = value
        K_μ[2, 1, 2, 1, 1, 1, 1, 3] = value
        K_μ[2, 1, 2, 1, 1, 1, 2, 3] = value
        K_μ[2, 1, 2, 3, 1, 1, 1, 1] = value
        K_μ[2, 1, 2, 3, 2, 1, 1, 1] = value
        K_μ[2, 2, 1, 1, 2, 2, 1, 3] = value
        K_μ[2, 2, 1, 1, 2, 2, 2, 3] = value
        K_μ[2, 2, 1, 3, 1, 2, 1, 1] = value
        K_μ[2, 2, 1, 3, 2, 2, 1, 1] = value
        K_μ[2, 2, 2, 1, 1, 2, 1, 3] = value
        K_μ[2, 2, 2, 1, 1, 2, 2, 3] = value
        K_μ[2, 2, 2, 3, 1, 2, 1, 1] = value
        K_μ[2, 2, 2, 3, 2, 2, 1, 1] = value

        value = -h[2] / 24
        K_μ[1, 1, 1, 1, 2, 2, 1, 3] = value
        K_μ[1, 1, 1, 1, 2, 2, 2, 3] = value
        K_μ[1, 1, 1, 3, 1, 2, 2, 1] = value
        K_μ[1, 1, 1, 3, 2, 2, 2, 1] = value
        K_μ[1, 1, 2, 1, 1, 2, 1, 3] = value
        K_μ[1, 1, 2, 1, 1, 2, 2, 3] = value
        K_μ[1, 1, 2, 3, 1, 2, 2, 1] = value
        K_μ[1, 1, 2, 3, 2, 2, 2, 1] = value
        K_μ[1, 2, 1, 1, 2, 1, 1, 3] = value
        K_μ[1, 2, 1, 1, 2, 1, 2, 3] = value
        K_μ[1, 2, 1, 3, 1, 1, 2, 1] = value
        K_μ[1, 2, 1, 3, 2, 1, 2, 1] = value
        K_μ[1, 2, 2, 1, 1, 1, 1, 3] = value
        K_μ[1, 2, 2, 1, 1, 1, 2, 3] = value
        K_μ[1, 2, 2, 3, 1, 1, 2, 1] = value
        K_μ[1, 2, 2, 3, 2, 1, 2, 1] = value
        K_μ[2, 1, 1, 1, 2, 2, 1, 3] = value
        K_μ[2, 1, 1, 1, 2, 2, 2, 3] = value
        K_μ[2, 1, 1, 3, 1, 2, 1, 1] = value
        K_μ[2, 1, 1, 3, 2, 2, 1, 1] = value
        K_μ[2, 1, 2, 1, 1, 2, 1, 3] = value
        K_μ[2, 1, 2, 1, 1, 2, 2, 3] = value
        K_μ[2, 1, 2, 3, 1, 2, 1, 1] = value
        K_μ[2, 1, 2, 3, 2, 2, 1, 1] = value
        K_μ[2, 2, 1, 1, 2, 1, 1, 3] = value
        K_μ[2, 2, 1, 1, 2, 1, 2, 3] = value
        K_μ[2, 2, 1, 3, 1, 1, 1, 1] = value
        K_μ[2, 2, 1, 3, 2, 1, 1, 1] = value
        K_μ[2, 2, 2, 1, 1, 1, 1, 3] = value
        K_μ[2, 2, 2, 1, 1, 1, 2, 3] = value
        K_μ[2, 2, 2, 3, 1, 1, 1, 1] = value
        K_μ[2, 2, 2, 3, 2, 1, 1, 1] = value

        value = h[2] / 24
        K_μ[1, 1, 1, 1, 1, 2, 1, 3] = value
        K_μ[1, 1, 1, 1, 1, 2, 2, 3] = value
        K_μ[1, 1, 1, 3, 1, 2, 1, 1] = value
        K_μ[1, 1, 1, 3, 2, 2, 1, 1] = value
        K_μ[1, 1, 2, 1, 2, 2, 1, 3] = value
        K_μ[1, 1, 2, 1, 2, 2, 2, 3] = value
        K_μ[1, 1, 2, 3, 1, 2, 1, 1] = value
        K_μ[1, 1, 2, 3, 2, 2, 1, 1] = value
        K_μ[1, 2, 1, 1, 1, 1, 1, 3] = value
        K_μ[1, 2, 1, 1, 1, 1, 2, 3] = value
        K_μ[1, 2, 1, 3, 1, 1, 1, 1] = value
        K_μ[1, 2, 1, 3, 2, 1, 1, 1] = value
        K_μ[1, 2, 2, 1, 2, 1, 1, 3] = value
        K_μ[1, 2, 2, 1, 2, 1, 2, 3] = value
        K_μ[1, 2, 2, 3, 1, 1, 1, 1] = value
        K_μ[1, 2, 2, 3, 2, 1, 1, 1] = value
        K_μ[2, 1, 1, 1, 1, 2, 1, 3] = value
        K_μ[2, 1, 1, 1, 1, 2, 2, 3] = value
        K_μ[2, 1, 1, 3, 1, 2, 2, 1] = value
        K_μ[2, 1, 1, 3, 2, 2, 2, 1] = value
        K_μ[2, 1, 2, 1, 2, 2, 1, 3] = value
        K_μ[2, 1, 2, 1, 2, 2, 2, 3] = value
        K_μ[2, 1, 2, 3, 1, 2, 2, 1] = value
        K_μ[2, 1, 2, 3, 2, 2, 2, 1] = value
        K_μ[2, 2, 1, 1, 1, 1, 1, 3] = value
        K_μ[2, 2, 1, 1, 1, 1, 2, 3] = value
        K_μ[2, 2, 1, 3, 1, 1, 2, 1] = value
        K_μ[2, 2, 1, 3, 2, 1, 2, 1] = value
        K_μ[2, 2, 2, 1, 2, 1, 1, 3] = value
        K_μ[2, 2, 2, 1, 2, 1, 2, 3] = value
        K_μ[2, 2, 2, 3, 1, 1, 2, 1] = value
        K_μ[2, 2, 2, 3, 2, 1, 2, 1] = value

        value = h[2] / 12
        K_μ[1, 1, 1, 1, 1, 1, 1, 3] = value
        K_μ[1, 1, 1, 1, 1, 1, 2, 3] = value
        K_μ[1, 1, 1, 3, 1, 1, 1, 1] = value
        K_μ[1, 1, 1, 3, 2, 1, 1, 1] = value
        K_μ[1, 1, 2, 1, 2, 1, 1, 3] = value
        K_μ[1, 1, 2, 1, 2, 1, 2, 3] = value
        K_μ[1, 1, 2, 3, 1, 1, 1, 1] = value
        K_μ[1, 1, 2, 3, 2, 1, 1, 1] = value
        K_μ[1, 2, 1, 1, 1, 2, 1, 3] = value
        K_μ[1, 2, 1, 1, 1, 2, 2, 3] = value
        K_μ[1, 2, 1, 3, 1, 2, 1, 1] = value
        K_μ[1, 2, 1, 3, 2, 2, 1, 1] = value
        K_μ[1, 2, 2, 1, 2, 2, 1, 3] = value
        K_μ[1, 2, 2, 1, 2, 2, 2, 3] = value
        K_μ[1, 2, 2, 3, 1, 2, 1, 1] = value
        K_μ[1, 2, 2, 3, 2, 2, 1, 1] = value
        K_μ[2, 1, 1, 1, 1, 1, 1, 3] = value
        K_μ[2, 1, 1, 1, 1, 1, 2, 3] = value
        K_μ[2, 1, 1, 3, 1, 1, 2, 1] = value
        K_μ[2, 1, 1, 3, 2, 1, 2, 1] = value
        K_μ[2, 1, 2, 1, 2, 1, 1, 3] = value
        K_μ[2, 1, 2, 1, 2, 1, 2, 3] = value
        K_μ[2, 1, 2, 3, 1, 1, 2, 1] = value
        K_μ[2, 1, 2, 3, 2, 1, 2, 1] = value
        K_μ[2, 2, 1, 1, 1, 2, 1, 3] = value
        K_μ[2, 2, 1, 1, 1, 2, 2, 3] = value
        K_μ[2, 2, 1, 3, 1, 2, 2, 1] = value
        K_μ[2, 2, 1, 3, 2, 2, 2, 1] = value
        K_μ[2, 2, 2, 1, 2, 2, 1, 3] = value
        K_μ[2, 2, 2, 1, 2, 2, 2, 3] = value
        K_μ[2, 2, 2, 3, 1, 2, 2, 1] = value
        K_μ[2, 2, 2, 3, 2, 2, 2, 1] = value

        value = -h[3] / 12
        K_μ[1, 1, 1, 1, 2, 1, 1, 2] = value
        K_μ[1, 1, 1, 1, 2, 2, 1, 2] = value
        K_μ[1, 1, 1, 2, 1, 2, 1, 1] = value
        K_μ[1, 1, 1, 2, 2, 2, 1, 1] = value
        K_μ[1, 1, 2, 1, 2, 1, 2, 2] = value
        K_μ[1, 1, 2, 1, 2, 2, 2, 2] = value
        K_μ[1, 1, 2, 2, 1, 2, 2, 1] = value
        K_μ[1, 1, 2, 2, 2, 2, 2, 1] = value
        K_μ[1, 2, 1, 1, 1, 1, 1, 2] = value
        K_μ[1, 2, 1, 1, 1, 2, 1, 2] = value
        K_μ[1, 2, 1, 2, 1, 2, 1, 1] = value
        K_μ[1, 2, 1, 2, 2, 2, 1, 1] = value
        K_μ[1, 2, 2, 1, 1, 1, 2, 2] = value
        K_μ[1, 2, 2, 1, 1, 2, 2, 2] = value
        K_μ[1, 2, 2, 2, 1, 2, 2, 1] = value
        K_μ[1, 2, 2, 2, 2, 2, 2, 1] = value
        K_μ[2, 1, 1, 1, 2, 1, 1, 2] = value
        K_μ[2, 1, 1, 1, 2, 2, 1, 2] = value
        K_μ[2, 1, 1, 2, 1, 1, 1, 1] = value
        K_μ[2, 1, 1, 2, 2, 1, 1, 1] = value
        K_μ[2, 1, 2, 1, 2, 1, 2, 2] = value
        K_μ[2, 1, 2, 1, 2, 2, 2, 2] = value
        K_μ[2, 1, 2, 2, 1, 1, 2, 1] = value
        K_μ[2, 1, 2, 2, 2, 1, 2, 1] = value
        K_μ[2, 2, 1, 1, 1, 1, 1, 2] = value
        K_μ[2, 2, 1, 1, 1, 2, 1, 2] = value
        K_μ[2, 2, 1, 2, 1, 1, 1, 1] = value
        K_μ[2, 2, 1, 2, 2, 1, 1, 1] = value
        K_μ[2, 2, 2, 1, 1, 1, 2, 2] = value
        K_μ[2, 2, 2, 1, 1, 2, 2, 2] = value
        K_μ[2, 2, 2, 2, 1, 1, 2, 1] = value
        K_μ[2, 2, 2, 2, 2, 1, 2, 1] = value

        value = -h[3] / 24
        K_μ[1, 1, 1, 1, 2, 1, 2, 2] = value
        K_μ[1, 1, 1, 1, 2, 2, 2, 2] = value
        K_μ[1, 1, 1, 2, 1, 2, 2, 1] = value
        K_μ[1, 1, 1, 2, 2, 2, 2, 1] = value
        K_μ[1, 1, 2, 1, 2, 1, 1, 2] = value
        K_μ[1, 1, 2, 1, 2, 2, 1, 2] = value
        K_μ[1, 1, 2, 2, 1, 2, 1, 1] = value
        K_μ[1, 1, 2, 2, 2, 2, 1, 1] = value
        K_μ[1, 2, 1, 1, 1, 1, 2, 2] = value
        K_μ[1, 2, 1, 1, 1, 2, 2, 2] = value
        K_μ[1, 2, 1, 2, 1, 2, 2, 1] = value
        K_μ[1, 2, 1, 2, 2, 2, 2, 1] = value
        K_μ[1, 2, 2, 1, 1, 1, 1, 2] = value
        K_μ[1, 2, 2, 1, 1, 2, 1, 2] = value
        K_μ[1, 2, 2, 2, 1, 2, 1, 1] = value
        K_μ[1, 2, 2, 2, 2, 2, 1, 1] = value
        K_μ[2, 1, 1, 1, 2, 1, 2, 2] = value
        K_μ[2, 1, 1, 1, 2, 2, 2, 2] = value
        K_μ[2, 1, 1, 2, 1, 1, 2, 1] = value
        K_μ[2, 1, 1, 2, 2, 1, 2, 1] = value
        K_μ[2, 1, 2, 1, 2, 1, 1, 2] = value
        K_μ[2, 1, 2, 1, 2, 2, 1, 2] = value
        K_μ[2, 1, 2, 2, 1, 1, 1, 1] = value
        K_μ[2, 1, 2, 2, 2, 1, 1, 1] = value
        K_μ[2, 2, 1, 1, 1, 1, 2, 2] = value
        K_μ[2, 2, 1, 1, 1, 2, 2, 2] = value
        K_μ[2, 2, 1, 2, 1, 1, 2, 1] = value
        K_μ[2, 2, 1, 2, 2, 1, 2, 1] = value
        K_μ[2, 2, 2, 1, 1, 1, 1, 2] = value
        K_μ[2, 2, 2, 1, 1, 2, 1, 2] = value
        K_μ[2, 2, 2, 2, 1, 1, 1, 1] = value
        K_μ[2, 2, 2, 2, 2, 1, 1, 1] = value

        value = h[3] / 24
        K_μ[1, 1, 1, 1, 1, 1, 2, 2] = value
        K_μ[1, 1, 1, 1, 1, 2, 2, 2] = value
        K_μ[1, 1, 1, 2, 1, 1, 2, 1] = value
        K_μ[1, 1, 1, 2, 2, 1, 2, 1] = value
        K_μ[1, 1, 2, 1, 1, 1, 1, 2] = value
        K_μ[1, 1, 2, 1, 1, 2, 1, 2] = value
        K_μ[1, 1, 2, 2, 1, 1, 1, 1] = value
        K_μ[1, 1, 2, 2, 2, 1, 1, 1] = value
        K_μ[1, 2, 1, 1, 2, 1, 2, 2] = value
        K_μ[1, 2, 1, 1, 2, 2, 2, 2] = value
        K_μ[1, 2, 1, 2, 1, 1, 2, 1] = value
        K_μ[1, 2, 1, 2, 2, 1, 2, 1] = value
        K_μ[1, 2, 2, 1, 2, 1, 1, 2] = value
        K_μ[1, 2, 2, 1, 2, 2, 1, 2] = value
        K_μ[1, 2, 2, 2, 1, 1, 1, 1] = value
        K_μ[1, 2, 2, 2, 2, 1, 1, 1] = value
        K_μ[2, 1, 1, 1, 1, 1, 2, 2] = value
        K_μ[2, 1, 1, 1, 1, 2, 2, 2] = value
        K_μ[2, 1, 1, 2, 1, 2, 2, 1] = value
        K_μ[2, 1, 1, 2, 2, 2, 2, 1] = value
        K_μ[2, 1, 2, 1, 1, 1, 1, 2] = value
        K_μ[2, 1, 2, 1, 1, 2, 1, 2] = value
        K_μ[2, 1, 2, 2, 1, 2, 1, 1] = value
        K_μ[2, 1, 2, 2, 2, 2, 1, 1] = value
        K_μ[2, 2, 1, 1, 2, 1, 2, 2] = value
        K_μ[2, 2, 1, 1, 2, 2, 2, 2] = value
        K_μ[2, 2, 1, 2, 1, 2, 2, 1] = value
        K_μ[2, 2, 1, 2, 2, 2, 2, 1] = value
        K_μ[2, 2, 2, 1, 2, 1, 1, 2] = value
        K_μ[2, 2, 2, 1, 2, 2, 1, 2] = value
        K_μ[2, 2, 2, 2, 1, 2, 1, 1] = value
        K_μ[2, 2, 2, 2, 2, 2, 1, 1] = value

        value = h[3] / 12
        K_μ[1, 1, 1, 1, 1, 1, 1, 2] = value
        K_μ[1, 1, 1, 1, 1, 2, 1, 2] = value
        K_μ[1, 1, 1, 2, 1, 1, 1, 1] = value
        K_μ[1, 1, 1, 2, 2, 1, 1, 1] = value
        K_μ[1, 1, 2, 1, 1, 1, 2, 2] = value
        K_μ[1, 1, 2, 1, 1, 2, 2, 2] = value
        K_μ[1, 1, 2, 2, 1, 1, 2, 1] = value
        K_μ[1, 1, 2, 2, 2, 1, 2, 1] = value
        K_μ[1, 2, 1, 1, 2, 1, 1, 2] = value
        K_μ[1, 2, 1, 1, 2, 2, 1, 2] = value
        K_μ[1, 2, 1, 2, 1, 1, 1, 1] = value
        K_μ[1, 2, 1, 2, 2, 1, 1, 1] = value
        K_μ[1, 2, 2, 1, 2, 1, 2, 2] = value
        K_μ[1, 2, 2, 1, 2, 2, 2, 2] = value
        K_μ[1, 2, 2, 2, 1, 1, 2, 1] = value
        K_μ[1, 2, 2, 2, 2, 1, 2, 1] = value
        K_μ[2, 1, 1, 1, 1, 1, 1, 2] = value
        K_μ[2, 1, 1, 1, 1, 2, 1, 2] = value
        K_μ[2, 1, 1, 2, 1, 2, 1, 1] = value
        K_μ[2, 1, 1, 2, 2, 2, 1, 1] = value
        K_μ[2, 1, 2, 1, 1, 1, 2, 2] = value
        K_μ[2, 1, 2, 1, 1, 2, 2, 2] = value
        K_μ[2, 1, 2, 2, 1, 2, 2, 1] = value
        K_μ[2, 1, 2, 2, 2, 2, 2, 1] = value
        K_μ[2, 2, 1, 1, 2, 1, 1, 2] = value
        K_μ[2, 2, 1, 1, 2, 2, 1, 2] = value
        K_μ[2, 2, 1, 2, 1, 2, 1, 1] = value
        K_μ[2, 2, 1, 2, 2, 2, 1, 1] = value
        K_μ[2, 2, 2, 1, 2, 1, 2, 2] = value
        K_μ[2, 2, 2, 1, 2, 2, 2, 2] = value
        K_μ[2, 2, 2, 2, 1, 2, 2, 1] = value
        K_μ[2, 2, 2, 2, 2, 2, 2, 1] = value

        value =
            (-(2 * h[2] * h[3]) / (9 * h[1])) +
            (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 1, 2, 1, 1, 1] = value
        K_μ[1, 1, 2, 1, 2, 1, 2, 1] = value
        K_μ[1, 2, 1, 1, 2, 2, 1, 1] = value
        K_μ[1, 2, 2, 1, 2, 2, 2, 1] = value
        K_μ[2, 1, 1, 1, 1, 1, 1, 1] = value
        K_μ[2, 1, 2, 1, 1, 1, 2, 1] = value
        K_μ[2, 2, 1, 1, 1, 2, 1, 1] = value
        K_μ[2, 2, 2, 1, 1, 2, 2, 1] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) - (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (36 * h[3])
        K_μ[1, 1, 1, 1, 2, 2, 1, 1] = value
        K_μ[1, 1, 2, 1, 2, 2, 2, 1] = value
        K_μ[1, 2, 1, 1, 2, 1, 1, 1] = value
        K_μ[1, 2, 2, 1, 2, 1, 2, 1] = value
        K_μ[2, 1, 1, 1, 1, 2, 1, 1] = value
        K_μ[2, 1, 2, 1, 1, 2, 2, 1] = value
        K_μ[2, 2, 1, 1, 1, 1, 1, 1] = value
        K_μ[2, 2, 2, 1, 1, 1, 2, 1] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) + (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 1, 2, 1, 2, 1] = value
        K_μ[1, 1, 2, 1, 2, 1, 1, 1] = value
        K_μ[1, 2, 1, 1, 2, 2, 2, 1] = value
        K_μ[1, 2, 2, 1, 2, 2, 1, 1] = value
        K_μ[2, 1, 1, 1, 1, 1, 2, 1] = value
        K_μ[2, 1, 2, 1, 1, 1, 1, 1] = value
        K_μ[2, 2, 1, 1, 1, 2, 2, 1] = value
        K_μ[2, 2, 2, 1, 1, 2, 1, 1] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) +
            (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 3, 2, 1, 1, 3] = value
        K_μ[1, 1, 2, 3, 2, 1, 2, 3] = value
        K_μ[1, 2, 1, 3, 2, 2, 1, 3] = value
        K_μ[1, 2, 2, 3, 2, 2, 2, 3] = value
        K_μ[2, 1, 1, 3, 1, 1, 1, 3] = value
        K_μ[2, 1, 2, 3, 1, 1, 2, 3] = value
        K_μ[2, 2, 1, 3, 1, 2, 1, 3] = value
        K_μ[2, 2, 2, 3, 1, 2, 2, 3] = value

        value =
            (-(h[2] * h[3]) / (9 * h[1])) +
            (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 2, 2, 1, 1, 2] = value
        K_μ[1, 1, 2, 2, 2, 1, 2, 2] = value
        K_μ[1, 2, 1, 2, 2, 2, 1, 2] = value
        K_μ[1, 2, 2, 2, 2, 2, 2, 2] = value
        K_μ[2, 1, 1, 2, 1, 1, 1, 2] = value
        K_μ[2, 1, 2, 2, 1, 1, 2, 2] = value
        K_μ[2, 2, 1, 2, 1, 2, 1, 2] = value
        K_μ[2, 2, 2, 2, 1, 2, 2, 2] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) - (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (36 * h[3])
        K_μ[1, 1, 1, 2, 2, 2, 1, 2] = value
        K_μ[1, 1, 2, 2, 2, 2, 2, 2] = value
        K_μ[1, 2, 1, 2, 2, 1, 1, 2] = value
        K_μ[1, 2, 2, 2, 2, 1, 2, 2] = value
        K_μ[2, 1, 1, 2, 1, 2, 1, 2] = value
        K_μ[2, 1, 2, 2, 1, 2, 2, 2] = value
        K_μ[2, 2, 1, 2, 1, 1, 1, 2] = value
        K_μ[2, 2, 2, 2, 1, 1, 2, 2] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) - (h[1] * h[3]) / (18 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 3, 2, 2, 1, 3] = value
        K_μ[1, 1, 2, 3, 2, 2, 2, 3] = value
        K_μ[1, 2, 1, 3, 2, 1, 1, 3] = value
        K_μ[1, 2, 2, 3, 2, 1, 2, 3] = value
        K_μ[2, 1, 1, 3, 1, 2, 1, 3] = value
        K_μ[2, 1, 2, 3, 1, 2, 2, 3] = value
        K_μ[2, 2, 1, 3, 1, 1, 1, 3] = value
        K_μ[2, 2, 2, 3, 1, 1, 2, 3] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) - (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (36 * h[3])
        K_μ[1, 1, 1, 1, 2, 2, 2, 1] = value
        K_μ[1, 1, 2, 1, 2, 2, 1, 1] = value
        K_μ[1, 2, 1, 1, 2, 1, 2, 1] = value
        K_μ[1, 2, 2, 1, 2, 1, 1, 1] = value
        K_μ[2, 1, 1, 1, 1, 2, 2, 1] = value
        K_μ[2, 1, 2, 1, 1, 2, 1, 1] = value
        K_μ[2, 2, 1, 1, 1, 1, 2, 1] = value
        K_μ[2, 2, 2, 1, 1, 1, 1, 1] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) + (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 3, 2, 1, 2, 3] = value
        K_μ[1, 1, 2, 3, 2, 1, 1, 3] = value
        K_μ[1, 2, 1, 3, 2, 2, 2, 3] = value
        K_μ[1, 2, 2, 3, 2, 2, 1, 3] = value
        K_μ[2, 1, 1, 3, 1, 1, 2, 3] = value
        K_μ[2, 1, 2, 3, 1, 1, 1, 3] = value
        K_μ[2, 2, 1, 3, 1, 2, 2, 3] = value
        K_μ[2, 2, 2, 3, 1, 2, 1, 3] = value

        value =
            (-(h[2] * h[3]) / (18 * h[1])) + (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 2, 2, 1, 2, 2] = value
        K_μ[1, 1, 2, 2, 2, 1, 1, 2] = value
        K_μ[1, 2, 1, 2, 2, 2, 2, 2] = value
        K_μ[1, 2, 2, 2, 2, 2, 1, 2] = value
        K_μ[2, 1, 1, 2, 1, 1, 2, 2] = value
        K_μ[2, 1, 2, 2, 1, 1, 1, 2] = value
        K_μ[2, 2, 1, 2, 1, 2, 2, 2] = value
        K_μ[2, 2, 2, 2, 1, 2, 1, 2] = value

        value =
            (-(h[2] * h[3]) / (36 * h[1])) - (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (36 * h[3])
        K_μ[1, 1, 1, 2, 2, 2, 2, 2] = value
        K_μ[1, 1, 2, 2, 2, 2, 1, 2] = value
        K_μ[1, 2, 1, 2, 2, 1, 2, 2] = value
        K_μ[1, 2, 2, 2, 2, 1, 1, 2] = value
        K_μ[2, 1, 1, 2, 1, 2, 2, 2] = value
        K_μ[2, 1, 2, 2, 1, 2, 1, 2] = value
        K_μ[2, 2, 1, 2, 1, 1, 2, 2] = value
        K_μ[2, 2, 2, 2, 1, 1, 1, 2] = value

        value =
            (-(h[2] * h[3]) / (36 * h[1])) - (h[1] * h[3]) / (36 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 3, 2, 2, 2, 3] = value
        K_μ[1, 1, 2, 3, 2, 2, 1, 3] = value
        K_μ[1, 2, 1, 3, 2, 1, 2, 3] = value
        K_μ[1, 2, 2, 3, 2, 1, 1, 3] = value
        K_μ[2, 1, 1, 3, 1, 2, 2, 3] = value
        K_μ[2, 1, 2, 3, 1, 2, 1, 3] = value
        K_μ[2, 2, 1, 3, 1, 1, 2, 3] = value
        K_μ[2, 2, 2, 3, 1, 1, 1, 3] = value

        value =
            (h[2] * h[3]) / (36 * h[1]) - (h[1] * h[3]) / (9 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 2, 1, 2, 2, 2] = value
        K_μ[1, 1, 2, 2, 1, 2, 1, 2] = value
        K_μ[1, 2, 1, 2, 1, 1, 2, 2] = value
        K_μ[1, 2, 2, 2, 1, 1, 1, 2] = value
        K_μ[2, 1, 1, 2, 2, 2, 2, 2] = value
        K_μ[2, 1, 2, 2, 2, 2, 1, 2] = value
        K_μ[2, 2, 1, 2, 2, 1, 2, 2] = value
        K_μ[2, 2, 2, 2, 2, 1, 1, 2] = value

        value =
            (h[2] * h[3]) / (36 * h[1]) - (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 3, 1, 2, 2, 3] = value
        K_μ[1, 1, 2, 3, 1, 2, 1, 3] = value
        K_μ[1, 2, 1, 3, 1, 1, 2, 3] = value
        K_μ[1, 2, 2, 3, 1, 1, 1, 3] = value
        K_μ[2, 1, 1, 3, 2, 2, 2, 3] = value
        K_μ[2, 1, 2, 3, 2, 2, 1, 3] = value
        K_μ[2, 2, 1, 3, 2, 1, 2, 3] = value
        K_μ[2, 2, 2, 3, 2, 1, 1, 3] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) - (2 * h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 2, 1, 2, 1, 2] = value
        K_μ[1, 1, 2, 2, 1, 2, 2, 2] = value
        K_μ[1, 2, 1, 2, 1, 1, 1, 2] = value
        K_μ[1, 2, 2, 2, 1, 1, 2, 2] = value
        K_μ[2, 1, 1, 2, 2, 2, 1, 2] = value
        K_μ[2, 1, 2, 2, 2, 2, 2, 2] = value
        K_μ[2, 2, 1, 2, 2, 1, 1, 2] = value
        K_μ[2, 2, 2, 2, 2, 1, 2, 2] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) - (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 3, 1, 2, 1, 3] = value
        K_μ[1, 1, 2, 3, 1, 2, 2, 3] = value
        K_μ[1, 2, 1, 3, 1, 1, 1, 3] = value
        K_μ[1, 2, 2, 3, 1, 1, 2, 3] = value
        K_μ[2, 1, 1, 3, 2, 2, 1, 3] = value
        K_μ[2, 1, 2, 3, 2, 2, 2, 3] = value
        K_μ[2, 2, 1, 3, 2, 1, 1, 3] = value
        K_μ[2, 2, 2, 3, 2, 1, 2, 3] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) - (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 1, 1, 2, 2, 1] = value
        K_μ[1, 1, 2, 1, 1, 2, 1, 1] = value
        K_μ[1, 2, 1, 1, 1, 1, 2, 1] = value
        K_μ[1, 2, 2, 1, 1, 1, 1, 1] = value
        K_μ[2, 1, 1, 1, 2, 2, 2, 1] = value
        K_μ[2, 1, 2, 1, 2, 2, 1, 1] = value
        K_μ[2, 2, 1, 1, 2, 1, 2, 1] = value
        K_μ[2, 2, 2, 1, 2, 1, 1, 1] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) + (h[1] * h[3]) / (18 * h[2]) -
            (2 * h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 3, 1, 1, 2, 3] = value
        K_μ[1, 1, 2, 3, 1, 1, 1, 3] = value
        K_μ[1, 2, 1, 3, 1, 2, 2, 3] = value
        K_μ[1, 2, 2, 3, 1, 2, 1, 3] = value
        K_μ[2, 1, 1, 3, 2, 1, 2, 3] = value
        K_μ[2, 1, 2, 3, 2, 1, 1, 3] = value
        K_μ[2, 2, 1, 3, 2, 2, 2, 3] = value
        K_μ[2, 2, 2, 3, 2, 2, 1, 3] = value

        value =
            (h[2] * h[3]) / (18 * h[1]) + (h[1] * h[3]) / (9 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 2, 1, 1, 2, 2] = value
        K_μ[1, 1, 2, 2, 1, 1, 1, 2] = value
        K_μ[1, 2, 1, 2, 1, 2, 2, 2] = value
        K_μ[1, 2, 2, 2, 1, 2, 1, 2] = value
        K_μ[2, 1, 1, 2, 2, 1, 2, 2] = value
        K_μ[2, 1, 2, 2, 2, 1, 1, 2] = value
        K_μ[2, 2, 1, 2, 2, 2, 2, 2] = value
        K_μ[2, 2, 2, 2, 2, 2, 1, 2] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) - (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (18 * h[3])
        K_μ[1, 1, 1, 1, 1, 2, 1, 1] = value
        K_μ[1, 1, 2, 1, 1, 2, 2, 1] = value
        K_μ[1, 2, 1, 1, 1, 1, 1, 1] = value
        K_μ[1, 2, 2, 1, 1, 1, 2, 1] = value
        K_μ[2, 1, 1, 1, 2, 2, 1, 1] = value
        K_μ[2, 1, 2, 1, 2, 2, 2, 1] = value
        K_μ[2, 2, 1, 1, 2, 1, 1, 1] = value
        K_μ[2, 2, 2, 1, 2, 1, 2, 1] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) + (h[1] * h[3]) / (18 * h[2]) -
            (h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 1, 1, 1, 2, 1] = value
        K_μ[1, 1, 2, 1, 1, 1, 1, 1] = value
        K_μ[1, 2, 1, 1, 1, 2, 2, 1] = value
        K_μ[1, 2, 2, 1, 1, 2, 1, 1] = value
        K_μ[2, 1, 1, 1, 2, 1, 2, 1] = value
        K_μ[2, 1, 2, 1, 2, 1, 1, 1] = value
        K_μ[2, 2, 1, 1, 2, 2, 2, 1] = value
        K_μ[2, 2, 2, 1, 2, 2, 1, 1] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) +
            (h[1] * h[3]) / (9 * h[2]) +
            (2 * h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 3, 1, 1, 1, 3] = value
        K_μ[1, 1, 2, 3, 1, 1, 2, 3] = value
        K_μ[1, 2, 1, 3, 1, 2, 1, 3] = value
        K_μ[1, 2, 2, 3, 1, 2, 2, 3] = value
        K_μ[2, 1, 1, 3, 2, 1, 1, 3] = value
        K_μ[2, 1, 2, 3, 2, 1, 2, 3] = value
        K_μ[2, 2, 1, 3, 2, 2, 1, 3] = value
        K_μ[2, 2, 2, 3, 2, 2, 2, 3] = value

        value =
            (h[2] * h[3]) / (9 * h[1]) +
            (2 * h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 2, 1, 1, 1, 2] = value
        K_μ[1, 1, 2, 2, 1, 1, 2, 2] = value
        K_μ[1, 2, 1, 2, 1, 2, 1, 2] = value
        K_μ[1, 2, 2, 2, 1, 2, 2, 2] = value
        K_μ[2, 1, 1, 2, 2, 1, 1, 2] = value
        K_μ[2, 1, 2, 2, 2, 1, 2, 2] = value
        K_μ[2, 2, 1, 2, 2, 2, 1, 2] = value
        K_μ[2, 2, 2, 2, 2, 2, 2, 2] = value

        value =
            (2 * h[2] * h[3]) / (9 * h[1]) +
            (h[1] * h[3]) / (9 * h[2]) +
            (h[1] * h[2]) / (9 * h[3])
        K_μ[1, 1, 1, 1, 1, 1, 1, 1] = value
        K_μ[1, 1, 2, 1, 1, 1, 2, 1] = value
        K_μ[1, 2, 1, 1, 1, 2, 1, 1] = value
        K_μ[1, 2, 2, 1, 1, 2, 2, 1] = value
        K_μ[2, 1, 1, 1, 2, 1, 1, 1] = value
        K_μ[2, 1, 2, 1, 2, 1, 2, 1] = value
        K_μ[2, 2, 1, 1, 2, 2, 1, 1] = value
        K_μ[2, 2, 2, 1, 2, 2, 2, 1] = value
    else
    end
    return K_μ
end

@testset "Gauss–Legendre integration" begin
    h3 = [1.1, 1.2, 1.3]
    order = 2
    for d = 1:3
        @testset "Gauss-Legendre integration, $(d)d" begin
            for n in map(Tuple, CartesianIndices(Tuple(fill(1:(2*order-1), d))))
                h = h3[1:d]
                actual = integrate(x -> prod(x .^ n), h)
                n1 = n .+ 1
                expected = prod(((h / 2) .^ n1 .- (-h / 2) .^ n1) ./ n1)
                @test actual ≈ expected rtol = 1e-15 atol = 1e-15
            end
        end
    end
end

@testset "Node numbering" begin
    for d = 1:3
        h = [1.1, 1.2, 1.3][1:d]
        𝔑 = element_nodes(d)
        for m ∈ 𝔑
            x = h .* (-1) .^ Tuple(m) / 2
            N = shape(x, h)
            for n ∈ 𝔑
                @test N[n] == Float64(m == n)
            end
        end
    end
end

@testset "Brick element operators" begin
    for d = 2:3
        @testset "Brick element operators, $(d)d" begin
            # Note: reference values where computed with maxima
            # (see `ref/nd_brick_elasticity.mac`).
            h = [1.1, 1.2, 1.3][1:d]
            μ = 5.6
            ν = 0.3
            λ = 2μ * ν / (1 - 2ν)

            @testset "Average gradient_operator, $(d)d" begin
                D_act = Scapin.avg_gradient_operator(h)
                D_exp = expected_avg_gradient_operator(h)
                @test D_act ≈ D_exp rtol = 1e-15 atol = 1e-15
            end

            @testset "Average strain-displacement matrix, $(d)d" begin
                B_act = avg_strain_displacement_operator(h)
                B_exp = expected_avg_strain_displacement_operator(h)
                @test B_act ≈ B_exp rtol = 1e-15 atol = 1e-15
            end

            @testset "Stiffness operator, $(d)d" begin
                K_act = stiffness_operator(h, μ, ν)
                K_λ = expected_K_λ(h)
                K_μ = expected_K_μ(h)
                K_exp = λ * K_λ + μ * K_μ
                @test K_act ≈ K_exp rtol = 1e-15 atol = 1e-15
            end
        end
    end
end

@testset "Connectivity" begin
    @testset "Connectivity, 2d" begin
        """
        1┬────────┬────────┬────────┐
         │        │        │        │
         │ (1, 4) │ (2, 4) │ (3, 4) │
         │        │        │        │
        4┼────────┼────────┼────────│
         │        │        │        │
         │ (1, 3) │ (2, 3) │ (3, 3) │
         │        │        │        │
        3┼────────┼────────┼────────│
         │        │        │        │
         │ (1, 2) │ (2, 2) │ (3, 2) │
         │        │        │        │
        2┼────────┼────────┼────────│
         │        │        │        │
         │ (1, 1) │ (2, 1) │ (3, 1) │
         │        │        │        │
        1┼────────┼────────┼────────┤
         1        2        3        1
        """
        N = [3, 4]
        d = size(N, 1)
        dims = Tuple(1:n for n in N)
        linear = LinearIndices(dims)
        @test element_nodes((1, 1), N) == [(1, 1), (2, 1), (1, 2), (2, 2)]
        @test element_nodes((2, 1), N) == [(2, 1), (3, 1), (2, 2), (3, 2)]
        @test element_nodes((3, 1), N) == [(3, 1), (1, 1), (3, 2), (1, 2)]
        @test element_nodes((1, 2), N) == [(1, 2), (2, 2), (1, 3), (2, 3)]
        @test element_nodes((2, 2), N) == [(2, 2), (3, 2), (2, 3), (3, 3)]
        @test element_nodes((3, 2), N) == [(3, 2), (1, 2), (3, 3), (1, 3)]
        @test element_nodes((1, 3), N) == [(1, 3), (2, 3), (1, 4), (2, 4)]
        @test element_nodes((2, 3), N) == [(2, 3), (3, 3), (2, 4), (3, 4)]
        @test element_nodes((3, 3), N) == [(3, 3), (1, 3), (3, 4), (1, 4)]
        @test element_nodes((1, 4), N) == [(1, 4), (2, 4), (1, 1), (2, 1)]
        @test element_nodes((2, 4), N) == [(2, 4), (3, 4), (2, 1), (3, 1)]
        @test element_nodes((3, 4), N) == [(3, 4), (1, 4), (3, 1), (1, 1)]
    end

    @testset "Connectivity, 3d" begin
        """
        1───────────2───────────3───────────4
        │           │           │           │
        │ (1, 4, 1) │ (2, 4, 1) │ (3, 4, 1) │
        │           │           │           │
        10─────────11───────────12─────────10
        │           │           │           │
        │ (1, 3, 1) │ (2, 3, 1) │ (3, 3, 1) │
        │           │           │           │
        7───────────8───────────9───────────7
        │           │           │           │
        │ (1, 2, 1) │ (2, 2, 1) │ (3, 2, 1) │
        │           │           │           │
        4───────────5───────────6───────────4
        │           │           │           │
        │ (1, 1, 1) │ (2, 1, 1) │ (3, 1, 1) │
        │           │           │           │
        1───────────2───────────3───────────1


        13─────────14───────────15─────────13
        │           │           │           │
        │ (1, 4, 2) │ (2, 4, 2) │ (3, 4, 2) │
        │           │           │           │
        22─────────23───────────24─────────22
        │           │           │           │
        │ (1, 3, 2) │ (2, 3, 2) │ (3, 3, 2) │
        │           │           │           │
        19─────────20───────────21─────────19
        │           │           │           │
        │ (1, 2, 2) │ (2, 2, 2) │ (3, 2, 2) │
        │           │           │           │
        16─────────17───────────18─────────16
        │           │           │           │
        │ (1, 1, 2) │ (2, 1, 2) │ (3, 1, 2) │
        │           │           │           │
        13─────────14───────────15─────────13


        25─────────26───────────27─────────25
        │           │           │           │
        │ (1, 4, 3) │ (2, 4, 3) │ (3, 4, 3) │
        │           │           │           │
        34─────────35───────────36─────────34
        │           │           │           │
        │ (1, 3, 3) │ (2, 3, 3) │ (3, 3, 3) │
        │           │           │           │
        31─────────32───────────33─────────31
        │           │           │           │
        │ (1, 2, 3) │ (2, 2, 3) │ (3, 2, 3) │
        │           │           │           │
        28─────────29───────────30─────────28
        │           │           │           │
        │ (1, 1, 3) │ (2, 1, 3) │ (3, 1, 3) │
        │           │           │           │
        25─────────26───────────27─────────25


        37─────────38───────────39─────────37
        │           │           │           │
        │ (1, 4, 4) │ (2, 4, 4) │ (3, 4, 4) │
        │           │           │           │
        46─────────47───────────48─────────46
        │           │           │           │
        │ (1, 3, 4) │ (2, 3, 4) │ (3, 3, 4) │
        │           │           │           │
        43─────────44───────────45─────────43
        │           │           │           │
        │ (1, 2, 4) │ (2, 2, 4) │ (3, 2, 4) │
        │           │           │           │
        40─────────41───────────42─────────40
        │           │           │           │
        │ (1, 1, 4) │ (2, 1, 4) │ (3, 1, 4) │
        │           │           │           │
        37─────────38───────────39─────────37


        49─────────50───────────51─────────49
        │           │           │           │
        │ (1, 4, 5) │ (2, 4, 5) │ (3, 4, 5) │
        │           │           │           │
        58─────────59───────────60─────────58
        │           │           │           │
        │ (1, 3, 5) │ (2, 3, 5) │ (3, 3, 5) │
        │           │           │           │
        55─────────56───────────57─────────55
        │           │           │           │
        │ (1, 2, 5) │ (2, 2, 5) │ (3, 2, 5) │
        │           │           │           │
        52─────────53───────────54─────────52
        │           │           │           │
        │ (1, 1, 5) │ (2, 1, 5) │ (3, 1, 5) │
        │           │           │           │
        49─────────50───────────51─────────49


        1───────────2───────────3───────────4
        │           │           │           │
        │           │           │           │
        │           │           │           │
        10─────────11───────────12─────────10
        │           │           │           │
        │           │           │           │
        │           │           │           │
        7───────────8───────────9───────────7
        │           │           │           │
        │           │           │           │
        │           │           │           │
        4───────────5───────────6───────────4
        │           │           │           │
        │           │           │           │
        │           │           │           │
        1───────────2───────────3───────────1

        """
        N = [3, 4, 5]
        d = size(N, 1)
        dims = Tuple(1:n for n in N)
        linear = LinearIndices(dims)
        @test element_nodes((1, 1, 1), N) == [
            (1, 1, 1),
            (2, 1, 1),
            (1, 2, 1),
            (2, 2, 1),
            (1, 1, 2),
            (2, 1, 2),
            (1, 2, 2),
            (2, 2, 2),
        ]
        @test element_nodes((2, 1, 1), N) == [
            (2, 1, 1),
            (3, 1, 1),
            (2, 2, 1),
            (3, 2, 1),
            (2, 1, 2),
            (3, 1, 2),
            (2, 2, 2),
            (3, 2, 2),
        ]
        @test element_nodes((3, 1, 1), N) == [
            (3, 1, 1),
            (1, 1, 1),
            (3, 2, 1),
            (1, 2, 1),
            (3, 1, 2),
            (1, 1, 2),
            (3, 2, 2),
            (1, 2, 2),
        ]
        @test element_nodes((1, 2, 1), N) == [
            (1, 2, 1),
            (2, 2, 1),
            (1, 3, 1),
            (2, 3, 1),
            (1, 2, 2),
            (2, 2, 2),
            (1, 3, 2),
            (2, 3, 2),
        ]
        @test element_nodes((2, 2, 1), N) == [
            (2, 2, 1),
            (3, 2, 1),
            (2, 3, 1),
            (3, 3, 1),
            (2, 2, 2),
            (3, 2, 2),
            (2, 3, 2),
            (3, 3, 2),
        ]
        @test element_nodes((3, 2, 1), N) == [
            (3, 2, 1),
            (1, 2, 1),
            (3, 3, 1),
            (1, 3, 1),
            (3, 2, 2),
            (1, 2, 2),
            (3, 3, 2),
            (1, 3, 2),
        ]
        @test element_nodes((1, 3, 1), N) == [
            (1, 3, 1),
            (2, 3, 1),
            (1, 4, 1),
            (2, 4, 1),
            (1, 3, 2),
            (2, 3, 2),
            (1, 4, 2),
            (2, 4, 2),
        ]
        @test element_nodes((2, 3, 1), N) == [
            (2, 3, 1),
            (3, 3, 1),
            (2, 4, 1),
            (3, 4, 1),
            (2, 3, 2),
            (3, 3, 2),
            (2, 4, 2),
            (3, 4, 2),
        ]
        @test element_nodes((3, 3, 1), N) == [
            (3, 3, 1),
            (1, 3, 1),
            (3, 4, 1),
            (1, 4, 1),
            (3, 3, 2),
            (1, 3, 2),
            (3, 4, 2),
            (1, 4, 2),
        ]
        @test element_nodes((1, 4, 1), N) == [
            (1, 4, 1),
            (2, 4, 1),
            (1, 1, 1),
            (2, 1, 1),
            (1, 4, 2),
            (2, 4, 2),
            (1, 1, 2),
            (2, 1, 2),
        ]
        @test element_nodes((2, 4, 1), N) == [
            (2, 4, 1),
            (3, 4, 1),
            (2, 1, 1),
            (3, 1, 1),
            (2, 4, 2),
            (3, 4, 2),
            (2, 1, 2),
            (3, 1, 2),
        ]
        @test element_nodes((3, 4, 1), N) == [
            (3, 4, 1),
            (1, 4, 1),
            (3, 1, 1),
            (1, 1, 1),
            (3, 4, 2),
            (1, 4, 2),
            (3, 1, 2),
            (1, 1, 2),
        ]

        @test element_nodes((1, 1, 2), N) == [
            (1, 1, 2),
            (2, 1, 2),
            (1, 2, 2),
            (2, 2, 2),
            (1, 1, 3),
            (2, 1, 3),
            (1, 2, 3),
            (2, 2, 3),
        ]
        @test element_nodes((2, 1, 2), N) == [
            (2, 1, 2),
            (3, 1, 2),
            (2, 2, 2),
            (3, 2, 2),
            (2, 1, 3),
            (3, 1, 3),
            (2, 2, 3),
            (3, 2, 3),
        ]
        @test element_nodes((3, 1, 2), N) == [
            (3, 1, 2),
            (1, 1, 2),
            (3, 2, 2),
            (1, 2, 2),
            (3, 1, 3),
            (1, 1, 3),
            (3, 2, 3),
            (1, 2, 3),
        ]
        @test element_nodes((1, 2, 2), N) == [
            (1, 2, 2),
            (2, 2, 2),
            (1, 3, 2),
            (2, 3, 2),
            (1, 2, 3),
            (2, 2, 3),
            (1, 3, 3),
            (2, 3, 3),
        ]
        @test element_nodes((2, 2, 2), N) == [
            (2, 2, 2),
            (3, 2, 2),
            (2, 3, 2),
            (3, 3, 2),
            (2, 2, 3),
            (3, 2, 3),
            (2, 3, 3),
            (3, 3, 3),
        ]
        @test element_nodes((3, 2, 2), N) == [
            (3, 2, 2),
            (1, 2, 2),
            (3, 3, 2),
            (1, 3, 2),
            (3, 2, 3),
            (1, 2, 3),
            (3, 3, 3),
            (1, 3, 3),
        ]
        @test element_nodes((1, 3, 2), N) == [
            (1, 3, 2),
            (2, 3, 2),
            (1, 4, 2),
            (2, 4, 2),
            (1, 3, 3),
            (2, 3, 3),
            (1, 4, 3),
            (2, 4, 3),
        ]
        @test element_nodes((2, 3, 2), N) == [
            (2, 3, 2),
            (3, 3, 2),
            (2, 4, 2),
            (3, 4, 2),
            (2, 3, 3),
            (3, 3, 3),
            (2, 4, 3),
            (3, 4, 3),
        ]
        @test element_nodes((3, 3, 2), N) == [
            (3, 3, 2),
            (1, 3, 2),
            (3, 4, 2),
            (1, 4, 2),
            (3, 3, 3),
            (1, 3, 3),
            (3, 4, 3),
            (1, 4, 3),
        ]
        @test element_nodes((1, 4, 2), N) == [
            (1, 4, 2),
            (2, 4, 2),
            (1, 1, 2),
            (2, 1, 2),
            (1, 4, 3),
            (2, 4, 3),
            (1, 1, 3),
            (2, 1, 3),
        ]
        @test element_nodes((2, 4, 2), N) == [
            (2, 4, 2),
            (3, 4, 2),
            (2, 1, 2),
            (3, 1, 2),
            (2, 4, 3),
            (3, 4, 3),
            (2, 1, 3),
            (3, 1, 3),
        ]
        @test element_nodes((3, 4, 2), N) == [
            (3, 4, 2),
            (1, 4, 2),
            (3, 1, 2),
            (1, 1, 2),
            (3, 4, 3),
            (1, 4, 3),
            (3, 1, 3),
            (1, 1, 3),
        ]

        @test element_nodes((1, 1, 3), N) == [
            (1, 1, 3),
            (2, 1, 3),
            (1, 2, 3),
            (2, 2, 3),
            (1, 1, 4),
            (2, 1, 4),
            (1, 2, 4),
            (2, 2, 4),
        ]
        @test element_nodes((2, 1, 3), N) == [
            (2, 1, 3),
            (3, 1, 3),
            (2, 2, 3),
            (3, 2, 3),
            (2, 1, 4),
            (3, 1, 4),
            (2, 2, 4),
            (3, 2, 4),
        ]
        @test element_nodes((3, 1, 3), N) == [
            (3, 1, 3),
            (1, 1, 3),
            (3, 2, 3),
            (1, 2, 3),
            (3, 1, 4),
            (1, 1, 4),
            (3, 2, 4),
            (1, 2, 4),
        ]
        @test element_nodes((1, 2, 3), N) == [
            (1, 2, 3),
            (2, 2, 3),
            (1, 3, 3),
            (2, 3, 3),
            (1, 2, 4),
            (2, 2, 4),
            (1, 3, 4),
            (2, 3, 4),
        ]
        @test element_nodes((2, 2, 3), N) == [
            (2, 2, 3),
            (3, 2, 3),
            (2, 3, 3),
            (3, 3, 3),
            (2, 2, 4),
            (3, 2, 4),
            (2, 3, 4),
            (3, 3, 4),
        ]
        @test element_nodes((3, 2, 3), N) == [
            (3, 2, 3),
            (1, 2, 3),
            (3, 3, 3),
            (1, 3, 3),
            (3, 2, 4),
            (1, 2, 4),
            (3, 3, 4),
            (1, 3, 4),
        ]
        @test element_nodes((1, 3, 3), N) == [
            (1, 3, 3),
            (2, 3, 3),
            (1, 4, 3),
            (2, 4, 3),
            (1, 3, 4),
            (2, 3, 4),
            (1, 4, 4),
            (2, 4, 4),
        ]
        @test element_nodes((2, 3, 3), N) == [
            (2, 3, 3),
            (3, 3, 3),
            (2, 4, 3),
            (3, 4, 3),
            (2, 3, 4),
            (3, 3, 4),
            (2, 4, 4),
            (3, 4, 4),
        ]
        @test element_nodes((3, 3, 3), N) == [
            (3, 3, 3),
            (1, 3, 3),
            (3, 4, 3),
            (1, 4, 3),
            (3, 3, 4),
            (1, 3, 4),
            (3, 4, 4),
            (1, 4, 4),
        ]
        @test element_nodes((1, 4, 3), N) == [
            (1, 4, 3),
            (2, 4, 3),
            (1, 1, 3),
            (2, 1, 3),
            (1, 4, 4),
            (2, 4, 4),
            (1, 1, 4),
            (2, 1, 4),
        ]
        @test element_nodes((2, 4, 3), N) == [
            (2, 4, 3),
            (3, 4, 3),
            (2, 1, 3),
            (3, 1, 3),
            (2, 4, 4),
            (3, 4, 4),
            (2, 1, 4),
            (3, 1, 4),
        ]
        @test element_nodes((3, 4, 3), N) == [
            (3, 4, 3),
            (1, 4, 3),
            (3, 1, 3),
            (1, 1, 3),
            (3, 4, 4),
            (1, 4, 4),
            (3, 1, 4),
            (1, 1, 4),
        ]

        @test element_nodes((1, 1, 4), N) == [
            (1, 1, 4),
            (2, 1, 4),
            (1, 2, 4),
            (2, 2, 4),
            (1, 1, 5),
            (2, 1, 5),
            (1, 2, 5),
            (2, 2, 5),
        ]
        @test element_nodes((2, 1, 4), N) == [
            (2, 1, 4),
            (3, 1, 4),
            (2, 2, 4),
            (3, 2, 4),
            (2, 1, 5),
            (3, 1, 5),
            (2, 2, 5),
            (3, 2, 5),
        ]
        @test element_nodes((3, 1, 4), N) == [
            (3, 1, 4),
            (1, 1, 4),
            (3, 2, 4),
            (1, 2, 4),
            (3, 1, 5),
            (1, 1, 5),
            (3, 2, 5),
            (1, 2, 5),
        ]
        @test element_nodes((1, 2, 4), N) == [
            (1, 2, 4),
            (2, 2, 4),
            (1, 3, 4),
            (2, 3, 4),
            (1, 2, 5),
            (2, 2, 5),
            (1, 3, 5),
            (2, 3, 5),
        ]
        @test element_nodes((2, 2, 4), N) == [
            (2, 2, 4),
            (3, 2, 4),
            (2, 3, 4),
            (3, 3, 4),
            (2, 2, 5),
            (3, 2, 5),
            (2, 3, 5),
            (3, 3, 5),
        ]
        @test element_nodes((3, 2, 4), N) == [
            (3, 2, 4),
            (1, 2, 4),
            (3, 3, 4),
            (1, 3, 4),
            (3, 2, 5),
            (1, 2, 5),
            (3, 3, 5),
            (1, 3, 5),
        ]
        @test element_nodes((1, 3, 4), N) == [
            (1, 3, 4),
            (2, 3, 4),
            (1, 4, 4),
            (2, 4, 4),
            (1, 3, 5),
            (2, 3, 5),
            (1, 4, 5),
            (2, 4, 5),
        ]
        @test element_nodes((2, 3, 4), N) == [
            (2, 3, 4),
            (3, 3, 4),
            (2, 4, 4),
            (3, 4, 4),
            (2, 3, 5),
            (3, 3, 5),
            (2, 4, 5),
            (3, 4, 5),
        ]
        @test element_nodes((3, 3, 4), N) == [
            (3, 3, 4),
            (1, 3, 4),
            (3, 4, 4),
            (1, 4, 4),
            (3, 3, 5),
            (1, 3, 5),
            (3, 4, 5),
            (1, 4, 5),
        ]
        @test element_nodes((1, 4, 4), N) == [
            (1, 4, 4),
            (2, 4, 4),
            (1, 1, 4),
            (2, 1, 4),
            (1, 4, 5),
            (2, 4, 5),
            (1, 1, 5),
            (2, 1, 5),
        ]
        @test element_nodes((2, 4, 4), N) == [
            (2, 4, 4),
            (3, 4, 4),
            (2, 1, 4),
            (3, 1, 4),
            (2, 4, 5),
            (3, 4, 5),
            (2, 1, 5),
            (3, 1, 5),
        ]
        @test element_nodes((3, 4, 4), N) == [
            (3, 4, 4),
            (1, 4, 4),
            (3, 1, 4),
            (1, 1, 4),
            (3, 4, 5),
            (1, 4, 5),
            (3, 1, 5),
            (1, 1, 5),
        ]

        @test element_nodes((1, 1, 5), N) == [
            (1, 1, 5),
            (2, 1, 5),
            (1, 2, 5),
            (2, 2, 5),
            (1, 1, 1),
            (2, 1, 1),
            (1, 2, 1),
            (2, 2, 1),
        ]
        @test element_nodes((2, 1, 5), N) == [
            (2, 1, 5),
            (3, 1, 5),
            (2, 2, 5),
            (3, 2, 5),
            (2, 1, 1),
            (3, 1, 1),
            (2, 2, 1),
            (3, 2, 1),
        ]
        @test element_nodes((3, 1, 5), N) == [
            (3, 1, 5),
            (1, 1, 5),
            (3, 2, 5),
            (1, 2, 5),
            (3, 1, 1),
            (1, 1, 1),
            (3, 2, 1),
            (1, 2, 1),
        ]
        @test element_nodes((1, 2, 5), N) == [
            (1, 2, 5),
            (2, 2, 5),
            (1, 3, 5),
            (2, 3, 5),
            (1, 2, 1),
            (2, 2, 1),
            (1, 3, 1),
            (2, 3, 1),
        ]
        @test element_nodes((2, 2, 5), N) == [
            (2, 2, 5),
            (3, 2, 5),
            (2, 3, 5),
            (3, 3, 5),
            (2, 2, 1),
            (3, 2, 1),
            (2, 3, 1),
            (3, 3, 1),
        ]
        @test element_nodes((3, 2, 5), N) == [
            (3, 2, 5),
            (1, 2, 5),
            (3, 3, 5),
            (1, 3, 5),
            (3, 2, 1),
            (1, 2, 1),
            (3, 3, 1),
            (1, 3, 1),
        ]
        @test element_nodes((1, 3, 5), N) == [
            (1, 3, 5),
            (2, 3, 5),
            (1, 4, 5),
            (2, 4, 5),
            (1, 3, 1),
            (2, 3, 1),
            (1, 4, 1),
            (2, 4, 1),
        ]
        @test element_nodes((2, 3, 5), N) == [
            (2, 3, 5),
            (3, 3, 5),
            (2, 4, 5),
            (3, 4, 5),
            (2, 3, 1),
            (3, 3, 1),
            (2, 4, 1),
            (3, 4, 1),
        ]
        @test element_nodes((3, 3, 5), N) == [
            (3, 3, 5),
            (1, 3, 5),
            (3, 4, 5),
            (1, 4, 5),
            (3, 3, 1),
            (1, 3, 1),
            (3, 4, 1),
            (1, 4, 1),
        ]
        @test element_nodes((1, 4, 5), N) == [
            (1, 4, 5),
            (2, 4, 5),
            (1, 1, 5),
            (2, 1, 5),
            (1, 4, 1),
            (2, 4, 1),
            (1, 1, 1),
            (2, 1, 1),
        ]
        @test element_nodes((2, 4, 5), N) == [
            (2, 4, 5),
            (3, 4, 5),
            (2, 1, 5),
            (3, 1, 5),
            (2, 4, 1),
            (3, 4, 1),
            (2, 1, 1),
            (3, 1, 1),
        ]
        @test element_nodes((3, 4, 5), N) == [
            (3, 4, 5),
            (1, 4, 5),
            (3, 1, 5),
            (1, 1, 5),
            (3, 4, 1),
            (1, 4, 1),
            (3, 1, 1),
            (1, 1, 1),
        ]

    end
end


# @testset "Global stiffness operator" begin
#     N = [3, 4]
#     h = [1.1, 1.2]
#     μ = 5.6
#     ν = 0.3
#     K = global_stiffness_operator(N, h, μ, ν)
# end
