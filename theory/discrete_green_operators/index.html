<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Discrete Green operators · Scapin.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://sbrisard.github.io/Scapin.jl/theory/discrete_green_operators/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Scapin.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Theory</span><ul><li><a class="tocitem" href="../nomenclature/">Nomenclature</a></li><li><a class="tocitem" href="../continuous_green_operators/">Continuous Green operators</a></li><li class="is-active"><a class="tocitem" href>Discrete Green operators</a><ul class="internal"><li><a class="tocitem" href="#On-the-discrete-Fourier-transform"><span>On the discrete Fourier transform</span></a></li><li><a class="tocitem" href="#The-approximation-space"><span>The approximation space</span></a></li><li><a class="tocitem" href="#Discretizations-of-the-Green-operator"><span>Discretizations of the Green operator</span></a></li><li><a class="tocitem" href="#The-discretization-of-\\textcite{moul1994,-moul1998}"><span>The discretization of \textcite{moul1994, moul1998}</span></a></li></ul></li><li><a class="tocitem" href="../appendix/">Appendix</a></li></ul></li><li><a class="tocitem" href="../../api/">Library</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Theory</a></li><li class="is-active"><a href>Discrete Green operators</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Discrete Green operators</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sbrisard/Scapin.jl/blob/master/docs/src/theory/discrete_green_operators.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Discrete-Green-operators"><a class="docs-heading-anchor" href="#Discrete-Green-operators">Discrete Green operators</a><a id="Discrete-Green-operators-1"></a><a class="docs-heading-anchor-permalink" href="#Discrete-Green-operators" title="Permalink"></a></h1><p>In this chapter, we introduce various discretizations of the Green operator; we will adopt the vocabulary of linear elasticity, although the concepts apply to all the various physical models presented in <a href="../continuous_green_operators/#Continuous-Green-operators">Continuous Green operators</a>.</p><h2 id="On-the-discrete-Fourier-transform"><a class="docs-heading-anchor" href="#On-the-discrete-Fourier-transform">On the discrete Fourier transform</a><a id="On-the-discrete-Fourier-transform-1"></a><a class="docs-heading-anchor-permalink" href="#On-the-discrete-Fourier-transform" title="Permalink"></a></h2><p>Let <span>$x=(x_{\tuple{p}})$</span> be a finite set of scalar values indexed by the <span>$d$</span>-tuple <span>$\tuple{p}=(p_1, \ldots, p_d)$</span> where <span>$0\leq p_i&lt;N_i$</span> (<span>$N_i$</span> is the number of data points in the <span>$i$</span>-th direction). The discrete Fourier transform is a discrete set of scalar values <span>$\dft_{\tuple{n}}(x)$</span> indexed by the <span>$d$</span>-tuple <span>$\tuple{n}\in\integers^d$</span>, defined as follows</p><p class="math-container">\[\dft_{\tuple{n}}(x)=\sum_{p_1=0}^{N_1-1}\cdots\sum_{p_d=0}^{N_d-1}
\exp\Bigl[-2\I\PI\Bigl(\frac{n_1p_1}{N_1}
+\cdots+\frac{n_dp_d}{N_d}\Bigr)\Bigr] x_{\tuple{p}}.\]</p><p>Note that in the above definition, no restrictions are applied to the multi-index <span>$\tuple{n}$</span>. However, it can be verified that the above series of tensors is in fact <span>$\tuple{N}$</span>-periodic: <span>$\dft_{\tuple{n}+\tuple{N}}(x)=\dft_{\tuple{n}}(x)$</span>, where <span>$\tuple{n}+\tuple{N}=(n_1+N_1, \ldots, n_d+N_d)$</span>. Therefore, the <span>$\tuple{n}$</span>-index is effectively restricted to <span>$0\leq n_i&lt;N_i$</span> as well. The most important results concerning the DFT are the <em>inversion formula</em></p><p class="math-container">\[x_{\tuple{p}}=\frac1{\lvert\tuple{N}\rvert}\sum_{n_1=0}^{N_1-1}\cdots
\sum_{n_d=0}^{N_d-1}\exp\Bigl[2\I\PI\Bigl(\frac{n_1p_1}{N_1}+\cdots+
\frac{n_dp_d}{N_d}\Bigr)\Bigr]\dft_{\tuple{n}}(x),\]</p><p>the <em>Plancherel theorem</em></p><p class="math-container">\[\sum_{p_1=1}^{N_1-1}\cdots\sum_{p_d=1}^{N_d-1}\conj(x_{\tuple p})y_{\tuple p}
=\frac1{\lvert\tuple N\rvert}\sum_{n_1=1}^{N_1-1}\cdots\sum_{n_d=1}^{N_d-1}
\conj[\dft_{\tuple n}(x)]\dft_{\tuple n}(y),\]</p><p>and the <em>circular convolution theorem</em></p><p class="math-container">\[\dft_{\tuple{n}}(x\ast y)=\dft_{\tuple{n}}(x)\dft_{\tuple{n}}(y),
\quad\text{where}\quad
(x\ast y)_{\tuple p}=\sum_{q_1=0}^{N_1-1}\cdots\sum_{q_d=0}^{N_d-1}
x_{\tuple{q}}y_{\tuple{p}-\tuple{q}}.\]</p><p>The DFT is readily extended to tensor data points. In the absence of ambiguity, the shorthand <span>$\hat{x}_{\tuple{n}}$</span> will be adopted for <span>$\dft_{\tuple{n}}(x)$</span>.</p><p>To close this section, we observe that the DFT of a series of <em>real</em> data points is a series of <em>complex</em> data points. However, these complex values have the following property</p><p class="math-container">\[\dft_{\tuple{N}-\tuple{n}}(x)=\conj[\dft_{\tuple{n}}(x)].\]</p><p>The above condition is actually a <em>necessary and sufficient</em> condition for the <span>$x_{\tuple{p}}$</span> to be real.</p><h3 id="sec20210803055450"><a class="docs-heading-anchor" href="#sec20210803055450">The <span>$\fftfreq$</span> function</a><a id="sec20210803055450-1"></a><a class="docs-heading-anchor-permalink" href="#sec20210803055450" title="Permalink"></a></h3><p>For <span>$n, N\in\naturals$</span>, <span>$0\leq n&lt;N$</span>, we introduce <span>$\fftfreq(n, N)$</span></p><p class="math-container">\[\fftfreq(n, N)=
\begin{cases}
n &amp; \text{if }2n&lt;N,\\
n-N &amp; \text{otherwise.}
\end{cases}\]</p><p>For <span>$n&lt;0$</span> or <span>$n\geq N$</span>, <span>$\fftfreq(n, N)$</span> is defined by <span>$N$</span>-periodicity. <span>$\fftfreq$</span> is very similar to the NumPy <a href="https://numpy.org/doc/1.18/reference/generated/numpy.fft.fftfreq.html#numpy.fft.fftfreq">fftfreq</a> function. We have the important result (see proof in Sec. <a href="../appendix/#Properties-of-the-\\fftfreq-function">Properties of the <span>$\fftfreq$</span> function</a> of the <a href="../appendix/#Appendix">Appendix</a>)</p><p class="math-container">\[\fftfreq(N-n, N)=
\begin{cases}
\fftfreq(n) &amp; \text{if }2n=N,\\
-\fftfreq(n) &amp; \text{otherwise.}
\end{cases}\]</p><p>The <span>$\fftfreq$</span> function can be defined for <span>$d$</span>-tuples as well</p><p class="math-container">\[\tuple \fftfreq(\tuple n, \tuple N)
=\bigl(\fftfreq(n_1, N_1), \ldots, \fftfreq(n_d, N_d)\bigr)\]</p><p>and we have again</p><p class="math-container">\[\tuple \fftfreq(\tuple N-\tuple n, \tuple N)=-\tuple \fftfreq(\tuple n)\]</p><p>if none of the <span>$n_i$</span> is such that <span>$2n_i=N_i$</span>.</p><h2 id="The-approximation-space"><a class="docs-heading-anchor" href="#The-approximation-space">The approximation space</a><a id="The-approximation-space-1"></a><a class="docs-heading-anchor-permalink" href="#The-approximation-space" title="Permalink"></a></h2><p>In order to define a discrete Green operator, we need to introduce the approximation space for the stress-polarizations. We will consider here stress-polarizations that are constant over each cell of a regular grid of size <span>$N_1\times\cdots\times N_d$</span>. The cells of this grid are</p><p class="math-container">\[\Omega_{\tuple{p}}^{\tuple{h}}=\{p_ih_i\leq x_i&lt;\bigl(p_i+1\bigr)h_i, i=1,\ldots, d\},\]</p><p>where <span>$\tuple{p}=(p_1,\ldots,p_d)\in\cellindices$</span> denotes a <span>$d$</span>-tuple of integers, such that <span>$0\leq p_i&lt;N_i$</span>, <span>$i=1,\ldots, d$</span> and <span>$h_i=L_i/N_i$</span> is the cell-size in the <span>$i$</span>-th direction. Note that, in the above expression, no summation is implied by the repeated index <span>$i$</span>. The total number of cells is <span>$\lvert N\rvert=N_1\cdots N_d$</span>.</p><p>We consider discrete stress-polarizations <span>$\tens\tau^{\tuple{h}}$</span> that are constant over each cell of the grid: <span>$\tens\tau_{\tuple{p}}^{\tuple{h}}$</span> denotes the constant value of <span>$\tens\tau^{\tuple{h}}$</span> in cell <span>$\Omega_{\tuple{p}}^{\tuple{h}}$</span>. The <span>$\tuple{h}$</span> superscript reminds that <span>$\tens\tau^{\tuple{h}}$</span> is a discrete approximation of the true stress-polarization <span>$\tens\tau$</span>. We will call this approximation subspace: <span>$\tensors_2^{\tuple{h}}(\Omega)$</span>.</p><p>As discussed <strong>TODO: xref</strong>, the discrete Green operator is defined as the restriction to this approximation space of the continuous Green operator, seen as a bilinear form, or an approximation of it. In other words, we want to propose an approximation of the quantity</p><p class="math-container">\[\langle\tens\varpi^{\tuple{h}}\dbldot\tens\Gamma(\tens\tau^{\tuple{h}})\rangle
\simeq\langle\tens\varpi^{\tuple{h}}\dbldot\tens\Gamma^{\tuple{h}}(\tens
\tau^{\tuple{h}})\rangle\quad\text{for all }\tens\tau^{\tuple{h}},
\tens\varpi^{\tuple{h}}\in\tensors_2^{\tuple{h}}(\Omega),\]</p><p>where <span>$\tens\Gamma^{\tuple{h}}$</span> is defined only over <span>$\tensors_2(\Omega)$</span>. <span>$\tens\Gamma^{\tuple{h}}$</span> can therefore be seen as a linear mapping between the cell values <span>$\tens\tau_{\tuple{p}}^{\tuple{h}}$</span> of <span>$\tens\tau^{\tuple{p}}$</span> and the cell values of <span>$\tens\Gamma^{\tuple{h}}(\tens\tau^{\tuple{h}})$</span>; <span>$\tens\Gamma^{\tuple{h}}$</span> is therefore a <em>matrix</em>, and the above equation should be understood as</p><p class="math-container">\[\langle\tens\varpi^{\tuple{h}}\dbldot\tens\Gamma(\tens\tau^{\tuple{h}})\rangle
\simeq\frac1{\lvert\tuple{N}\rvert}\sum_{\tuple{p}, \tuple{q}\in\cellindices}
\tens\varpi_{\tuple{p}}^{\tuple{h}}\dbldot
\tens\Gamma_{\tuple{p}\tuple{q}}^{\tuple{h}}\dbldot\tens
\tau_{\tuple{q}}^{\tuple{h}}
\quad\text{for all}\quad
\tens\tau^{\tuple{h}},\tens\varpi^{\tuple{h}}\in\tensors_2^{\tuple{h}}(\Omega).\]</p><p>The continuous Green operator is translation invariant, and this property will of course be transferred to the “exact” discrete Green operator; we will in fact require <em>all</em> dicretizations of the Green operator to have this property. In other words, <span>$\tens\Gamma_{\tuple{p}\tuple{q}}^{\tuple{h}}=\tens\Gamma_{\tuple p-\tuple q}^{\tuple{h}}$</span> and the above equation reads</p><p class="math-container">\[\langle\tens\varpi^{\tuple{h}}\dbldot\tens\Gamma(\tens\tau^{\tuple{h}})\rangle
\simeq\frac1{\lvert\tuple{N}\rvert}\sum_{\tuple{p}, \tuple{q}\in\cellindices}
\tens\varpi_{\tuple{p}}^{\tuple{h}}\dbldot
\tens\Gamma_{\tuple p-\tuple q}^{\tuple{h}}\dbldot\tens
\tau_{\tuple{q}}^{\tuple{h}}\quad\text{for all }\tens\tau^{\tuple{h}},\tens
\varpi^{\tuple{h}}\in\tensors_2^{\tuple{h}}(\Omega).\]</p><p>Note that <span>$\tens\Gamma_{\tuple{p}}^{\tuple{h}}$</span> is now indexed by <em>one</em> index only and its DFT can be introduced unambiguously</p><p class="math-container">\[\begin{aligned}[b]
&amp;\frac{1}{\lvert\tuple N\rvert}\sum_{\tuple{p}, \tuple{q}\in\cellindices}
\tens\varpi_{\tuple{p}}^{\tuple{h}}\dbldot\tens\Gamma_{\tuple p-\tuple q}^{\tuple h}
\dbldot\tens\tau_{\tuple{q}}^{\tuple{h}}\\
={}&amp;\frac1{\lvert\tuple N\rvert^2}\sum_{\tuple p, \tuple q, \tuple n\in\cellindices}
\exp\Bigl[2\I\PI\sum_{j=1}^d\frac{n_j}{N_j}\bigl(p_j-q_j\bigr)\Bigr]
\tens\varpi_{\tuple{p}}^{\tuple{h}}\dbldot\hat{\tens\Gamma}_{\tuple n}^{\tuple h}
\dbldot\tens\tau_{\tuple q}^{\tuple h}\\
={}&amp;\frac{1}{\lvert\tuple N\rvert^2}
\sum_{\tuple n\in\cellindices}\Bigl[\sum_{\tuple{p}\in\cellindices}
\exp\Bigl(2\I\PI\sum_{j=1}^d\frac{n_jp_j}{N_j}\Bigr)
\tens\varpi_{\tuple p}^{\tuple h}\Bigr]\dbldot\hat{\tens\Gamma}_{\tuple n}^{\tuple h}
\dbldot\Bigl[\sum_{\tuple q\in\cellindices}\exp\Bigl(-2\I\PI\sum_{j=1}^d
\frac{n_jq_j}{N_j}\tens\tau_{\tuple q}^{\tuple{h}}\Bigr)\Bigr].
\end{aligned}\]</p><p>Since <span>$\tens\varpi$</span> is real, we have <span>$\conj(\tens\varpi_{\tuple p}^h)=\tens\varpi_{\tuple p}^h$</span> and the first sum in square brackets reads</p><p class="math-container">\[\sum_{\tuple{p}\in\cellindices}\exp\Bigl(2\I\PI\sum_{j=1}^d\frac{n_jp_j}{N_j}\Bigr)
\tens\varpi_{\tuple p}^{\tuple h}=\conj\Bigl[\sum_{\tuple{p}\in\cellindices}
\exp\Bigl(-2\I\PI\sum_{j=1}^d\frac{n_jp_j}{N_j}\Bigr)
\tens\varpi_{\tuple p}^{\tuple h}\Bigr]
=\conj(\hat{\tens\varpi}_{\tuple n}^{\tuple h}),\]</p><p>while the second sum in square brackets reduces to <span>$\hat{\tens\tau}_{\tuple n}^{\tuple h}$</span>. Gathering the above results, we find</p><p class="math-container">\[\frac{1}{\lvert\tuple N\rvert}\sum_{\tuple p, \tuple q\in\cellindices}
\tens\varpi_{\tuple p}^{\tuple h}\dbldot\tens\Gamma_{\tuple p-\tuple q}^{\tuple h}
\dbldot\tens\tau_{\tuple q}^{\tuple h}=\frac1{\lvert\tuple N\rvert^2}
\sum_{\tuple n\in\cellindices}\conj(\hat{\tens\varpi}_{\tuple n}^{\tuple h})
\dbldot\hat{\tens\Gamma}_{\tuple n}^{\tuple h}\dbldot
\hat{\tens\tau}_{\tuple n}^{\tuple h}.\]</p><p>The above equation can be understood as follows. <span>$\tens\Gamma^{\tuple h}$</span> is a linear operator that maps the cell-wise constant field <span>$\tens\tau^{\tuple h}$</span> to the cell-wise constant field <span>$\tens\eta^{\tuple h}$</span>, the cell-values of which are given by their DFT</p><p class="math-container">\[\tens{\eta}_{\tuple p}^{\tuple h}=
\dft^{-1}_{\tuple p}(\hat{\tens\eta}_{\bullet}^{\tuple h}),\quad\text{with}
\quad\hat{\tens\eta}_{\tuple n}^{\tuple h}
=\hat{\tens\Gamma}_{\tuple n}^{\tuple h}\dbldot
\hat{\tens\tau}_{\tuple n}^{\tuple h}.\]</p><p>Then, from the Plancherel theorem</p><p class="math-container">\[\frac1{\lvert\tuple N\rvert^2}
\sum_{\tuple n\in\cellindices}\conj(\hat{\tens\varpi}_{\tuple n}^{\tuple h})
\dbldot\hat{\tens\Gamma}_{\tuple n}^{\tuple h}\dbldot
\hat{\tens\tau}_{\tuple n}^{\tuple h}=\frac1{\lvert\tuple N\rvert^2}
\sum_{\tuple n\in\cellindices}\conj(\hat{\tens\varpi}_{\tuple n}^{\tuple h})
\dbldot\hat{\tens\eta}_{\tuple n}^{\tuple h}=\frac1{\lvert\tuple N\rvert}
\sum_{\tuple p\in\cellindices}\tens\varpi_{\tuple p}^{\tuple h}
\dbldot\tens\eta_{\tuple n}^{\tuple h}\]</p><p>and the last sum can be seen as the volume average <span>$\langle\tens\varpi^{\tuple h}\dbldot\tens\eta^{\tuple h}\rangle$</span>. Remembering that this expression was proposed as an approximation of <span>$\langle\tens\varpi^{\tuple h}\dbldot\tens\Gamma(\tens\tau^{\tuple h})\rangle$</span>, we finally find</p><p class="math-container">\[\langle\tens\varpi^{\tuple h}\dbldot\tens\Gamma(\tens\tau^{\tuple h})\rangle
\simeq\langle\tens\varpi^{\tuple h}\dbldot\tens\eta^{\tuple h}\rangle
=\langle\tens\varpi^{\tuple h}\dbldot\tens\Gamma^{\tuple h}(\tens\tau^{\tuple h})\rangle
\quad\text{for all }\tens\varpi^{\tuple h}\in\tensors_2^{\tuple h}(\Omega),\]</p><p>from which we find</p><p class="math-container">\[\tens\Gamma(\tens\tau^{\tuple h})\simeq\tens\Gamma^{\tuple h}
(\tens\tau^{\tuple h}).\]</p><p>The discrete Green operator, which was first introduced as an approximation of the continuous Green operator, seen as a bilinear form, can also be understood as an approximation of the continuous Green operator, seen as a linear mapping. This latter point of view will become extremely efficient when it comes to discretizing the Lippmann–Schwinger equation.</p><p>It results from the above developments that an explicit expression of the discrete Green operator as a (gigantic) matrix is never needed. Instead, the matrix-vector product <span>$\tens\tau^{\tuple h}\mapsto\tens\Gamma^{\tuple h}(\tens\tau^{\tuple h})$</span> is implemented in a matrix-free fashion as follows</p><ol><li>Given <span>$\tens\tau^{\tuple h}\in\tensors_2^{\tuple h}(\Omega)$</span>, compute the discrete Fourier transform <span>$\hat{\tens\tau}_{\tuple n}^{\tuple h}$</span> of its cell-values:<span>$\hat{\tens\tau}_{\tuple n}^{\tuple h}=\dft_{\tuple n}(\tens\tau_\bullet^{\tuple h})$</span>,</li><li>for each discrete frequency, compute <span>$\hat{\tens\eta}_{\tuple n}^{\tuple h}=\hat{\tens\Gamma}_{\tuple n}^{\tuple h}\dbldot\hat{\tens\tau}_{\tuple n}^{\tuple h}$</span>,</li><li>compute the inverse discrete Fourier transform <span>$\tens\eta_{\tuple{p}}^{\tuple h}$</span> of <span>$\hat{\tens\eta}_{\tuple{n}}^{\tuple h}$</span>,</li></ol><p>discrete Fourier transforms being computed in steps 1 and 3 by means of the FFT.</p><h3 id="sec20210803053100"><a class="docs-heading-anchor" href="#sec20210803053100">Condition for the discrete Green operator to map real fields onto real fields</a><a id="sec20210803053100-1"></a><a class="docs-heading-anchor-permalink" href="#sec20210803053100" title="Permalink"></a></h3><p>In the remainder of this chapter, we propose various discretizations of the Green operator. Before we proceed, though, it should be emphasized that the discrete Green operator must map a <em>real</em> field onto a <em>real</em> field. In other words, we must have <span>$\hat{\tens\eta}_{\tuple N-\tuple n}^{\tuple h}=\conj(\hat{\tens\eta}_{\tuple n}^{\tuple h})$</span> for all <span>$\tuple n$</span>. Since <span>$\hat{\tens\eta}_{\tuple n}^{\tuple h} =\hat{\tens\Gamma}_{\tuple n}^{\tuple h}\dbldot\hat{\tens\tau}_{\tuple n}^{\tuple h}$</span> and <span>$\hat{\tens\tau}_{\tuple n}$</span> already satisfies this condition (it is the DFT of a <em>real</em> field), we find the following requirement.</p><p>Any discrete operator that will be considered below must ensure that</p><p class="math-container">\[\hat{\tens\Gamma}_{\tuple N-\tuple n}^{\tuple h}
=\conj(\hat{\tens\Gamma}_{\tuple n}^{\tuple h})
\quad\text{for all}\quad\tuple n\in\cellindices.\]</p><h2 id="Discretizations-of-the-Green-operator"><a class="docs-heading-anchor" href="#Discretizations-of-the-Green-operator">Discretizations of the Green operator</a><a id="Discretizations-of-the-Green-operator-1"></a><a class="docs-heading-anchor-permalink" href="#Discretizations-of-the-Green-operator" title="Permalink"></a></h2><h3 id="The-discretization-of-\\textcite{bris2010a}"><a class="docs-heading-anchor" href="#The-discretization-of-\\textcite{bris2010a}">The discretization of \textcite{bris2010a}</a><a id="The-discretization-of-\\textcite{bris2010a}-1"></a><a class="docs-heading-anchor-permalink" href="#The-discretization-of-\\textcite{bris2010a}" title="Permalink"></a></h3><p>It was proved by \textcite{bris2010a} that, for all <span>$\tens\tau^{\tuple h}, \tens\varpi^{\tuple h}\in\tensors_2^{\tuple h}(\Omega)$</span></p><p class="math-container">\[\langle\tens\varpi^h\dbldot\tens\Gamma(\tens\tau^h)\rangle=\frac1{N^2}
\sum_{n_1=0}^{N_1-1}\cdots\sum_{n_d=0}^{N_d-1}\conj(\hat{\tens\varpi}_
{\tuple{n}}^h)\dbldot\hat{\tens\Gamma}_n^{h, \mathrm{BD10}}\dbldot
\hat{\tens\tau}_{\tuple{n}}^h,\]</p><p>where</p><p class="math-container">\[\hat{\tens\Gamma}_{\tuple n}^{\tuple h, \mathrm{BD10}}
=\sum_{\tuple m\in\integers^d}\bigl[F(\vec\alpha_{\tuple n+\tuple m\tuple N})
\bigr]^2\hat{\tens\Gamma}(\vec k_{\tuple n+\tuple m\tuple N}),\]</p><p>where <span>$\tuple{n+mN}$</span> denotes the <span>$d$</span>-tuple: <span>$\tuple n+\tuple m\tuple N=(n_1+m_1N_1, \ldots, n_d+m_dN_d)$</span>, while <span>$\alpha_{\tuple{n}}$</span> is the following dimensionless vector</p><p class="math-container">\[\vec\alpha_{\tuple{n}}
=\frac{2\pi h_1n_1}{L_1}\vec e_1+\cdots+\frac{2\pi h_dn_d}{L_d}\vec e_d,\]</p><p>finally, <span>$F$</span> is the tensor product of sine cardinal functions</p><p class="math-container">\[F(\vec\alpha)=\sinc\frac{\alpha_1}2\cdots\sinc\frac{\alpha_d}2.\]</p><p>Note that the above equations deliver the <em>exact</em> cell-averages of the Green operator, applied exactly to any <em>cell-wise constant</em> polarization field. Unfortunately, the series that defines the discrete Green operator can in general not be evaluated, owing to very slow convergence. Therefore, this discrete Green operator is unpractical, and is recalled here only for pedagocial reasons.</p><h2 id="The-discretization-of-\\textcite{moul1994,-moul1998}"><a class="docs-heading-anchor" href="#The-discretization-of-\\textcite{moul1994,-moul1998}">The discretization of \textcite{moul1994, moul1998}</a><a id="The-discretization-of-\\textcite{moul1994,-moul1998}-1"></a><a class="docs-heading-anchor-permalink" href="#The-discretization-of-\\textcite{moul1994,-moul1998}" title="Permalink"></a></h2><p>This is probably the most simple discretization, introduced first by \textcite{moul1994}. Only the lowest (positive and negative) frequencies are kept</p><p class="math-container">\[\hat{\tens\Gamma}_{\tuple n}^{\tuple h, \mathrm{MS94}}=\hat{\tens\Gamma}
(\vec k_{\tuple Z(\tuple n, \tuple N)}).\]</p><p>We must check that the <a href="#sec20210803053100">property ensuring realness of the discrete Green operator</a> is satisfied. Using the <a href="#sec20210803055450">fundamental property</a> of the <span>$\fftfreq$</span> function and assuming first that none of the <span>$n_i$</span> is such that <span>$2n_i=N_i$</span></p><p class="math-container">\[\hat{\tens\Gamma}_{\tuple N-\tuple n}^{\tuple h, \mathrm{MS94}}
=\hat{\tens\Gamma}(\vec k_{\tuple Z(\tuple N-\tuple n, \tuple N)})
=\hat{\tens\Gamma}(\vec k_{-\tuple Z(\tuple n, \tuple N)})
=\hat{\tens\Gamma}(-\vec k_{\tuple Z(\tuple n, \tuple N)})\]</p><p>All Green operators presented in Chap. <a href="../continuous_green_operators/#Continuous-Green-operators">Continuous Green operators</a> are such that <span>$\hat{\tens\Gamma}(-\vec k)=\hat{\tens\Gamma}(\vec k)$</span>, therefore</p><p class="math-container">\[\hat{\tens\Gamma}_{\tuple N-\tuple n}^{\tuple h, \mathrm{MS94}}
=\hat{\tens\Gamma}(\vec k_{\tuple Z(\tuple n, \tuple N)})
=\hat{\tens\Gamma}_{\tuple n}^{\tuple h, \mathrm{MS94}}\]</p><p>and the property is verified. Conversely, if all the <span>$n_i$</span> are such that <span>$2n_i=N_i$</span>, then</p><p class="math-container">\[\hat{\tens\Gamma}_{\tuple N-\tuple n}^{\tuple h, \mathrm{MS94}}
=\hat{\tens\Gamma}(\vec k_{\tuple Z(\tuple N-\tuple n, \tuple N)})
=\hat{\tens\Gamma}(\vec k_{\tuple Z(\tuple n, \tuple N)})
=\hat{\tens\Gamma}_{\tuple n}^{\tuple h, \mathrm{MS94}}.\]</p><p>More problematic is the case when a few, but not all, <span>$n_i$</span> are such that <span>$2n_i=N_i$</span>. Then the property does not hold for such frequencies. \textcite{moul1998} use a specific treatment for such cases</p><p class="math-container">\[\hat{\tens\Gamma}(\vec k_{\tuple n})=\tens C^{-1},\]</p><p>if one of the <span>$n_i$</span> is such that <span>$2n_i=N_i$</span>. This is implemented in <code>Scapin</code>. Note that such cases occur only for even-sized grids.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../continuous_green_operators/">« Continuous Green operators</a><a class="docs-footer-nextpage" href="../appendix/">Appendix »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Tuesday 3 August 2021 03:58">Tuesday 3 August 2021</span>. Using Julia version 1.6.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
